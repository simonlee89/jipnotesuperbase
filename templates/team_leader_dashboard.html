<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>ÌåÄÏû• ÎåÄÏãúÎ≥¥Îìú - ÏßëÎÖ∏Ìä∏</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f8fafc;
            color: #1a202c;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .app-container {
            display: flex;
            height: 100vh;
        }
        
        /* ÏÇ¨Ïù¥ÎìúÎ∞î */
        .sidebar {
            width: 260px;
            background: #ffffff;
            border-right: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            z-index: 1000;
        }
        
        .sidebar-header {
            padding: 24px 20px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .sidebar-nav {
            flex: 1;
            padding: 20px 0;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            color: #64748b;
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }
        
        .nav-item:hover {
            background: #fef3c7;
            color: #f59e0b;
        }
        
        .nav-item.active {
            background: #fef3c7;
            color: #f59e0b;
            border-left-color: #f59e0b;
        }
        
        .nav-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .logo-text {
            font-size: 18px;
            font-weight: 600;
            color: #1a202c;
        }
        
        /* ÌÉ≠ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò Ïä§ÌÉÄÏùº */
        .tab-navigation {
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
        }

        .tab-btn {
            background: transparent;
            border: none;
            padding: 12px 20px;
            font-size: 14px;
            font-weight: 500;
            color: #64748b;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s ease;
        }

        .tab-btn:hover {
            color: #f59e0b;
            background: rgba(245, 158, 11, 0.05);
        }

        .tab-btn.active {
            color: #f59e0b;
            border-bottom-color: #f59e0b;
            background: rgba(245, 158, 11, 0.05);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
        
        /* Î©îÏù∏ Ïª®ÌÖêÏ∏† */
        .main-content {
            flex: 1;
            margin-left: 260px;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background: #ffffff;
            border-bottom: 1px solid #e2e8f0;
            padding: 8px 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .search-box {
            position: relative;
        }
        
        .search-input {
            width: 300px;
            padding: 10px 16px 10px 40px;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            background: #f8fafc;
            font-size: 14px;
            outline: none;
            transition: all 0.2s ease;
        }
        
        .search-input:focus {
            border-color: #f59e0b;
            background: #ffffff;
            box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1);
        }
        
        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 12px;
            border-radius: 12px;
            background: #f8fafc;
        }
        
        .user-avatar {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 14px;
        }
        
        .user-info {
            display: flex;
            flex-direction: column;
        }
        
        .user-name {
            font-size: 14px;
            font-weight: 600;
            color: #1a202c;
        }
        
        .user-role {
            font-size: 12px;
            color: #64748b;
        }
        
        .logout-btn {
            padding: 8px 16px;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 8px;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .logout-btn:hover {
            background: #dc2626;
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.4), 0 4px 12px rgba(239, 68, 68, 0.3);
        }
        
        /* Ïª®ÌÖêÏ∏† ÏòÅÏó≠ */
        .content {
            flex: 1;
            padding: 32px;
            overflow-y: auto;
        }
        
        .page-header {
            margin-bottom: 16px;
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 40px;
        }
        
        .header-text {
            text-align: left;
            flex: 1;
        }
        
        .page-title {
            font-size: 20px;
            font-weight: 700;
            color: #1a202c;
            margin-bottom: 4px;
        }
        
        .page-subtitle {
            font-size: 14px;
            color: #64748b;
        }
        
        .card {
            background: #ffffff;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }
        
        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: #1a202c;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }
        
        .btn-primary {
            background: #f59e0b;
            color: white;
        }
        
        .btn-primary:hover {
            background: #d97706;
            transform: translateY(-1px);
            box-shadow: 0 0 20px rgba(245, 158, 11, 0.4), 0 4px 12px rgba(245, 158, 11, 0.3);
        }
        
        .btn-sm {
            padding: 8px 12px;
            font-size: 12px;
        }
        
        /* ÌïÑÌÑ∞ ÏÑπÏÖò Ïä§ÌÉÄÏùº */
        .filter-section {
            padding: 12px 24px;
            border-bottom: 1px solid #e2e8f0;
            background: #ffffff;
            display: flex;
            gap: 24px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .filter-label {
            color: #64748b;
            font-size: 13px;
            font-weight: 600;
            margin-right: 4px;
            white-space: nowrap;
        }
        
        .filter-buttons {
            display: flex;
            gap: 6px;
        }
        
        .filter-btn {
            padding: 6px 10px;
            border: 1px solid #e2e8f0;
            background: #ffffff;
            color: #334155;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .filter-btn:hover {
            border-color: #f59e0b;
            background: #fef3c7;
            color: #f59e0b;
        }
        
        .filter-btn.active {
            background: #f59e0b;
            color: white;
            border-color: #f59e0b;
            font-weight: 600;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #64748b;
        }
        
        /* Í¥ÄÎ¶¨Ïûê Ìå®ÎÑêÍ≥º ÎèôÏùºÌïú ÌÖåÏù¥Î∏î Ïä§ÌÉÄÏùº */
        .employees-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .employees-table th {
            background: #f8fafc;
            padding: 16px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            color: #374151;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .employees-table td {
            padding: 16px;
            border-bottom: 1px solid #f1f5f9;
            font-size: 14px;
        }
        
        .employees-table tr:hover {
            background: #f8fafc;
        }
        
        .status-badge {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-progress {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-complete {
            background: #dcfce7;
            color: #166534;
        }
        
        .status-hold {
            background: #fecaca;
            color: #991b1b;
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 6px;
        }
        
        .btn-primary {
            background: #3b82f6;
            color: white;
            border: 1px solid #3b82f6;
        }
        
        .btn-primary:hover {
            background: #2563eb;
            border-color: #2563eb;
        }
        
        .btn-outline-primary {
            background: transparent;
            color: #3b82f6;
            border: 1px solid #3b82f6;
        }
        
        .btn-outline-primary:hover {
            background: #3b82f6;
            color: white;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
            border: 1px solid #ef4444;
        }
        
        .btn-danger:hover {
            background: #dc2626;
            border-color: #dc2626;
        }
        
        /* Ìé∏Ïßë Í¥ÄÎ†® Ïä§ÌÉÄÏùº */
        .editing-cell {
            background-color: #fef3c7 !important;
        }

        .new-property-row {
            background-color: #ecfdf5 !important;
            border: 2px solid #10b981 !important;
        }

        /* ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò Ïä§ÌÉÄÏùº */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 20px;
            padding: 20px 0;
        }
        
        .pagination .btn {
            text-decoration: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .pagination .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        /* Í≥†Í∞ùÎ™©Î°ù Ïä§ÌÉÄÏùº */
        .customers-table {
            width: 100%;
            border-collapse: collapse;
            position: relative;
            overflow: visible;
        }
        
        .table-container {
            position: relative;
            overflow: visible;
        }
        
        /* ÎÇ†Ïßú ÏûÖÎ†• ÌïÑÎìú Ïä§ÌÉÄÏùº */
        .customers-table .editing-cell {
            position: relative;
            z-index: 1000;
        }
        
        .customers-table input[type="date"] {
            background: white;
            border: 2px solid #3b82f6;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .customers-table th {
            background: #f8fafc;
            padding: 16px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            color: #374151;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .customers-table td {
            padding: 16px;
            border-bottom: 1px solid #f1f5f9;
            font-size: 14px;
        }
        
        .customers-table tr:hover {
            background: #f8fafc;
        }
        
        .status-badge {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-progress {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-completed, .status-complete {
            background: #dcfce7;
            color: #166534;
        }
        
        .status-cancelled, .status-hold {
            background: #fee2e2;
            color: #991b1b;
        }

        /* ÌïÑÌÑ∞ ÏÑπÏÖò */
        .filter-section {
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            padding: 16px;
            margin-bottom: 20px;
            display: flex;
            gap: 32px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .filter-group {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .filter-label {
            font-size: 13px;
            font-weight: 600;
            color: #374151;
        }
        
        .filter-btn {
            padding: 6px 12px;
            border: 1px solid #e2e8f0;
            background: #ffffff;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #64748b;
        }
        
        .filter-btn:hover {
            border-color: #6366f1;
            color: #6366f1;
            background: #f8fafc;
        }
        
        .filter-btn.active {
            background: #6366f1;
            color: white;
            border-color: #6366f1;
        }
        
        .filter-select {
            padding: 6px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 13px;
            background: #ffffff;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        /* Î©îÎ™® Î™®Îã¨ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: #ffffff;
            border-radius: 16px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        
        .modal-overlay.active .modal-content {
            transform: scale(1);
        }
        
        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #1a202c;
            margin: 0;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #64748b;
            padding: 4px;
        }
        
        .modal-body {
            padding: 20px 24px;
        }
        
        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }
        
        .memo-textarea {
            width: 100%;
            min-height: 200px;
            padding: 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.5;
            resize: vertical;
            font-family: inherit;
        }

        /* ÏßÅÏõêÍ¥ÄÎ¶¨ Ïä§ÌÉÄÏùº */
        .employees-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }
        
        .employees-table th,
        .employees-table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .employees-table th {
            background: #f8fafc;
            font-weight: 600;
            color: #374151;
            font-size: 14px;
        }
        
        .employees-table tr:hover {
            background: #f8fafc;
        }

        .add-employee-form {
            padding: 20px;
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #374151;
            font-size: 14px;
        }
        
        .form-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #f59e0b;
            box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1);
        }
        
        /* ÏßÅÏõê Ï∂îÍ∞Ä Ìèº Ïä§ÌÉÄÏùº */
        .add-employee-form .form-input:hover {
            border-color: #d1d5db;
            background: #ffffff;
        }
        
        .add-employee-form .form-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: #ffffff;
        }
        
        .add-employee-form select.form-input:hover {
            border-color: #d1d5db;
        }
        
        .add-employee-form select.form-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .add-employee-form .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .add-employee-form .btn:active {
            transform: translateY(0);
        }
        
        .add-employee-form .btn-outline-primary:hover {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        /* Î™®Îã¨ Ïä§ÌÉÄÏùº */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: modalFadeIn 0.3s ease;
        }
        
        .modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }
        
        .modal-content {
            position: relative;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow: hidden;
            animation: modalSlideIn 0.3s ease;
        }
        
        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s;
        }
        
        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .modal-body {
            padding: 24px;
        }
        
        .modal .form-label {
            font-size: 13px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 6px;
            display: block;
        }
        
        .modal .form-input {
            padding: 10px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s;
            background: #f9fafb;
            width: 100%;
        }
        
        .modal .form-input:hover {
            border-color: #d1d5db;
            background: #ffffff;
        }
        
        .modal .form-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: #ffffff;
            outline: none;
        }
        
        .modal .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        .modal .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .modal .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .modal .btn-secondary {
            background: white;
            color: #6b7280;
            border: 2px solid #6b7280;
        }
        
        .modal .btn-secondary:hover {
            background: #6b7280;
            color: white;
            transform: translateY(-1px);
        }
        
        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            background: #f9fafb;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes modalSlideIn {
            from { 
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
            to { 
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        /* Í≥†Í∞ù ÌÖåÏù¥Î∏î Í¥ÄÎ†® Ïä§ÌÉÄÏùº */
        .customers-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .customers-table th {
            background: #f8fafc;
            padding: 16px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            color: #374151;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .customers-table td {
            padding: 16px;
            border-bottom: 1px solid #f1f5f9;
            font-size: 14px;
        }
        
        .customers-table tr:hover {
            background: #f8fafc;
        }
        
        .status-badge {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-progress {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-completed, .status-complete {
            background: #dcfce7;
            color: #166534;
        }
        
        .status-cancelled, .status-hold {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .management-link {
            color: #6366f1;
            text-decoration: none;
            font-weight: 500;
            font-size: 13px;
        }
        
        .management-link:hover {
            color: #5855eb;
            text-decoration: underline;
        }
        
        .property-link-placeholder {
            color: #94a3b8;
            font-style: italic;
            font-size: 12px;
        }
        
        .editable-cell {
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .editable-cell:hover {
            background-color: #f8fafc;
            transform: scale(1.02);
        }
        
        .editing-cell {
            padding: 2px !important;
            background-color: #ffffff;
            transform: scale(1.05);
            box-shadow: 0 0 0 2px #6366f1, 0 4px 12px rgba(99, 102, 241, 0.15);
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .editing-cell input, .editing-cell select {
            width: 100%;
            border: none;
            padding: 8px;
            font-size: 14px;
            background: transparent;
            border-radius: 4px;
            outline: none;
        }
        
        .memo-cell {
            cursor: pointer;
            max-width: 150px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            transition: all 0.2s ease;
            padding: 4px 8px;
            border-radius: 4px;
            position: relative;
        }
        
        .memo-cell:hover {
            background-color: #f1f5f9;
            transform: scale(1.02);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        /* Î©îÎ™® ÏÖÄ Ìà¥ÌåÅ Í∞úÏÑ† - Î∏åÎùºÏö∞Ï†Ä Í∏∞Î≥∏ Ìà¥ÌåÅ ÏÇ¨Ïö© */
        .memo-cell[title] {
            cursor: help;
        }
        
        .memo-cell[title]:hover {
            cursor: pointer;
        }
        
        /* ÌïÑÌÑ∞ ÏÑπÏÖò */
        .filter-section {
            padding: 16px 0;
            border-bottom: 1px solid #e2e8f0;
            margin-bottom: 20px;
            display: flex;
            gap: 32px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .filter-group {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .filter-label {
            font-size: 14px;
            font-weight: 500;
            color: #374151;
            white-space: nowrap;
        }
        
        .filter-buttons {
            display: flex;
            gap: 8px;
        }
        
        .filter-btn {
            padding: 6px 12px;
            border: 1px solid #e2e8f0;
            background: #ffffff;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #64748b;
        }
        
        .filter-btn:hover {
            border-color: #6366f1;
            color: #6366f1;
            background: #f8fafc;
        }
        
        .filter-btn.active {
            background: #6366f1;
            color: white;
            border-color: #6366f1;
        }
        
        .filter-select {
            padding: 6px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 13px;
            background: #ffffff;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        /* Î™®Îã¨ Í¥ÄÎ†® Ïä§ÌÉÄÏùº */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        
        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #1a202c;
            margin: 0;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #64748b;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: all 0.2s ease;
        }
        
        .modal-close:hover {
            background: #f1f5f9;
            color: #374151;
        }
        
        .modal-body {
            padding: 20px 24px;
        }
        
        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }
        
        .memo-textarea {
            width: 100%;
            min-height: 200px;
            padding: 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            outline: none;
            transition: all 0.2s ease;
        }
        
        .memo-textarea:focus {
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        /* Îπà ÏÉÅÌÉú Ïä§ÌÉÄÏùº */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #64748b;
        }
        
        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }
        
        .empty-state-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #374151;
        }
        
        .empty-state-description {
            font-size: 14px;
            color: #64748b;
        }
        
        /* Ï¢ãÏïÑÏöî ÏïåÎ¶º Ïï†ÎãàÎ©îÏù¥ÏÖò */
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .like-alarm {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- ÏÇ¨Ïù¥ÎìúÎ∞î -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">üëë</div>
                    <div class="logo-text">ÏßëÎÖ∏Ìä∏</div>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-tab="dashboard">
                    <div class="nav-icon">üìä</div>
                    ÎåÄÏãúÎ≥¥Îìú
                </a>
                <a href="#" class="nav-item" data-tab="maeiple">
                    <div class="nav-icon">üè¢</div>
                    Îß§Î¨ºÍ¥ÄÎ¶¨
                </a>
                <a href="#" class="nav-item" data-tab="customers">
                    <div class="nav-icon">üë•</div>
                    Í≥†Í∞ùÎ™©Î°ù
                </a>
                <a href="#" class="nav-item" data-tab="employees">
                    <div class="nav-icon">üë§</div>
                    ÏßÅÏõêÍ¥ÄÎ¶¨
                </a>
                <a href="/logout" class="nav-item">
                    <div class="nav-icon">üö™</div>
                    Î°úÍ∑∏ÏïÑÏõÉ
                </a>
            </nav>
        </div>
        
        <!-- Î©îÏù∏ Ïª®ÌÖêÏ∏† -->
        <div class="main-content">
            <!-- Ìó§Îçî -->
            <div class="header">
                <div class="header-left">
                    <div class="search-box">
                        <div class="search-icon">üîç</div>
                        <input type="text" class="search-input" placeholder="Îß§Î¨º Î∞è Í≥†Í∞ù Í≤ÄÏÉâ..." id="search-input">
                    </div>
                </div>
                
                <div class="header-right">
                    <div class="user-profile">
                        <div class="user-avatar" id="user-avatar">{{ employee_name[0] if employee_name else 'ÌåÄ' }}</div>
                        <div class="user-info">
                            <div class="user-name" id="user-name">{{ employee_name or 'ÌåÄÏû•' }}</div>
                            <div class="user-role">ÌåÄÏû•</div>
                        </div>
                    </div>
                    <a href="/logout" class="logout-btn">Î°úÍ∑∏ÏïÑÏõÉ</a>
                </div>
            </div>
            
            <!-- Ïª®ÌÖêÏ∏† -->
            <div class="content">
                <div class="page-header">
                    <div class="header-content">
                        <div class="header-text">
                            <h1 class="page-title">ÌåÄÏû• ÎåÄÏãúÎ≥¥Îìú</h1>
                            <p class="page-subtitle">ÌåÄ Í¥ÄÎ¶¨ Î∞è ÌòÑÌô© Ï°∞Ìöå</p>
                        </div>
                    </div>
                </div>
                
                <!-- Î©îÏù¥ÌîåÍ¥ÄÎ¶¨ ÏÑπÏÖò -->
                <div id="maeiple-section" style="display:none;">
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center; border-bottom: none;">
                            <h2 class="card-title">
                                <span>üè¢</span>
                                Î©îÏù¥ÌîåÍ¥ÄÎ¶¨
                            </h2>
                            <div style="display: flex; gap: 8px;">
                                <button type="button" class="btn btn-secondary" onclick="loadMaeipeProperties(1)" style="font-size: 12px; padding: 6px 12px; background: #e0e7ff; color: #3730a3; border: 1.5px solid #c7d2fe; font-weight: 600;">
                                    <span>üîÑ</span> ÏÉàÎ°úÍ≥†Ïπ®
                                </button>
                            </div>
                        </div>
                        
                        <!-- ÌÉ≠ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
                        <div class="tab-navigation" style="border-bottom: 1px solid #e2e8f0; background: #f8fafc;">
                            <div style="display: flex; align-items: center; padding: 0 24px;">
                                <button class="tab-btn active" onclick="switchMaeipleTab('list')" data-tab="list">
                                    ÏïÑÌååÌä∏Î™©Î°ù
                                </button>
                                <button class="tab-btn" onclick="switchMaeipleTab('stats')" data-tab="stats">
                                    Í∞úÏù∏Îß§Î¨ºÍ¥ÄÎ¶¨
                                </button>
                                <div style="margin-left: auto;">
                                    <!-- ÌÉ≠Î≥Ñ Î≤ÑÌäºÏùÄ Í∞Å ÌÉ≠ ÏΩòÌÖêÏ∏† ÎÇ¥Î∂ÄÎ°ú Ïù¥Îèô -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- ÌÉ≠ ÏΩòÌÖêÏ∏† - ÏïÑÌååÌä∏Î™©Î°ù (admin_panelÏóêÏÑú Ïù¥Ïãù) -->
                        <div id="maeiple-tab-list" class="tab-content active">
                            <!-- ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠ Ìó§Îçî -->
                            <div style="display: flex; justify-content: between; align-items: center; padding: 16px 24px; border-bottom: 1px solid #e2e8f0;">
                                <h3 style="margin: 0; font-size: 16px; font-weight: 600; color: #1f2937;">Ï†ÑÏ≤¥ ÏïÑÌååÌä∏ Î™©Î°ù</h3>
                                <button class="btn btn-primary" onclick="addNewPropertyRow()" style="font-size: 12px; padding: 6px 12px; margin-left: auto;">+ ÏÉà Îß§Î¨º Ï∂îÍ∞Ä</button>
                            </div>
                            
                            <!-- ÌïÑÌÑ∞ ÏÑπÏÖò -->
                            <div class="filter-section">
                                <!-- Ìò∏Ïàò Í≤ÄÏÉâ -->
                                <div class="filter-group">
                                    <span class="filter-label">Ìò∏Ïàò Í≤ÄÏÉâ:</span>
                                    <input type="text" id="room-search-admin" placeholder="Ìò∏Ïàò ÏûÖÎ†• (Ïòà: 101, 102)" 
                                           style="padding: 6px 12px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 12px; width: 120px;"
                                           oninput="filterByRoomAdmin(this.value)">
                                </div>
                                
                                <!-- Í±∞Îûò Ïú†Ìòï ÌïÑÌÑ∞ -->
                                <div class="filter-group" id="deal-type-filter-group-admin">
                                    <span class="filter-label">Í±∞ÎûòÏú†Ìòï:</span>
                                    <div class="filter-buttons">
                                        <button class="filter-btn active" data-value="all" onclick="setDealTypeFilterAdmin('all', this)">Ï†ÑÏ≤¥</button>
                                        <button class="filter-btn" data-value="Ï†ÑÏÑ∏" onclick="setDealTypeFilterAdmin('Ï†ÑÏÑ∏', this)">Ï†ÑÏÑ∏</button>
                                        <button class="filter-btn" data-value="ÏõîÏÑ∏" onclick="setDealTypeFilterAdmin('ÏõîÏÑ∏', this)">ÏõîÏÑ∏</button>
                                        <button class="filter-btn" data-value="Îß§Îß§" onclick="setDealTypeFilterAdmin('Îß§Îß§', this)">Îß§Îß§</button>
                                    </div>
                                </div>
                                
                                <div class="filter-group" id="status-filter-group">
                                    <span class="filter-label">ÌòÑÌô©:</span>
                                    <div class="filter-buttons">
                                        <button class="filter-btn active" data-value="all" onclick="setStatusFilter('all', this)">Ï†ÑÏ≤¥</button>
                                        <button class="filter-btn" data-value="Í±∞ÎûòÍ∞ÄÎä•" onclick="setStatusFilter('Í±∞ÎûòÍ∞ÄÎä•', this)">Í±∞ÎûòÍ∞ÄÎä•</button>
                                        <button class="filter-btn" data-value="Í≥ÑÏïΩÏôÑÎ£å" onclick="setStatusFilter('Í≥ÑÏïΩÏôÑÎ£å', this)">Í≥ÑÏïΩÏôÑÎ£å</button>
                                        <button class="filter-btn" data-value="Î≥¥Î•ò" onclick="setStatusFilter('Î≥¥Î•ò', this)">Î≥¥Î•ò</button>
                                        <button class="filter-btn" data-value="Î∂ÄÏû¨" onclick="setStatusFilter('Î∂ÄÏû¨', this)">Î∂ÄÏû¨</button>
                                    </div>
                                </div>
                                
                                <div class="filter-group" id="occupied-filter-group">
                                    <span class="filter-label">Ïã§Í±∞Ï£º:</span>
                                    <div class="filter-buttons">
                                        <button class="filter-btn active" data-value="all" onclick="setOccupiedFilter('all', this)">Ï†ÑÏ≤¥</button>
                                        <button class="filter-btn" data-value="O" onclick="setOccupiedFilter('O', this)">O</button>
                                        <button class="filter-btn" data-value="X" onclick="setOccupiedFilter('X', this)">X</button>
                                    </div>
                                </div>
                                
                                <!-- Îã¥ÎãπÏûê Í≤ÄÏÉâ -->
                                <div class="filter-group">
                                    <span class="filter-label">Îã¥ÎãπÏûê Í≤ÄÏÉâ:</span>
                                    <input type="text" id="employee-search-admin" placeholder="Îã¥ÎãπÏûê Ïù¥Î¶Ñ ÏûÖÎ†•" 
                                           style="padding: 6px 12px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 12px; width: 120px;"
                                           oninput="filterByEmployeeAdmin(this.value)">
                                </div>
                                
                                <!-- ÌåÄ ÌïÑÌÑ∞ -->
                                <div class="filter-group" id="team-filter-group-admin">
                                    <span class="filter-label">ÌåÄ:</span>
                                    <div class="filter-buttons">
                                        <button class="filter-btn active" data-value="all" onclick="setTeamFilterAdmin('all', this)">Ï†ÑÏ≤¥</button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ÏùºÍ¥Ñ Ï≤òÎ¶¨ Ìå®ÎÑê (ÌåÄÏû•: ÏûêÏã†Ïùò ÌåÄ Îã¥ÎãπÏûê Î≥ÄÍ≤ΩÎßå Í∞ÄÎä•) -->
                            <div id="bulk-actions-panel" style="display: none; padding: 12px 24px; background: #f8fafc; border-bottom: 1px solid #e2e8f0;">
                                <div style="display: flex; align-items: center; gap: 16px; flex-wrap: wrap;">
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <span style="font-size: 14px; font-weight: 600; color: #374151;">ÏÑ†ÌÉùÎêú Îß§Î¨º:</span>
                                        <span id="selected-count" style="font-size: 14px; font-weight: 700; color: #3b82f6;">0Í∞ú</span>
                                    </div>

                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <span style="font-size: 14px; font-weight: 600; color: #374151;">Îã¥ÎãπÏûê Î≥ÄÍ≤Ω:</span>
                                        <select id="bulk-employee-select" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 12px; min-width: 150px;">
                                            <option value="">Îã¥ÎãπÏûê ÏÑ†ÌÉù</option>
                                        </select>
                                        <button onclick="bulkAssignEmployeeTeamLeader()" style="padding: 6px 12px; background: #3b82f6; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer;">Ï†ÅÏö©</button>
                                    </div>

                                    <button onclick="clearSelection()" style="padding: 6px 12px; background: #6b7280; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer;">ÏÑ†ÌÉù Ìï¥Ï†ú</button>
                                </div>
                            </div>
                            
                            <div id="maeiple-table-content">
                                <div class="loading">Î°úÎî© Ï§ë...</div>
                            </div>
                            
                                        <!-- ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò -->
            <div id="maeiple-pagination" class="pagination">
                <!-- ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò Î≤ÑÌäºÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
            </div>
                        </div>
                        
                        <!-- ÌÉ≠ ÏΩòÌÖêÏ∏† - ÌåÄÏû•Î©îÏù¥ÌîåÍ¥ÄÎ¶¨ (admin_panelÏóêÏÑú Ïù¥Ïãù) -->
                        <div id="maeiple-tab-stats" class="tab-content" style="display: none;">
                            <!-- Í∞úÏù∏Îß§Î¨ºÍ¥ÄÎ¶¨ ÌÉ≠ Ìó§Îçî -->
                            <div style="display: flex; justify-content: between; align-items: center; padding: 16px 24px; border-bottom: 1px solid #e2e8f0;">
                                <h3 style="margin: 0; font-size: 16px; font-weight: 600; color: #1f2937;">ÌåÄÏû• Í∞úÏù∏ Îß§Î¨º Í¥ÄÎ¶¨</h3>
                                <button class="btn btn-primary" onclick="addNewPersonalPropertyRow()" style="font-size: 12px; padding: 6px 12px; margin-left: auto;">+ Í∞úÏù∏ Îß§Î¨º Ï∂îÍ∞Ä</button>
                            </div>
                            
                            <!-- ÌïÑÌÑ∞ ÏÑπÏÖò -->
                            <div class="filter-section">
                                <!-- Ìò∏Ïàò Í≤ÄÏÉâ -->
                                <div class="filter-group">
                                    <span class="filter-label">Ìò∏Ïàò Í≤ÄÏÉâ:</span>
                                    <input type="text" id="room-search-team-leader" placeholder="Ìò∏Ïàò ÏûÖÎ†• (Ïòà: 101, 102)" 
                                           style="padding: 6px 12px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 12px; width: 120px;"
                                           oninput="filterByRoomTeamLeader(this.value)">
                                </div>
                                
                                <!-- Í±∞Îûò Ïú†Ìòï ÌïÑÌÑ∞ -->
                                <div class="filter-group" id="deal-type-filter-group-team-leader">
                                    <span class="filter-label">Í±∞ÎûòÏú†Ìòï:</span>
                                    <div class="filter-buttons">
                                        <button class="filter-btn active" data-value="all" onclick="setDealTypeFilterTeamLeader('all', this)">Ï†ÑÏ≤¥</button>
                                        <button class="filter-btn" data-value="Ï†ÑÏÑ∏" onclick="setDealTypeFilterTeamLeader('Ï†ÑÏÑ∏', this)">Ï†ÑÏÑ∏</button>
                                        <button class="filter-btn" data-value="ÏõîÏÑ∏" onclick="setDealTypeFilterTeamLeader('ÏõîÏÑ∏', this)">ÏõîÏÑ∏</button>
                                        <button class="filter-btn" data-value="Îß§Îß§" onclick="setDealTypeFilterTeamLeader('Îß§Îß§', this)">Îß§Îß§</button>
                                    </div>
                                </div>
                                
                                <div class="filter-group" id="status-filter-group-team-leader">
                                    <span class="filter-label">ÌòÑÌô©:</span>
                                    <div class="filter-buttons">
                                        <button class="filter-btn active" data-value="all" onclick="setStatusFilterTeamLeader('all', this)">Ï†ÑÏ≤¥</button>
                                        <button class="filter-btn" data-value="Í±∞ÎûòÍ∞ÄÎä•" onclick="setStatusFilterTeamLeader('Í±∞ÎûòÍ∞ÄÎä•', this)">Í±∞ÎûòÍ∞ÄÎä•</button>
                                        <button class="filter-btn" data-value="Í≥ÑÏïΩÏôÑÎ£å" onclick="setStatusFilterTeamLeader('Í≥ÑÏïΩÏôÑÎ£å', this)">Í≥ÑÏïΩÏôÑÎ£å</button>
                                        <button class="filter-btn" data-value="Î≥¥Î•ò" onclick="setStatusFilterTeamLeader('Î≥¥Î•ò', this)">Î≥¥Î•ò</button>
                                        <button class="filter-btn" data-value="Î∂ÄÏû¨" onclick="setStatusFilterTeamLeader('Î∂ÄÏû¨', this)">Î∂ÄÏû¨</button>
                                    </div>
                                </div>
                                
                                <div class="filter-group" id="occupied-filter-group-team-leader">
                                    <span class="filter-label">Ïã§Í±∞Ï£º:</span>
                                    <div class="filter-buttons">
                                        <button class="filter-btn active" data-value="all" onclick="setOccupiedFilterTeamLeader('all', this)">Ï†ÑÏ≤¥</button>
                                        <button class="filter-btn" data-value="O" onclick="setOccupiedFilterTeamLeader('O', this)">O</button>
                                        <button class="filter-btn" data-value="X" onclick="setOccupiedFilterTeamLeader('X', this)">X</button>
                                    </div>
                                </div>
                                
                                <!-- Îã¥ÎãπÏûê Í≤ÄÏÉâ -->
                                <div class="filter-group">
                                    <span class="filter-label">Îã¥ÎãπÏûê Í≤ÄÏÉâ:</span>
                                    <input type="text" id="employee-search-team-leader" placeholder="Îã¥ÎãπÏûê Ïù¥Î¶Ñ ÏûÖÎ†•" 
                                           style="padding: 6px 12px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 12px; width: 120px;"
                                           oninput="filterByEmployeeTeamLeader(this.value)">
                                </div>
                                
                                <!-- ÌåÄ ÌïÑÌÑ∞ -->
                                <div class="filter-group" id="team-filter-group-team-leader">
                                    <span class="filter-label">ÌåÄ:</span>
                                    <div class="filter-buttons">
                                        <button class="filter-btn active" data-value="all" onclick="setTeamFilterTeamLeader('all', this)">Ï†ÑÏ≤¥</button>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="maeiple-table-content-team-leader">
                                <div class="loading">Î°úÎî© Ï§ë...</div>
                            </div>
                            
                            <!-- ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò -->
                            <div id="maeiple-pagination-team-leader" class="pagination">
                                <!-- ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò Î≤ÑÌäºÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Í∏∞Î≥∏ ÎåÄÏãúÎ≥¥Îìú -->
                <div style="padding: 40px; text-align: center; color: #64748b;" id="default-content">
                    <div style="font-size: 20px; margin-bottom: 12px;">üëë ÌåÄÏû• ÎåÄÏãúÎ≥¥Îìú</div>
                    <div style="font-size: 16px; margin-bottom: 24px;">ÌåÄÏû• Ï†ÑÏö© Í∏∞Îä•Îì§ÏùÑ Ï§ÄÎπÑ Ï§ëÏûÖÎãàÎã§.</div>
                    <div style="font-size: 14px; color: #94a3b8;">
                        ‚Ä¢ Î©îÏù¥ÌîåÍ¥ÄÎ¶¨: ÏïÑÌååÌä∏Î™©Î°ù + Í∞úÏù∏Îß§Î¨ºÍ¥ÄÎ¶¨ ÌÉ≠<br>
                        ‚Ä¢ Í≥†Í∞ùÎ™©Î°ù: ÌåÄ Ï†ÑÏ≤¥ Í≥†Í∞ù Í¥ÄÎ¶¨<br>
                        ‚Ä¢ ÏßÅÏõêÍ¥ÄÎ¶¨: ÌåÄ Ï†ÑÏ≤¥ ÏßÅÏõê Í¥ÄÎ¶¨<br>
                        ‚Ä¢ ÌÜµÍ≥Ñ Î∞è Î¶¨Ìè¨Ìä∏ Í∏∞Îä•
                    </div>
                    

                </div>

                <!-- Í≥†Í∞ùÎ™©Î°ù ÏÑπÏÖò -->
                <div id="customers-section" style="display: none;">
                    <!-- Í≥†Í∞ù Î™©Î°ù Ïπ¥Îìú -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">
                                <span>üë•</span>
                                Í≥†Í∞ù Î™©Î°ù
                            </h2>
                            <button class="btn btn-primary" onclick="addNewRow()">
                                <span>‚ûï</span>
                                Í≥†Í∞ùÏ∂îÍ∞Ä
                            </button>
                        </div>
                        
                        <!-- ÌïÑÌÑ∞ ÏÑπÏÖò -->
                        <div class="filter-section">
                            <div class="filter-group">
                                <label class="filter-label">ÏÉÅÌÉúÎ≥Ñ ÌïÑÌÑ∞:</label>
                                <div class="filter-buttons">
                                    <button class="filter-btn active" data-filter="all" onclick="filterCustomers('all')">Ï†ÑÏ≤¥</button>
                                    <button class="filter-btn" data-filter="ÏßÑÌñâÏ§ë" onclick="filterCustomers('ÏßÑÌñâÏ§ë')">ÏßÑÌñâÏ§ë</button>
                                    <button class="filter-btn" data-filter="ÏôÑÎ£å" onclick="filterCustomers('ÏôÑÎ£å')">ÏôÑÎ£å</button>
                                    <button class="filter-btn" data-filter="Í≥ÑÏïΩ" onclick="filterCustomers('Í≥ÑÏïΩ')">Í≥ÑÏïΩ</button>
                                    <button class="filter-btn" data-filter="Î≥¥Î•ò" onclick="filterCustomers('Î≥¥Î•ò')">Î≥¥Î•ò</button>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <label class="filter-label">ÎÇ†Ïßú ÌïÑÌÑ∞:</label>
                                <select class="filter-select" id="date-filter-customers" onchange="filterByDate(this.value)">
                                    <option value="all">Ï†ÑÏ≤¥ Í∏∞Í∞Ñ</option>
                                    <option value="today">Ïò§Îäò</option>
                                    <option value="week">Ïù¥Î≤à Ï£º</option>
                                    <option value="month">Ïù¥Î≤à Îã¨</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="customers-table">
                                <thead>
                                    <tr>
                                        <th>ÎÇ†Ïßú</th>
                                        <th>ÏûÖÏ£º</th>
                                        <th>Í≥†Í∞ù</th>
                                        <th>Í≥†Í∞ùÎ≤àÌò∏</th>
                                        <th>Í∏àÏï°</th>
                                        <th>Î£∏Ïàò</th>
                                        <th>ÏúÑÏπò</th>
                                        <th>ÎåÄÏ∂úÏó¨Î∂Ä</th>
                                        <th>Ï£ºÏ∞®</th>
                                        <th>Ïï†ÏôÑ</th>
                                        <th>Î©îÎ™®</th>
                                        <th>ÏßÑÌñâÏó¨Î∂Ä</th>
                                        <th>Ï£ºÍ±∞ÏÇ¨Ïù¥Ìä∏</th>
                                        <th>ÏóÖÎ¨¥ÏÇ¨Ïù¥Ìä∏</th>
                                        <th>Í¥ÄÎ¶¨</th>
                                    </tr>
                                </thead>
                                <tbody id="customers-list">
                                    <!-- Í≥†Í∞ù Î™©Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Í≥†Í∞ù Î©îÎ™® Î™®Îã¨ -->
                <div id="customer-memo-modal" class="modal-overlay" style="display: none;" onclick="closeCustomerMemoModal()">
                    <div class="modal-content" onclick="event.stopPropagation()">
                        <div class="modal-header">
                            <h3 class="modal-title">üìù Î©îÎ™® Ìé∏Ïßë</h3>
                            <button class="modal-close" onclick="closeCustomerMemoModal()">√ó</button>
                        </div>
                        <div class="modal-body">
                            <textarea id="customer-memo-textarea" class="memo-textarea" placeholder="Î©îÎ™®Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî..." rows="12" maxlength="5000"></textarea>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" onclick="closeCustomerMemoModal()">Ï∑®ÏÜå</button>
                            <button class="btn btn-primary" onclick="saveCustomerMemo()">Ï†ÄÏû•</button>
                        </div>
                    </div>
                </div>

                <!-- ÏßÅÏõêÍ¥ÄÎ¶¨ ÏÑπÏÖò -->
                <div id="employees-section" style="display: none;">
                    <!-- ÏÉà ÏßÅÏõê Ï∂îÍ∞Ä Î≤ÑÌäº -->
                    <button class="btn btn-primary" style="margin-bottom:12px; border-radius:10px; font-size:15px; padding:10px 18px; font-weight:600;" onclick="openAddEmployeeModal()">
                        <span style="font-size:18px;">‚ûï</span> ÏÉà ÏßÅÏõê Ï∂îÍ∞Ä
                                </button>
                    
                    <!-- ÏßÅÏõê Î™©Î°ù Ïπ¥Îìú -->
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <h2 class="card-title">
                                <span>üë§</span>
                                ÏßÅÏõê Î™©Î°ù
                            </h2>
                            <div style="display: flex; gap: 10px;">
                                <button type="button" class="btn btn-secondary" onclick="loadTeamLeaderEmployees()">
                                    <span>üîÑ</span>
                                    ÏÉàÎ°úÍ≥†Ïπ®
                                </button>
                            </div>
                        </div>
                        <div class="table-container">
                            <table class="employees-table">
                                <thead>
                                    <tr>
                                        <th>ÏßÅÏõê ÏïÑÏù¥Îîî</th>
                                        <th>ÏßÅÏõê Ïù¥Î¶Ñ</th>
                                        <th>ÌåÄ</th>
                                        <th>Ïó≠Ìï†</th>
                                        <th>ÏÉÅÌÉú</th>
                                        <th>Îì±Î°ùÏùº</th>
                                        <th>ÏûëÏóÖ</th>
                                    </tr>
                                </thead>
                                <tbody id="employees-list">
                                    <!-- ÏßÅÏõê Î™©Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò -->
                        <div id="employee-pagination" style="display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 20px; padding: 20px;">
                            <!-- ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò Î≤ÑÌäºÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Î©îÎ™® Î™®Îã¨ -->
    <div id="memo-modal" class="modal-overlay" onclick="closeMemoModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 class="modal-title">üìù Î©îÎ™® Ìé∏Ïßë</h3>
                <button class="modal-close" onclick="closeMemoModal()">√ó</button>
            </div>
            <div class="modal-body">
                <textarea id="memo-textarea" class="memo-textarea" placeholder="Î©îÎ™®Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî..." rows="6"></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeMemoModal()">Ï∑®ÏÜå</button>
                <button class="btn btn-primary" onclick="saveMemo()">Ï†ÄÏû•</button>
            </div>
        </div>
    </div>

    <!-- ÌåÄ Ï∂îÍ∞Ä/ÏÇ≠Ï†ú Î™®Îã¨ -->
    <div id="addTeamModal" class="modal-overlay" style="display: none;" onclick="closeAddTeamModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 class="modal-title">ÌåÄ Í¥ÄÎ¶¨</h3>
                <button class="modal-close" onclick="closeAddTeamModal()">√ó</button>
            </div>
            <div class="modal-body">
                <!-- ÌåÄ Ï∂îÍ∞Ä ÏÑπÏÖò -->
                <div class="team-section">
                    <h4 style="margin-bottom: 16px; color: #374151;">‚ûï ÏÉà ÌåÄ Ï∂îÍ∞Ä</h4>
                    <div class="form-group">
                        <label for="newTeamName" class="form-label">ÌåÄ Ïù¥Î¶Ñ</label>
                        <input type="text" id="newTeamName" class="form-input" placeholder="ÌåÄ Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" required>
                    </div>
                    <div class="form-group">
                        <label for="newTeamDescription" class="form-label">ÌåÄ ÏÑ§Î™Ö (ÏÑ†ÌÉùÏÇ¨Ìï≠)</label>
                        <textarea id="newTeamDescription" class="form-input" placeholder="ÌåÄÏóê ÎåÄÌïú ÏÑ§Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" rows="3"></textarea>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="addNewTeam()" style="margin-bottom: 24px;">ÌåÄ Ï∂îÍ∞Ä</button>
                </div>
                
                <hr style="margin: 24px 0; border: 1px solid #e5e7eb;">
                
                <!-- ÌåÄ ÏÇ≠Ï†ú ÏÑπÏÖò -->
                <div class="team-section">
                    <h4 style="margin-bottom: 16px; color: #374151;">üóëÔ∏è Í∏∞Ï°¥ ÌåÄ ÏÇ≠Ï†ú</h4>
                    <div class="form-group">
                        <label for="deleteTeamSelect" class="form-label">ÏÇ≠Ï†úÌï† ÌåÄ ÏÑ†ÌÉù</label>
                        <select id="deleteTeamSelect" class="form-input" style="background: white; cursor: pointer;">
                            <option value="">ÌåÄÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                            <option value="ÎπàÏãúÌä∏">ÎπàÏãúÌä∏</option>
                            <option value="ÏúÑÌîåÎü¨Ïä§">ÏúÑÌîåÎü¨Ïä§</option>
                            <option value="Î∞òÌÅ¥Î¶¨ÏÖ∞">Î∞òÌÅ¥Î¶¨ÏÖ∞</option>
                            <option value="ÎåÄÌëú">ÎåÄÌëú</option>
                        </select>
                    </div>
                    <button type="button" class="btn" style="background: #dc2626; color: white;" onclick="deleteSelectedTeam()">ÌåÄ ÏÇ≠Ï†ú</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ÌÉ≠ Ï†ÑÌôò Ìï®Ïàò
        function showTab(tabName, event) {
            console.log('ÌÉ≠ Ï†ÑÌôò:', tabName);
            
            // Î™®Îì† ÏÑπÏÖò Ïà®Í∏∞Í∏∞
            const defaultContent = document.getElementById('default-content');
            const maeipleSection = document.getElementById('maeiple-section');
            const customersSection = document.getElementById('customers-section');
            const employeesSection = document.getElementById('employees-section');
            
            if (defaultContent) defaultContent.style.display = 'none';
            if (maeipleSection) maeipleSection.style.display = 'none';
            if (customersSection) customersSection.style.display = 'none';
            if (employeesSection) employeesSection.style.display = 'none';
            
            // ÏÑ†ÌÉùÎêú ÌÉ≠Ïóê Îî∞Îùº Ìï¥Îãπ ÏÑπÏÖò ÌëúÏãú
            if (tabName === 'dashboard') {
                if (defaultContent) defaultContent.style.display = 'block';
            } else if (tabName === 'maeiple') {
                if (maeipleSection) {
                    maeipleSection.style.display = 'block';
                    // Îß§Î¨ºÍ¥ÄÎ¶¨ ÌÉ≠ ÌôúÏÑ±Ìôî Ïãú ÏïÑÌååÌä∏ Î™©Î°ù Î°úÎìú
                    console.log('üè† Îß§Î¨ºÍ¥ÄÎ¶¨ ÌÉ≠ ÌôúÏÑ±Ìôî');
                    loadMaeipeProperties(); // ÏïÑÌååÌä∏ Î™©Î°ù Î°úÎìú
                }
            } else if (tabName === 'customers') {
                if (customersSection) {
                customersSection.style.display = 'block';
                loadCustomers(); // Í≥†Í∞ù Î™©Î°ù Î°úÎìú
                }
            } else if (tabName === 'employees') {
                if (employeesSection) {
                employeesSection.style.display = 'block';
                    loadTeamLeaderEmployees(); // ÏßÅÏõê Î™©Î°ù Î°úÎìú (ÏàòÏ†ïÎêú Ìï®ÏàòÎ™Ö)
                }
            }
            
            // ÏÇ¨Ïù¥ÎìúÎ∞î ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò ÏóÖÎç∞Ïù¥Ìä∏
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            if (event && event.target) {
                const navItem = event.target.closest('.nav-item');
                if (navItem) navItem.classList.add('active');
            }
        }

        // DOMÏù¥ Î°úÎìúÎêú ÌõÑ Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Îì±Î°ù
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ ÌåÄÏû• ÎåÄÏãúÎ≥¥Îìú JavaScript Ï¥àÍ∏∞Ìôî ÏãúÏûë');
            
            // ÏÇ¨Ïù¥ÎìúÎ∞î ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Îì±Î°ù
            document.querySelectorAll('.nav-item[data-tab]').forEach(navItem => {
                navItem.addEventListener('click', function(event) {
                    event.preventDefault();
                    const tabName = this.getAttribute('data-tab');
                    showTab(tabName, event);
                });
            });
            
            console.log('‚úÖ Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Îì±Î°ù ÏôÑÎ£å');
        });

    // ========== Í≥†Í∞ù Í¥ÄÎ†® Ìï®ÏàòÎì§ ==========
    
    // Ï†ÑÏó≠ Î≥ÄÏàò
    let customers = [];
    let filteredCustomers = [];
    let currentEditingCustomerId = null;

    // Í≥†Í∞ù Î™©Î°ù Î∂àÎü¨Ïò§Í∏∞ (ÌåÄÏû•Ïö© - ÌåÄÏû• Î≥∏Ïù∏Ïùò Í≥†Í∞ùÎßå)
    async function loadCustomers() {
        console.log('--- loadCustomers() ÏãúÏûë (ÌåÄÏû•) ---');
        try {
            // ÌåÄÏû• Î≥∏Ïù∏Ïùò Í≥†Í∞ùÎßå Ï°∞Ìöå
            const response = await fetch('/api/customers');
            const data = await response.json();
            // API ÏùëÎãµ ÌòïÏãù Ï≤òÎ¶¨: { customers: [...], total_count, ... } ÌòπÏùÄ [] ÌòïÌÉú Î™®Îëê ÏßÄÏõê
            customers = Array.isArray(data) ? data : (data.customers || []);
            console.log('ÏÑúÎ≤ÑÏóêÏÑú Î∞õÏïÑÏò® ÌåÄÏû• Î≥∏Ïù∏ Í≥†Í∞ù Î™©Î°ù:', customers);
            filteredCustomers = [...customers];

            displayCustomers(customers);
            
            // ÌïÑÌÑ∞ Ï¥àÍ∏∞Ìôî
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector('[data-filter="all"]').classList.add('active');
            const dateFilter = document.getElementById('date-filter-customers');
            if (dateFilter) dateFilter.value = 'all';
        } catch (error) {
            console.error('loadCustomers()ÏóêÏÑú Ïò§Î•ò Î∞úÏÉù:', error);
            showAlert('Í≥†Í∞ù Î™©Î°ùÏùÑ Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
        }
    }
    

    
    // Í≥†Í∞ù Î™©Î°ù ÌëúÏãú
    async function displayCustomers(customerList) {
        console.log('--- displayCustomers() ÏãúÏûë ---');
        console.log('ÌëúÏãúÌï† Í≥†Í∞ù Ïàò:', customerList.length);
        
        const tbody = document.getElementById('customers-list');
        
                    if (customerList.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="15">
                            <div class="empty-state">
                                <div class="empty-state-icon">üë•</div>
                                <div class="empty-state-title">Îì±Î°ùÎêú Í≥†Í∞ùÏù¥ ÏóÜÏäµÎãàÎã§</div>
                                <div class="empty-state-description">ÏÉà Í≥†Í∞ùÏùÑ Ï∂îÍ∞ÄÌï¥Î≥¥ÏÑ∏Ïöî</div>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
        
        // Í∞Å Í≥†Í∞ùÏùò ÎØ∏ÌôïÏù∏ Ï¢ãÏïÑÏöî ÏàòÎ•º Ïã§ÏãúÍ∞ÑÏúºÎ°ú Í≥ÑÏÇ∞
        const customersWithLikes = await Promise.all(customerList.map(async (customer) => {
            if (!customer.management_site_id) {
                return { ...customer, unchecked_likes_residence: 0, unchecked_likes_business: 0 };
            }
            
            try {
                // Ï£ºÍ±∞ÏÇ¨Ïù¥Ìä∏ ÎØ∏ÌôïÏù∏ Ï¢ãÏïÑÏöî Ïàò Ï°∞Ìöå
                const residenceResponse = await fetch(`/api/employee/unchecked-likes?management_site_id=${customer.management_site_id}&type=residence`);
                const residenceData = await residenceResponse.json();
                const unchecked_residence_count = residenceData.success ? residenceData.count : 0;
                
                // ÏóÖÎ¨¥ÏÇ¨Ïù¥Ìä∏ ÎØ∏ÌôïÏù∏ Ï¢ãÏïÑÏöî Ïàò Ï°∞Ìöå
                const businessResponse = await fetch(`/api/employee/unchecked-likes?management_site_id=${customer.management_site_id}&type=business`);
                const businessData = await businessResponse.json();
                const unchecked_business_count = businessData.success ? businessData.count : 0;
                
                return {
                    ...customer,
                    unchecked_likes_residence: unchecked_residence_count,
                    unchecked_likes_business: unchecked_business_count
                };
            } catch (error) {
                console.error(`Í≥†Í∞ù ${customer.customer_name}Ïùò Ï¢ãÏïÑÏöî Ïàò Ï°∞Ìöå Ïã§Ìå®:`, error);
                return { ...customer, unchecked_likes_residence: 0, unchecked_likes_business: 0 };
            }
        }));
        
        tbody.innerHTML = customersWithLikes.map(customer => {
            const statusClass = customer.status === 'Í≥ÑÏïΩ' ? 'status-complete' : 
                               customer.status === 'Î≥¥Î•ò' ? 'status-hold' : 'status-progress';
            const memoText = customer.memo || '';
            const memoDisplay = memoText ? (memoText.length > 10 ? memoText.substring(0, 10) + '...' : memoText) : 'ÌÅ¥Î¶≠ÌïòÏó¨ Î©îÎ™® Ï∂îÍ∞Ä';
            // ÎØ∏ÌôïÏù∏ Ï¢ãÏïÑÏöî ÏïåÎ¶º ÌÖçÏä§Ìä∏ (Ïã§ÏãúÍ∞Ñ Í≥ÑÏÇ∞Îêú Í∞í ÏÇ¨Ïö©)
            const residenceAlarm = customer.unchecked_likes_residence > 0 ? 
                `<div class='like-alarm' style="background:linear-gradient(135deg, #4caf50, #45a049); color:white; border-radius:12px; padding:4px 10px; margin:4px 0; font-weight:700; font-size:12px; display:inline-block; box-shadow:0 2px 8px rgba(76,175,80,0.3); animation:pulse 2s infinite;">‚ù§Ô∏è ${customer.unchecked_likes_residence}Í±¥ Ïã†Í∑ú</div>` : '';
            const businessAlarm = customer.unchecked_likes_business > 0 ? 
                `<div class='like-alarm' style="background:linear-gradient(135deg, #ff9800, #f57c00); color:white; border-radius:12px; padding:4px 10px; margin:4px 0; font-weight:700; font-size:12px; display:inline-block; box-shadow:0 2px 8px rgba(255,152,0,0.3); animation:pulse 2s infinite;">üíº ${customer.unchecked_likes_business}Í±¥ Ïã†Í∑ú</div>` : '';
            return `
                <tr data-customer-id="${customer.id}">
                    <td class="editable-cell" data-field="inquiry_date" data-type="date" onclick="editCell(this)">${customer.inquiry_date || '-'}</td>
                    <td class="editable-cell" data-field="move_in_date" data-type="date" onclick="editCell(this)">${customer.move_in_date || '-'}</td>
                    <td class="editable-cell" data-field="customer_name" data-type="text" onclick="editCell(this)"><strong>${customer.customer_name || '-'}</strong>${customer.employee_id ? `<br><small style="color: #6366f1;">(${customer.employee_id})</small>` : ''}</td>
                    <td class="editable-cell" data-field="customer_phone" data-type="tel" onclick="editCell(this)" style="font-family: monospace; letter-spacing: 0.5px;">${customer.customer_phone ? formatPhoneNumber(customer.customer_phone) : '-'}</td>
                    <td class="editable-cell" data-field="budget" data-type="text" onclick="editCell(this)">${customer.budget || '-'}</td>
                    <td class="editable-cell" data-field="rooms" data-type="text" onclick="editCell(this)">${customer.rooms || '-'}</td>
                    <td class="editable-cell" data-field="location" data-type="text" onclick="editCell(this)">${customer.location || '-'}</td>
                    <td class="editable-cell" data-field="loan_needed" data-type="text" onclick="editCell(this)">${customer.loan_needed === false ? '-' : (customer.loan_needed || '-')}</td>
                    <td class="editable-cell" data-field="parking_needed" data-type="text" onclick="editCell(this)">${customer.parking_needed === false ? '-' : (customer.parking_needed || '-')}</td>
                    <td class="editable-cell" data-field="pets" data-type="text" onclick="editCell(this)">${customer.pets || '-'}</td>
                    <td class="memo-cell" onclick="editMemo(this)" data-memo="${memoText || ''}" ${memoText && memoText.trim() ? `title="${memoText}"` : ''} style="cursor: pointer; color: ${memoText ? '#4b5563' : '#9ca3af'};">${memoDisplay}</td>
                    <td class="editable-cell" data-field="status" data-type="select" onclick="editCell(this)">
                        <span class="status-badge ${statusClass}">
                            ${customer.status || 'ÏßÑÌñâÏ§ë'}
                        </span>
                    </td>
                    <td>
                        ${customer.management_site_id ? 
                            `<a href="/residence/customer/${customer.management_site_id}" target="_blank" class="management-link" onclick="markResidenceLikesChecked('${customer.management_site_id}')">Ï£ºÍ±∞ÏÇ¨Ïù¥Ìä∏</a> ${residenceAlarm}` :
                            '<span class="property-link-placeholder">Ï£ºÍ±∞ÏÇ¨Ïù¥Ìä∏ ÏóÜÏùå</span>'
                        }
                    </td>
                    <td>
                        ${customer.management_site_id ? 
                            `<a href="/business/customer/${customer.management_site_id}" target="_blank" class="management-link" onclick="markBusinessLikesChecked('${customer.management_site_id}')">ÏóÖÎ¨¥ÏÇ¨Ïù¥Ìä∏</a> ${businessAlarm}` :
                            '<span class="property-link-placeholder">ÏóÖÎ¨¥ÏÇ¨Ïù¥Ìä∏ ÏóÜÏùå</span>'
                        }
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-danger btn-sm" onclick="deleteCustomer(${customer.id}, '${customer.customer_name}')" title="Í≥†Í∞ù ÏÇ≠Ï†ú">
                                üóëÔ∏è ÏÇ≠Ï†ú
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }).join('');
    }

    // Í≥†Í∞ùÎ™Ö ÏûêÎèô ÏÉùÏÑ± Ìï®Ïàò
    function generateCustomerName() {
        const now = new Date();
        const year = now.getFullYear().toString().slice(-2);
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const day = String(now.getDate()).padStart(2, '0');
        const hour = String(now.getHours()).padStart(2, '0');
        const minute = String(now.getMinutes()).padStart(2, '0');
        const second = String(now.getSeconds()).padStart(2, '0');
        
        return `Í≥†Í∞ù_${year}${month}${day}_${hour}${minute}${second}`;
    }

    // ÏÉà Ìñâ Ï∂îÍ∞Ä
    function addNewRow() {
        const tbody = document.getElementById('customers-list');
        // Ïò§Îäò ÎÇ†Ïßú Íµ¨ÌïòÍ∏∞ (ÌïúÍµ≠ÏãúÍ∞Ñ Í∏∞Ï§Ä)
        const now = new Date();
        now.setHours(now.getHours() + 9);
        const today = now.toISOString().slice(0, 10);
        
        // ÏûêÎèô Í≥†Í∞ùÎ™Ö ÏÉùÏÑ±
        const autoCustomerName = generateCustomerName();

        const newRow = document.createElement('tr');
        newRow.className = 'new-row';
        newRow.innerHTML = `
            <td class="editable-cell" data-field="inquiry_date" data-type="date" onclick="editCell(this)">${today}</td>
            <td class="editable-cell" data-field="move_in_date" data-type="date" onclick="editCell(this)">-</td>
            <td class="editable-cell" data-field="customer_name" data-type="text" onclick="editCell(this)"><strong>${autoCustomerName}</strong></td>
            <td class="editable-cell" data-field="customer_phone" data-type="tel" onclick="editCell(this)">-</td>
            <td class="editable-cell" data-field="budget" data-type="text" onclick="editCell(this)">-</td>
            <td class="editable-cell" data-field="rooms" data-type="text" onclick="editCell(this)">-</td>
            <td class="editable-cell" data-field="location" data-type="text" onclick="editCell(this)">-</td>
            <td class="editable-cell" data-field="loan_needed" data-type="text" onclick="editCell(this)">-</td>
            <td class="editable-cell" data-field="parking_needed" data-type="text" onclick="editCell(this)">-</td>
            <td class="editable-cell" data-field="pets" data-type="text" onclick="editCell(this)">-</td>
            <td class="memo-cell" onclick="editMemo(this)" title="" style="cursor: pointer; color: #9ca3af;">ÌÅ¥Î¶≠ÌïòÏó¨ Î©îÎ™® Ï∂îÍ∞Ä</td>
            <td class="editable-cell" data-field="status" data-type="select" onclick="editCell(this)">
                <span class="status-badge status-progress">ÏßÑÌñâÏ§ë</span>
            </td>
            <td><span class="property-link-placeholder">Ï£ºÍ±∞ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ± Ï§ë...</span></td>
            <td><span class="property-link-placeholder">ÏóÖÎ¨¥ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ± Ï§ë...</span></td>
            <td>
                <div class="action-buttons">
                    <button class="btn btn-primary btn-sm" onclick="saveNewCustomer(this)">Ï†ÄÏû•</button>
                    <button class="btn btn-secondary btn-sm" onclick="cancelNewRow(this)">Ï∑®ÏÜå</button>
                </div>
            </td>
        `;
        tbody.insertBefore(newRow, tbody.firstChild);
    }
    
    // ÏÉà Í≥†Í∞ù Ï†ÄÏû•
    async function saveNewCustomer(button) {
        const row = button.closest('tr');
        const cells = row.querySelectorAll('.editable-cell, .memo-cell');
        
        // ÎîîÎ≤ÑÍπÖ: ÏÑ∏ÏÖò Ï†ïÎ≥¥ ÌôïÏù∏
        console.log('üîç ÏÑ∏ÏÖò Ï†ïÎ≥¥ ÌôïÏù∏ Ï§ë...');
        try {
            const sessionResponse = await fetch('/api/employee/session-info');
            const sessionData = await sessionResponse.json();
            console.log('üìã ÌòÑÏû¨ ÏÑ∏ÏÖò Ï†ïÎ≥¥:', sessionData);
            
            if (!sessionData.employee_id) {
                showAlert('Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§. Îã§Ïãú Î°úÍ∑∏Ïù∏Ìï¥Ï£ºÏÑ∏Ïöî.', 'error');
                return;
            }
            
            if (sessionData.employee_role !== 'ÌåÄÏû•') {
                showAlert('ÌåÄÏû• Í∂åÌïúÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.', 'error');
                return;
            }
            
            if (!sessionData.employee_team) {
                showAlert('ÌåÄ Ï†ïÎ≥¥Í∞Ä ÏÑ§Ï†ïÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§. Í¥ÄÎ¶¨ÏûêÏóêÍ≤å Î¨∏ÏùòÌïòÏÑ∏Ïöî.', 'error');
                return;
            }
        } catch (error) {
            console.error('‚ùå ÏÑ∏ÏÖò Ï†ïÎ≥¥ ÌôïÏù∏ Ïã§Ìå®:', error);
            showAlert('ÏÑ∏ÏÖò Ï†ïÎ≥¥Î•º ÌôïÏù∏Ìï† Ïàò ÏóÜÏäµÎãàÎã§.', 'error');
            return;
        }
        
        const customerData = {};
        cells.forEach(cell => {
            const field = cell.dataset.field;
            if (field) {
                let value = cell.textContent.trim();
                // Îπà Í∞íÏù¥ÎÇò Í∏∞Î≥∏ ÌîåÎ†àÏù¥Ïä§ÌôÄÎçî Ï†úÏô∏
                if (value === '-' || value === 'ÌÅ¥Î¶≠ÌïòÏó¨ ÏûÖÎ†•') {
                    value = '';
                }
                customerData[field] = value;
            }
        });
        
        // Î©îÎ™® ÏÖÄ Ï≤òÎ¶¨ - dataset Ïö∞ÏÑ†, textContentÎäî Î∞±ÏóÖ
        const memoCell = row.querySelector('.memo-cell');
        if (memoCell) {
            let memoValue = memoCell.dataset.memo || memoCell.textContent.trim();
            if (memoValue === '-' || memoValue === 'ÌÅ¥Î¶≠ÌïòÏó¨ Î©îÎ™® Ï∂îÍ∞Ä') {
                memoValue = '';
            }
            customerData.memo = memoValue;
        } else {
            customerData.memo = '';
        }
        
        // ÏûÑÏãúÎ°ú Ï†ÄÏû•Îêú ÏßÑÌñâÏó¨Î∂ÄÍ∞Ä ÏûàÏúºÎ©¥ Ìè¨Ìï®
        if (row.dataset.tempStatus) {
            customerData.status = row.dataset.tempStatus;
        } else if (!customerData.status) {
            customerData.status = 'ÏßÑÌñâÏ§ë';
        }
        
        // ÏûÑÏãúÎ°ú Ï†ÄÏû•Îêú ÎåÄÏ∂úÏó¨Î∂ÄÏôÄ Ï£ºÏ∞® Ï†ïÎ≥¥Í∞Ä ÏûàÏúºÎ©¥ Ìè¨Ìï®
        if (row.dataset.temploan_needed) {
            customerData.loan_needed = row.dataset.temploan_needed === 'ÌïÑÏöî' ? true : null;
        }
        if (row.dataset.tempparking_needed) {
            customerData.parking_needed = row.dataset.tempparking_needed === 'ÌïÑÏöî' ? true : null;
        }
        
        // budgetÎ•º Ïà´ÏûêÎ°ú Î≥ÄÌôò
        if (customerData.budget) {
            const budgetNum = parseInt(customerData.budget.replace(/[^0-9]/g, ''));
            customerData.budget = isNaN(budgetNum) ? null : budgetNum;
        } else {
            customerData.budget = null;
        }
        
        // ÌïÑÏàò ÌïÑÎìú ÌôïÏù∏
        if (!customerData.customer_name) {
            showAlert('Í≥†Í∞ùÎ™ÖÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'error');
            return;
        }
        
        // integer ÌïÑÎìú Í∏∞Î≥∏Í∞í ÏÑ§Ï†ï (ÎØ∏ÌôïÏù∏ Ï¢ãÏïÑÏöî Í∞úÏàò)
        customerData.unchecked_likes_residence = 0;
        customerData.unchecked_likes_business = 0;
        
        // loan_neededÏôÄ parking_neededÎäî Í∞íÏù¥ ÏóÜÏúºÎ©¥ ÌïÑÎìú ÏûêÏ≤¥Î•º Ï†úÍ±∞
        if (customerData.loan_needed === undefined || customerData.loan_needed === '' || customerData.loan_needed === null) {
            delete customerData.loan_needed;
        }
        if (customerData.parking_needed === undefined || customerData.parking_needed === '' || customerData.parking_needed === null) {
            delete customerData.parking_needed;
        }
        
        console.log('ÏÉà Í≥†Í∞ù Ï†ÄÏû• Îç∞Ïù¥ÌÑ∞:', customerData);
        
        try {
            console.log('üì§ API ÏöîÏ≤≠ Ï†ÑÏÜ° Ï§ë...');
            console.log('üìã ÏöîÏ≤≠ Îç∞Ïù¥ÌÑ∞:', customerData);
            
            const response = await fetch('/api/customers', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(customerData)
            });
            
            console.log('üì• API ÏùëÎãµ ÏÉÅÌÉú:', response.status, response.statusText);
            
            if (!response.ok) {
                const errorText = await response.text();
                console.error('API Ïò§Î•ò ÏùëÎãµ:', errorText);
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            
            const result = await response.json();
            console.log('üì• Í≥†Í∞ù Ï∂îÍ∞Ä API ÏùëÎãµ:', result);

            if (result.success && result.customer) {
                console.log('‚úÖ Í≥†Í∞ù Ï∂îÍ∞Ä ÏÑ±Í≥µ:', result.customer);
                showAlert(result.message || 'Í≥†Í∞ùÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§.', 'success');

                // ÏµúÏã† ÏÑúÎ≤Ñ ÏÉÅÌÉúÎ•º Îã§Ïãú Î∂àÎü¨ÏôÄ ÎèôÍ∏∞Ìôî
                await loadCustomers();
            } else {
                console.error('‚ùå Í≥†Í∞ù Ï∂îÍ∞Ä Ïã§Ìå®:', result);
                const errorMessage = result.message || result.error || 'Í≥†Í∞ù Ï∂îÍ∞ÄÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.';
                showAlert(`Í≥†Í∞ù Ï∂îÍ∞Ä Ïã§Ìå®: ${errorMessage}`, 'error');
            }
        } catch (error) {
            console.error('‚ùå Í≥†Í∞ù Ï∂îÍ∞Ä Ïò§Î•ò:', error);
            let errorMessage = 'ÏÑúÎ≤Ñ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.';
            
            if (error.name === 'TypeError' && error.message.includes('fetch')) {
                errorMessage = 'ÎÑ§Ìä∏ÏõåÌÅ¨ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. ÏÑúÎ≤Ñ Ïó∞Í≤∞ÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.';
            } else if (error.message.includes('HTTP')) {
                errorMessage = `ÏÑúÎ≤Ñ Ïò§Î•ò (${error.message})`;
            } else {
                errorMessage = `Ïò§Î•ò: ${error.message}`;
            }
            
            showAlert(errorMessage, 'error');
        }
    }
    
    // ÏÉà Ìñâ Ï∑®ÏÜå
    function cancelNewRow(button) {
        const row = button.closest('tr');
        row.remove();
    }
    
    // Í≥†Í∞ù ÏÇ≠Ï†ú Ìï®Ïàò
    async function deleteCustomer(customerId, customerName) {
        if (!confirm(`Ï†ïÎßêÎ°ú "${customerName}" Í≥†Í∞ùÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?\n\n‚ö†Ô∏è Ïù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§.`)) {
            return;
        }
        
        try {
            const response = await fetch(`/api/customers/${customerId}`, {
                method: 'DELETE',
                headers: { 'Content-Type': 'application/json' }
            });
            
            const result = await response.json();
            
            if (result.success) {
                showAlert(`"${customerName}" Í≥†Í∞ùÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.`, 'success');
                // Í≥†Í∞ù Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®
                await loadCustomers();
            } else {
                showAlert('Í≥†Í∞ù ÏÇ≠Ï†úÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§: ' + (result.message || 'Ïïå Ïàò ÏóÜÎäî Ïò§Î•ò'), 'error');
            }
        } catch (error) {
            console.error('Í≥†Í∞ù ÏÇ≠Ï†ú Ïò§Î•ò:', error);
            showAlert('ÏÑúÎ≤Ñ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
        }
    }

    // ÏÖÄ Ìé∏Ïßë
    function editCell(cell) {
        // Ïù¥ÎØ∏ Ìé∏Ïßë Ï§ëÏù∏ Í≤ΩÏö∞ Í∏∞Ï°¥ Ìé∏Ïßë UI Ï†úÍ±∞
        if (cell.classList.contains('editing-cell')) {
            const existingSelector = cell.querySelector('.status-selector');
            if (existingSelector) {
                existingSelector.remove();
            }
            const existingInput = cell.querySelector('input, select');
            if (existingInput) {
                existingInput.remove();
            }
            cell.classList.remove('editing-cell');
        }

        const field = cell.dataset.field;
        const type = cell.dataset.type;
        let currentValue = cell.textContent.trim();

        // ÏÉÅÌÉú ÌïÑÎìúÏùò Í≤ΩÏö∞ Î∞∞ÏßÄ ÌÖçÏä§Ìä∏Îßå Í∞ÄÏ†∏Ïò§Í∏∞
        if (field === 'status') {
            const badge = cell.querySelector('.status-badge');
            if (badge) {
                currentValue = badge.textContent.trim();
            }
        }

        if (type === 'select') {
            // ÏÉÅÌÉú ÎòêÎäî boolean ÌïÑÎìú ÏÑ†ÌÉù Î©îÎâ¥
            const existingMenu = document.querySelector('.customer-status-menu');
            if (existingMenu) {
                existingMenu.remove();
                return;
            }
            
            const menu = document.createElement('div');
            menu.className = 'customer-status-menu';
            menu.style.cssText = `
                position: absolute;
                background: white;
                border: 1px solid #e2e8f0;
                border-radius: 6px;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
                z-index: 1000;
                min-width: 100px;
            `;
            
            // ÌïÑÎìúÏóê Îî∞Îùº ÏòµÏÖò ÏÑ§Ï†ï
            let options = [];
            if (field === 'status') {
                options = ['ÏßÑÌñâÏ§ë', 'ÏôÑÎ£å', 'Í≥ÑÏïΩ', 'Î≥¥Î•ò'];
            } else if (field === 'loan_needed' || field === 'parking_needed') {
                options = ['ÌïÑÏöî', 'Î∂àÌïÑÏöî'];
            }
            
            options.forEach(status => {
                const option = document.createElement('button');
                option.textContent = status;
                option.style.cssText = `
                    width: 100%;
                    padding: 8px 12px;
                    border: none;
                    background: ${status === currentValue ? '#f1f5f9' : 'transparent'};
                    text-align: left;
                    cursor: pointer;
                    font-size: 12px;
                `;
                
                option.onmouseenter = () => option.style.background = '#f1f5f9';
                option.onmouseleave = () => option.style.background = status === currentValue ? '#f1f5f9' : 'transparent';
                
                option.onclick = async () => {
                    const customerId = cell.closest('tr').dataset.customerId;
                    
                    if (customerId) {
                        // Í∏∞Ï°¥ Í≥†Í∞ù ÏàòÏ†ï
                        if (field === 'status') {
                            await saveCustomerField(customerId, 'status', status);
                        } else {
                            await saveCustomerField(customerId, field, status);
                        }
                    } else {
                        // ÏÉà ÌñâÏùò Í≤ΩÏö∞ ÏûÑÏãú Ï†ÄÏû•
                        if (field === 'status') {
                            cell.closest('tr').dataset.tempStatus = status;
                        } else {
                            cell.closest('tr').dataset[`temp${field}`] = status;
                        }
                    }
                    
                    // UI Ï¶âÏãú ÏóÖÎç∞Ïù¥Ìä∏
                    if (field === 'status') {
                        const statusClass = status === 'Í≥ÑÏïΩ' ? 'status-complete' : 
                                           status === 'ÏôÑÎ£å' ? 'status-complete' :
                                           status === 'Î≥¥Î•ò' ? 'status-hold' : 'status-progress';
                        
                        cell.innerHTML = `<span class="status-badge ${statusClass}">${status}</span>`;
                    } else {
                        cell.textContent = status;
                    }
                    
                    // Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
                    const customer = customers.find(c => c.id === parseInt(customerId));
                    if (customer) {
                        customer[field] = status;
                    }
                    
                    menu.remove();
                };
                
                menu.appendChild(option);
            });
            
            // Î©îÎâ¥ ÏúÑÏπò ÏÑ§Ï†ï
            const rect = cell.getBoundingClientRect();
            menu.style.left = rect.left + 'px';
            menu.style.top = (rect.bottom + window.scrollY) + 'px';
            
            document.body.appendChild(menu);
            
            // Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Î©îÎâ¥ Îã´Í∏∞
            setTimeout(() => {
                document.addEventListener('click', function closeMenu(e) {
                    if (!menu.contains(e.target) && e.target !== cell) {
                        menu.remove();
                        document.removeEventListener('click', closeMenu);
                    }
                });
            }, 100);

        } else if (type === 'date') {
            // ÎÇ†Ïßú ÏûÖÎ†• - Îã¨Î†• Ï¶âÏãú ÌëúÏãú
            const input = document.createElement('input');
            input.type = 'date';
            input.value = currentValue === '-' ? '' : currentValue;
            
            // ÏÖÄÏùò ÏúÑÏπòÎ•º Ï†ïÌôïÌïòÍ≤å Í≥ÑÏÇ∞
            const rect = cell.getBoundingClientRect();
            const tableContainer = cell.closest('.table-container');
            const containerRect = tableContainer ? tableContainer.getBoundingClientRect() : null;
            
            // Îã¨Î†•Ïù¥ Ï†úÎåÄÎ°ú Î≥¥Ïù¥ÎèÑÎ°ù Ïä§ÌÉÄÏùº Ï°∞Ï†ï
            input.style.cssText = `
                width: 150px;
                padding: 6px;
                border: 2px solid #3b82f6;
                border-radius: 4px;
                background: white;
                font-size: 13px;
                position: fixed;
                z-index: 9999;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                left: ${rect.left}px;
                top: ${rect.top}px;
            `;
            
            // ÏûÖÎ†• ÌïÑÎìúÎ•º bodyÏóê Ï∂îÍ∞ÄÌïòÏó¨ ÌÖåÏù¥Î∏îÏùò overflowÏóê ÏòÅÌñ•Î∞õÏßÄ ÏïäÎèÑÎ°ù
            document.body.appendChild(input);
            cell.classList.add('editing-cell');
            
            // Ï¶âÏãú Îã¨Î†• ÌëúÏãú
            setTimeout(() => {
                input.focus();
                input.click();
                if (input.showPicker) {
                    try {
                        input.showPicker();
                    } catch (e) {
                        console.log('Îã¨Î†• ÌëúÏãú Ïã§Ìå®:', e);
                    }
                }
            }, 10);
            
            // change Ïù¥Î≤§Ìä∏Î°ú Ï†ÄÏû•
            input.addEventListener('change', async function() {
                const newValue = this.value || '-';
                const customerId = cell.closest('tr').dataset.customerId;
                
                if (customerId) {
                    await saveCustomerField(customerId, field, newValue === '-' ? '' : newValue);
                }
                
                cell.textContent = newValue;
                cell.classList.remove('editing-cell');
                input.remove(); // bodyÏóêÏÑú ÏûÖÎ†• ÌïÑÎìú Ï†úÍ±∞
            });
            
            // ESC ÌÇ§Î°ú Ï∑®ÏÜå
            input.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    cell.textContent = currentValue;
                    cell.classList.remove('editing-cell');
                    input.remove(); // bodyÏóêÏÑú ÏûÖÎ†• ÌïÑÎìú Ï†úÍ±∞
                }
            });
            
            // blur Ïù¥Î≤§Ìä∏Îäî Îã¨Î†•Ïù¥ Îã´Ìûê ÎïåÎßå Ï≤òÎ¶¨
            input.addEventListener('blur', function() {
                setTimeout(() => {
                    if (!input.value && currentValue !== '-') {
                        cell.textContent = currentValue;
                    }
                    cell.classList.remove('editing-cell');
                    input.remove(); // bodyÏóêÏÑú ÏûÖÎ†• ÌïÑÎìú Ï†úÍ±∞
                }, 300);
            });
            
            // Enter ÌÇ§Î°ú Ï†ÄÏû• Î∞è Îã§Ïùå ÏÖÄÎ°ú Ïù¥Îèô
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    // Í∞íÏù¥ ÏûàÏúºÎ©¥ change Ïù¥Î≤§Ìä∏ Ìä∏Î¶¨Í±∞
                    if (input.value) {
                        input.dispatchEvent(new Event('change'));
                    } else {
                        input.blur();
                    }
                    // Îã§Ïùå Ìé∏Ïßë Í∞ÄÎä•Ìïú ÏÖÄÎ°ú Ïù¥Îèô
                    const nextCell = cell.nextElementSibling;
                    if (nextCell && nextCell.onclick) {
                        setTimeout(() => nextCell.click(), 100);
                    }
                }
            });


        } else if (type === 'select-bool') {
            // Î∂àÎ¶∞ ÏÑ†ÌÉù (ÎåÄÏ∂úÏó¨Î∂Ä, Ï£ºÏ∞®)
            const selectElement = document.createElement('select');
            selectElement.className = 'bool-selector';
            
            if (field === 'loan_needed') {
                selectElement.innerHTML = `
                    <option value="-" ${currentValue === '-' ? 'selected' : ''}>ÏÑ†ÌÉù</option>
                    <option value="O" ${currentValue === 'O' || currentValue === 'Ïòà' || currentValue === 'true' ? 'selected' : ''}>ÌïÑÏöî</option>
                    <option value="X" ${currentValue === 'X' || currentValue === 'ÏïÑÎãàÏò§' || currentValue === 'false' ? 'selected' : ''}>Î∂àÌïÑÏöî</option>
                `;
            } else if (field === 'parking_needed') {
                selectElement.innerHTML = `
                    <option value="-" ${currentValue === '-' ? 'selected' : ''}>ÏÑ†ÌÉù</option>
                    <option value="O" ${currentValue === 'O' || currentValue === 'ÌïÑÏöî' || currentValue === 'true' ? 'selected' : ''}>ÌïÑÏöî</option>
                    <option value="X" ${currentValue === 'X' || currentValue === 'Î∂àÌïÑÏöî' || currentValue === 'false' ? 'selected' : ''}>Î∂àÌïÑÏöî</option>
                `;
            }

            selectElement.addEventListener('change', async function() {
                const newValue = this.value;
                const customerId = cell.closest('tr').dataset.customerId;
                
                if (customerId) {
                    await saveCustomerField(customerId, field, newValue);
                }
                
                cell.textContent = newValue;
                cell.classList.remove('editing-cell');
            });

            selectElement.addEventListener('blur', function() {
                cell.textContent = currentValue;
                cell.classList.remove('editing-cell');
            });

            // Enter/Tab ÌÇ§Î°ú Îã§Ïùå ÏÖÄÎ°ú Ïù¥Îèô
            selectElement.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === 'Tab') {
                    e.preventDefault();
                    const newValue = this.value;
                    cell.textContent = newValue;
                    cell.classList.remove('editing-cell');
                    
                    // Í∞í Ï†ÄÏû•
                    const customerId = cell.closest('tr').dataset.customerId;
                    if (customerId) {
                        saveCustomerField(customerId, field, newValue);
                    }
                    
                    // Îã§Ïùå Ìé∏Ïßë Í∞ÄÎä•Ìïú ÏÖÄÎ°ú Ïù¥Îèô
                    const nextCell = cell.nextElementSibling;
                    if (nextCell && nextCell.classList.contains('editable-cell')) {
                        setTimeout(() => nextCell.click(), 100);
                    }
                }
            });

            cell.innerHTML = '';
            cell.appendChild(selectElement);
            cell.classList.add('editing-cell');
            selectElement.focus();

        } else {
            // ÌÖçÏä§Ìä∏ ÏûÖÎ†•
            const input = document.createElement('input');
            input.type = type === 'tel' ? 'tel' : 'text';
            input.value = currentValue === '-' ? '' : currentValue;
            
            input.addEventListener('blur', async function() {
                const newValue = this.value.trim() || '-';
                const customerId = cell.closest('tr').dataset.customerId;
                
                if (customerId) {
                    await saveCustomerField(customerId, field, newValue === '-' ? '' : newValue);
                }
                
                // Ï†ÑÌôîÎ≤àÌò∏ Ìè¨Îß∑ÌåÖ
                if (type === 'tel' && newValue !== '-') {
                    cell.innerHTML = `<span style="font-family: monospace; letter-spacing: 0.5px;">${formatPhoneNumber(newValue)}</span>`;
                } else if (field === 'customer_name' && newValue !== '-') {
                    cell.innerHTML = `<strong>${newValue}</strong>`;
                } else if (field === 'loan_needed' || field === 'parking_needed') {
                    // ÎåÄÏ∂úÏó¨Î∂Ä, Ï£ºÏ∞® ÌïÑÎìúÎäî ÌïÑÏöî/Î∂àÌïÑÏöîÎ°ú ÌëúÏãú (Í≥µÎûÄÏùÄ '-')
                    if (newValue === '-' || newValue === '') {
                        cell.textContent = '-';
                    } else if (newValue === 'O' || newValue === 'ÌïÑÏöî' || newValue === 'true') {
                        cell.textContent = 'ÌïÑÏöî';
                    } else if (newValue === 'X' || newValue === 'Î∂àÌïÑÏöî' || newValue === 'false') {
                        cell.textContent = 'Î∂àÌïÑÏöî';
                    } else {
                        cell.textContent = newValue;
                    }
                } else {
                    cell.textContent = newValue;
                }
                cell.classList.remove('editing-cell');
            });

            input.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === 'Tab') {
                    e.preventDefault();
                    this.blur();
                    
                    // Îã§Ïùå Ìé∏Ïßë Í∞ÄÎä•Ìïú ÏÖÄÎ°ú Ïù¥Îèô
                    const currentCell = this.closest('.editable-cell');
                    const nextCell = currentCell.nextElementSibling;
                    if (nextCell && nextCell.classList.contains('editable-cell')) {
                        setTimeout(() => nextCell.click(), 100);
                    }
                }
            });

            cell.innerHTML = '';
            cell.appendChild(input);
            cell.classList.add('editing-cell');
            input.focus();
        }
    }

    // Í≥†Í∞ù ÌïÑÎìú Ï†ÄÏû•
    async function saveCustomerField(customerId, field, value) {
        try {
            // ÌïÑÎìúÎ≥Ñ Îç∞Ïù¥ÌÑ∞ ÌÉÄÏûÖ Î≥ÄÌôò
            let processedValue = value;
            
            if (field === 'budget' && value !== '' && value !== '-') {
                // budgetÎ•º Ïà´ÏûêÎ°ú Î≥ÄÌôò
                processedValue = parseInt(value.replace(/[^0-9]/g, '')) || null;
            } else if (field === 'rooms' && value !== '' && value !== '-') {
                // roomsÎ•º Î¨∏ÏûêÏó¥Î°ú Ï†ÄÏû• (Ïà´ÏûêÏù¥ÏßÄÎßå ÌÖçÏä§Ìä∏ ÌïÑÎìúÎ°ú Ï≤òÎ¶¨)
                processedValue = value.toString();
            } else if (field === 'loan_needed') {
                // loan_neededÎ•º booleanÏúºÎ°ú Î≥ÄÌôò (Í≥µÎûÄÏùÄ nullÎ°ú Ï≤òÎ¶¨)
                if (value === '-' || value === '') {
                    processedValue = null;
                } else {
                    processedValue = value === 'O' || value === 'ÌïÑÏöî' || value === 'Ïòà' || value === 'true';
                }
            } else if (field === 'parking_needed') {
                // parking_neededÎ•º booleanÏúºÎ°ú Î≥ÄÌôò (Í≥µÎûÄÏùÄ nullÎ°ú Ï≤òÎ¶¨)
                if (value === '-' || value === '') {
                    processedValue = null;
                } else {
                    processedValue = value === 'O' || value === 'ÌïÑÏöî' || value === 'true';
                }
            } else if (value === '-' || value === '') {
                processedValue = '';
            }
            
            const response = await fetch(`/api/customers/${customerId}/field`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ [field]: processedValue })
            });

            const result = await response.json();
            if (result.success) {
                console.log(`${field} ÏóÖÎç∞Ïù¥Ìä∏ ÏÑ±Í≥µ:`, processedValue);
            } else {
                showAlert(result.message || 'ÏóÖÎç∞Ïù¥Ìä∏Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
            }
        } catch (error) {
            console.error('ÌïÑÎìú ÏóÖÎç∞Ïù¥Ìä∏ Ïò§Î•ò:', error);
            showAlert('ÏÑúÎ≤Ñ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
        }
    }

    // Ï†ÑÌôîÎ≤àÌò∏ Ìè¨Îß∑ÌåÖ
    function formatPhoneNumber(phone) {
        if (!phone) return '';
        const cleaned = phone.replace(/\D/g, '');
        if (cleaned.length === 11) {
            return cleaned.replace(/(\d{3})(\d{4})(\d{4})/, '$1-$2-$3');
        } else if (cleaned.length === 10) {
            return cleaned.replace(/(\d{3})(\d{3})(\d{4})/, '$1-$2-$3');
        }
        return phone;
    }

    // ÌïÑÌÑ∞ÎßÅ Ìï®ÏàòÎì§
    function filterCustomers(status) {
        console.log('ÌïÑÌÑ∞ÎßÅ ÏÉÅÌÉú:', status);
        
        // ÌïÑÌÑ∞ Î≤ÑÌäº ÌôúÏÑ±Ìôî ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        document.querySelector(`[data-filter="${status}"]`).classList.add('active');
        
        if (status === 'all') {
            filteredCustomers = [...customers];
        } else {
            filteredCustomers = customers.filter(customer => customer.status === status);
        }
        
        displayCustomers(filteredCustomers);
    }

    function filterByDate(period) {
        console.log('ÎÇ†Ïßú ÌïÑÌÑ∞ÎßÅ:', period);
        
        const now = new Date();
        let filteredByDate = [...customers];
        
        if (period !== 'all') {
            filteredByDate = customers.filter(customer => {
                if (!customer.inquiry_date) return false;
                
                const inquiryDate = new Date(customer.inquiry_date);
                
                switch(period) {
                    case 'today':
                        return inquiryDate.toDateString() === now.toDateString();
                    case 'week':
                        const weekAgo = new Date();
                        weekAgo.setDate(weekAgo.getDate() - 7);
                        return inquiryDate >= weekAgo;
                    case 'month':
                        const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);
                        return inquiryDate >= startOfMonth;
                    default:
                        return true;
                }
            });
        }
        
        filteredCustomers = filteredByDate;
        displayCustomers(filteredCustomers);
    }

    // Í≥†Í∞ù Î©îÎ™® Ìé∏Ïßë (Í∏∞Ï°¥ Í≥†Í∞ùÍ≥º ÏÉà Í≥†Í∞ù Î™®Îëê Ï≤òÎ¶¨)
    function editMemo(cell) {
        const row = cell.closest('tr');
        const customerId = row?.dataset?.customerId;
        
        // Ï†ÑÏ≤¥ Î©îÎ™® ÎÇ¥Ïö©ÏùÑ Í∞ÄÏ†∏Ïò§Í∏∞: data-memo ÏÜçÏÑ± Ïö∞ÏÑ†, ÏóÜÏúºÎ©¥ title, ÎßàÏßÄÎßâÏúºÎ°ú textContent
        let fullMemo = '';
        if (cell.getAttribute('data-memo')) {
            fullMemo = cell.getAttribute('data-memo');
        } else if (cell.getAttribute('title')) {
            fullMemo = cell.getAttribute('title');
        } else if (cell.dataset.memo) {
            fullMemo = cell.dataset.memo;
        } else {
            const currentMemo = cell.textContent.trim();
            fullMemo = (currentMemo === '-' || currentMemo === 'ÌÅ¥Î¶≠ÌïòÏó¨ Î©îÎ™® Ï∂îÍ∞Ä') ? '' : currentMemo;
        }
        
        console.log('editMemo Ìò∏Ï∂ú:', { customerId, fullMemo });
        
        if (customerId) {
            // Í∏∞Ï°¥ Í≥†Í∞ù: Í∏∞Ï°¥ Î™®Îã¨ ÏÇ¨Ïö©
            openCustomerMemoModal(customerId, fullMemo);
        } else {
            // ÏÉà Í≥†Í∞ù: ÏÉà Í≥†Í∞ùÏö© Î™®Îã¨ ÏÇ¨Ïö©
            editNewCustomerMemo(cell);
        }
    }

    // Í≥†Í∞ù Î©îÎ™® Î™®Îã¨ Í¥ÄÎ†® Ìï®ÏàòÎì§
    function openCustomerMemoModal(customerId, currentMemo) {
        console.log('openCustomerMemoModal Ìò∏Ï∂ú:', { customerId, currentMemo });
        currentEditingCustomerId = customerId;
        const modal = document.getElementById('customer-memo-modal');
        const textarea = document.getElementById('customer-memo-textarea');
        console.log('Î™®Îã¨ ÏöîÏÜåÎì§:', { modal: !!modal, textarea: !!textarea });
        if (modal && textarea) {
            textarea.value = currentMemo || '';
            modal.style.display = 'flex';
            modal.style.opacity = '1';
            modal.style.visibility = 'visible';
            console.log('Î™®Îã¨ ÌëúÏãúÎê®');
            setTimeout(() => textarea.focus(), 100);
        } else {
            console.error('Î™®Îã¨ ÎòêÎäî textarea ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏùå');
        }
    }

    function closeCustomerMemoModal() {
        const modal = document.getElementById('customer-memo-modal');
        if (modal) {
            modal.style.display = 'none';
            modal.style.opacity = '0';
            modal.style.visibility = 'hidden';
        }
        currentEditingCustomerId = null;
    }

    // Î©îÎ™® Î™®Îã¨ ÌÖåÏä§Ìä∏ Ìï®Ïàò
    function testMemoModal() {
        console.log('Î©îÎ™® Î™®Îã¨ ÌÖåÏä§Ìä∏ ÏãúÏûë');
        const modal = document.getElementById('customer-memo-modal');
        const textarea = document.getElementById('customer-memo-textarea');
        console.log('ÌÖåÏä§Ìä∏ - Î™®Îã¨ ÏöîÏÜåÎì§:', { modal: !!modal, textarea: !!textarea });
        if (modal) {
            modal.style.display = 'flex';
            modal.style.opacity = '1';
            modal.style.visibility = 'visible';
            console.log('ÌÖåÏä§Ìä∏ - Î™®Îã¨ ÌëúÏãúÎê®');
        }
    }
    
    // ÏÉà Í≥†Í∞ù Î©îÎ™® Ìé∏Ïßë
    function editNewCustomerMemo(cell) {
        const currentMemo = cell.dataset.memo || '';
        const modal = document.getElementById('customer-memo-modal');
        const textarea = document.getElementById('customer-memo-textarea');
        if (modal && textarea) {
            textarea.value = currentMemo;
            modal.style.display = 'flex';
            modal.style.opacity = '1';
            modal.style.visibility = 'visible';
            setTimeout(() => textarea.focus(), 100);
            
            // ÏûÑÏãúÎ°ú ÏÉà Í≥†Í∞ù ÏÖÄ Ï†ÄÏû•
            window.tempNewCustomerMemoCell = cell;
        }
    }


    async function saveCustomerMemo() {
        // ÏÉà Í≥†Í∞ù Î©îÎ™®Ïù∏ Í≤ΩÏö∞
        if (window.tempNewCustomerMemoCell) {
            const memo = document.getElementById('customer-memo-textarea').value.trim();
            window.tempNewCustomerMemoCell.dataset.memo = memo;
            window.tempNewCustomerMemoCell.setAttribute('data-memo', memo || '');
            window.tempNewCustomerMemoCell.textContent = memo ? 
                (memo.length > 30 ? memo.substring(0, 30) + '...' : memo) : 
                'ÌÅ¥Î¶≠ÌïòÏó¨ Î©îÎ™® Ï∂îÍ∞Ä';
            if (memo && memo.trim()) {
                window.tempNewCustomerMemoCell.setAttribute('title', memo);
            } else {
                window.tempNewCustomerMemoCell.removeAttribute('title');
            }
            window.tempNewCustomerMemoCell.style.color = memo ? '#4b5563' : '#9ca3af';
            window.tempNewCustomerMemoCell = null;
            closeCustomerMemoModal();
            return;
        }
        
        if (!currentEditingCustomerId) return;
        
        const memo = document.getElementById('customer-memo-textarea').value.trim();
        
        try {
            console.log('Î©îÎ™® Ï†ÄÏû• ÏãúÏûë:', { customerId: currentEditingCustomerId, memo });
            const response = await fetch(`/api/customers/${currentEditingCustomerId}/field`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ memo: memo })
            });

            const result = await response.json();
            console.log('Î©îÎ™® Ï†ÄÏû• ÏùëÎãµ:', result);
            if (result.success) {
                // Î©îÎ™® ÏÖÄÎßå Ï¶âÏãú ÏóÖÎç∞Ïù¥Ìä∏
                const customerRow = document.querySelector(`tr[data-customer-id="${currentEditingCustomerId}"]`);
                if (customerRow) {
                    const memoCell = customerRow.querySelector('.memo-cell');
                    if (memoCell) {
                        const memoDisplay = memo ? 
                            (memo.length > 10 ? memo.substring(0, 10) + '...' : memo) : 
                            'ÌÅ¥Î¶≠ÌïòÏó¨ Î©îÎ™® Ï∂îÍ∞Ä';
                        memoCell.textContent = memoDisplay;
                        memoCell.setAttribute('data-memo', memo || '');
                        if (memo && memo.trim()) {
                            memoCell.setAttribute('title', memo);
                        } else {
                            memoCell.removeAttribute('title');
                        }
                        memoCell.style.color = memo ? '#4b5563' : '#9ca3af';
                    }
                }
                
                // Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
                const customer = customers.find(c => c.id === currentEditingCustomerId);
                if (customer) {
                    customer.memo = memo;
                }
                
                console.log('Î©îÎ™®Í∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ÄÏû•Îê®');
                showAlert('Î©îÎ™®Í∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.', 'success');
                closeCustomerMemoModal();
            } else {
                console.error('Î©îÎ™® Ï†ÄÏû• Ïã§Ìå®:', result);
                showAlert(result.message || 'Î©îÎ™® Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
            }
        } catch (error) {
            console.error('Î©îÎ™® Ï†ÄÏû• Ïò§Î•ò:', error);
            showAlert('ÏÑúÎ≤Ñ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
        }
    }

    // Ï¢ãÏïÑÏöî ÌôïÏù∏ Ï≤òÎ¶¨ Ìï®ÏàòÎì§
    async function markResidenceLikesChecked(managementSiteId) {
        try {
            const response = await fetch('/api/employee/mark-likes-checked', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    management_site_id: managementSiteId,
                    type: 'residence'
                })
            });
            
            const result = await response.json();
            if (result.success) {
                console.log('Ï£ºÍ±∞ÏÇ¨Ïù¥Ìä∏ Ï¢ãÏïÑÏöî ÌôïÏù∏ Ï≤òÎ¶¨ ÏôÑÎ£å');
            }
        } catch (error) {
            console.error('Ï£ºÍ±∞ÏÇ¨Ïù¥Ìä∏ Ï¢ãÏïÑÏöî ÌôïÏù∏ Ï≤òÎ¶¨ Ïò§Î•ò:', error);
        }
    }

    async function markBusinessLikesChecked(managementSiteId) {
        try {
            const response = await fetch('/api/employee/mark-likes-checked', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    management_site_id: managementSiteId,
                    type: 'business'
                })
            });
            
            const result = await response.json();
            if (result.success) {
                console.log('ÏóÖÎ¨¥ÏÇ¨Ïù¥Ìä∏ Ï¢ãÏïÑÏöî ÌôïÏù∏ Ï≤òÎ¶¨ ÏôÑÎ£å');
            }
        } catch (error) {
            console.error('ÏóÖÎ¨¥ÏÇ¨Ïù¥Ìä∏ Ï¢ãÏïÑÏöî ÌôïÏù∏ Ï≤òÎ¶¨ Ïò§Î•ò:', error);
        }
    }

    // ÏïåÎ¶º ÌëúÏãú Ìï®Ïàò
    function showAlert(message, type = 'info') {
        // Í∏∞Ï°¥ ÏïåÎ¶ºÏù¥ ÏûàÏúºÎ©¥ Ï†úÍ±∞
        const existingAlert = document.querySelector('.alert-notification');
        if (existingAlert) {
            existingAlert.remove();
        }

        const alert = document.createElement('div');
        alert.className = `alert-notification alert-${type}`;
        alert.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 10000;
            max-width: 400px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateX(100%);
            transition: transform 0.3s ease;
        `;

        // ÌÉÄÏûÖÎ≥Ñ Î∞∞Í≤ΩÏÉâ ÏÑ§Ï†ï
        switch(type) {
            case 'success':
                alert.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                break;
            case 'error':
                alert.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
                break;
            case 'warning':
                alert.style.background = 'linear-gradient(135deg, #f59e0b, #d97706)';
                break;
            default:
                alert.style.background = 'linear-gradient(135deg, #6366f1, #5855eb)';
        }

        alert.textContent = message;
        document.body.appendChild(alert);

        // Ïï†ÎãàÎ©îÏù¥ÏÖòÏúºÎ°ú ÌëúÏãú
        setTimeout(() => {
            alert.style.transform = 'translateX(0)';
        }, 100);

        // 3Ï¥à ÌõÑ ÏûêÎèô Ï†úÍ±∞
        setTimeout(() => {
            alert.style.transform = 'translateX(100%)';
            setTimeout(() => {
                if (alert.parentNode) {
                    alert.remove();
                }
            }, 300);
        }, 3000);
        }
        
        // Î©îÏù¥ÌîåÍ¥ÄÎ¶¨ ÌÉ≠ Ï†ÑÌôò Ìï®Ïàò
        function switchMaeipleTab(tabName) {
            console.log('Î©îÏù¥ÌîåÍ¥ÄÎ¶¨ ÌÉ≠ Ï†ÑÌôò:', tabName);
            
            // Î™®Îì† ÌÉ≠ Î≤ÑÌäºÏóêÏÑú active ÌÅ¥ÎûòÏä§ Ï†úÍ±∞
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Î™®Îì† ÌÉ≠ ÏΩòÌÖêÏ∏† Ïà®Í∏∞Í∏∞
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
                content.style.display = 'none';
            });
            
            // ÏÑ†ÌÉùÎêú ÌÉ≠ Î≤ÑÌäº ÌôúÏÑ±Ìôî
            const selectedBtn = document.querySelector(`[data-tab="${tabName}"]`);
            if (selectedBtn) {
                selectedBtn.classList.add('active');
            }
            
            // ÏÑ†ÌÉùÎêú ÌÉ≠ ÏΩòÌÖêÏ∏† ÌëúÏãú
            let targetContent;
            if (tabName === 'list') {
                targetContent = document.getElementById('maeiple-tab-list');
                // ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠ ÏÑ†ÌÉùÏãú ÌåÄÏõê Î™©Î°ù Î°úÎìúÌïòÏó¨ ÏùºÍ¥Ñ Îã¥ÎãπÏûê Î≥ÄÍ≤Ω ÎìúÎ°≠Îã§Ïö¥ Ï±ÑÏõÄ
                loadTeamEmployeesForBulk();
            } else if (tabName === 'stats') {
                targetContent = document.getElementById('maeiple-tab-stats');
                // ÌåÄÏû•Î©îÏù¥ÌîåÍ¥ÄÎ¶¨ ÌÉ≠ ÏÑ†ÌÉùÏãú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                loadMaeipePropertiesTeamLeader();
            }
            
            if (targetContent) {
                targetContent.classList.add('active');
                targetContent.style.display = 'block';
            }
        }

        // Î©îÏù¥ÌîåÍ¥ÄÎ¶¨ ÏÑπÏÖò ÌôúÏÑ±ÌôîÏãú Í∏∞Î≥∏Ï†ÅÏúºÎ°ú ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠ ÌëúÏãú
        function activateMaeipeTab(e) {
            e.preventDefault();
            
            // Í∏∞Î≥∏ Ïª®ÌÖêÏ∏† Ïà®Í∏∞Í∏∞
            document.getElementById('default-content').style.display = 'none';
            
            // Î©îÏù¥ÌîåÍ¥ÄÎ¶¨ ÏÑπÏÖò ÌëúÏãú
            document.getElementById('maeiple-section').style.display = 'block';
            
            // ÏÇ¨Ïù¥ÎìúÎ∞î active ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            e.target.closest('.nav-item').classList.add('active');
            
            // Í∏∞Î≥∏Ï†ÅÏúºÎ°ú ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠ ÌôúÏÑ±Ìôî
            switchMaeipleTab('list');
            
            // ÏïÑÌååÌä∏Î™©Î°ù Îç∞Ïù¥ÌÑ∞ Î°úÎìú
            loadMaeipeProperties(1);
            
            const section = document.getElementById('maeiple-section');
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // Ï†ÑÏó≠ Î≥ÄÏàòÎì§
        let properties = [];
        let teamProperties = [];
        let currentMaeiplePage = 1;
        let currentTeamMaeiplePage = 1;
        let maeipleTotalPages = 0;
        let teamMaeipleTotalPages = 0;
        const maeipePerPage = 20;
        const teamMaeipePerPage = 20;
        let currentSortBy = 'room_number';
        let currentSortOrder = 'asc';
        let currentTeamSortBy = 'room_number';
        let currentTeamSortOrder = 'asc';
        
        // ÌïÑÌÑ∞ Î≥ÄÏàòÎì§
        let statusFilter = 'all';
        let occupiedFilter = 'all';
        let dealTypeFilterAdmin = 'all';
        let dealTypeFilterTeamLeader = 'all';
        let roomSearchFilterAdmin = '';
        let roomSearchFilterTeamLeader = '';
        let employeeSearchFilterAdmin = '';
        let employeeSearchFilterTeamLeader = '';
        let teamFilterAdmin = 'all';
        let teamFilterTeamLeader = 'all';
        
        // Îß§Î¨º Î™©Î°ù Ï°∞Ìöå (ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠Ïö©) - ÌåÄÏû•ÏùÄ Í¥ÄÎ¶¨ÏûêÏôÄ ÎèôÏùºÌïú API ÏÇ¨Ïö©
        async function loadMaeipeProperties(page = 1) {
            console.log('üè† loadMaeipeProperties() ÏãúÏûë - ÌåÄÏû•Ïö© ÏïÑÌååÌä∏ Î™©Î°ù Î°úÎìú');
            try {
                currentMaeiplePage = page;
                // Í¥ÄÎ¶¨ÏûêÏôÄ ÎèôÏùºÌïú API ÏÇ¨Ïö© - ÌåÄÏû•ÎèÑ Ï†ÑÏ≤¥ Îß§Î¨º Ï°∞Ìöå Í∞ÄÎä•
                const url = `/api/maeiple?sort_by=${currentSortBy}&sort_order=${currentSortOrder}&page=${page}&per_page=${maeipePerPage}`;
                console.log('üì° API Ìò∏Ï∂ú URL:', url);
                
                const response = await fetch(url);
                console.log('üì• API ÏùëÎãµ ÏÉÅÌÉú:', response.status, response.statusText);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('üìã API ÏùëÎãµ Îç∞Ïù¥ÌÑ∞:', data);
                
                if (data.success) {
                    properties = data.properties;
                    maeipleTotalPages = data.total_pages || 0;
                    console.log(`‚úÖ ÌåÄÏû•Ïö© Î©îÏù¥ÌîåÍ¥ÄÎ¶¨ Îß§Î¨º Î°úÎìú ÏôÑÎ£å: ${properties.length}Í∞ú (ÌéòÏù¥ÏßÄ ${page}/${maeipleTotalPages})`);
                    
                    // ÌïÑÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
                    updateAdminFilters();
                    
                    // Îß§Î¨º Î™©Î°ù Î†åÎçîÎßÅ
                    renderMaeipeProperties();
                    
                    // ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò Î†åÎçîÎßÅ
                    renderMaeipePagination();
                    
                    console.log('üéØ ÏïÑÌååÌä∏ Î™©Î°ù Î†åÎçîÎßÅ ÏôÑÎ£å');
                } else {
                    console.error('‚ùå API ÏùëÎãµ Ïã§Ìå®:', data);
                    showMaeipeError('Îß§Î¨º Î™©Î°ùÏùÑ Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
                }
            } catch (error) {
                console.error('‚ùå loadMaeipeProperties Ïò§Î•ò:', error);
                showMaeipeError('Îß§Î¨º Î™©Î°ùÏùÑ Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
            }
        }

        // ÌåÄÏû• Í∞úÏù∏ Îß§Î¨º Î°úÎìú (Í∞úÏù∏Îß§Î¨ºÍ¥ÄÎ¶¨ ÌÉ≠Ïö©)
        async function loadMaeipePropertiesTeamLeader(page = 1) {
            try {
                currentTeamMaeiplePage = page;
                const currentEmployeeName = '{{ employee_name }}';
                console.log('üîÑ ÌåÄÏû• Í∞úÏù∏ Îß§Î¨º Î°úÎìú ÏãúÏûë:', currentEmployeeName);
                
                // ÌåÄÏû• Í∞úÏù∏ Îß§Î¨ºÎßå Ï°∞Ìöå - employee_name ÌïÑÌÑ∞ Ï∂îÍ∞Ä
                const url = `/api/maeiple?sort_by=${currentTeamSortBy}&sort_order=${currentTeamSortOrder}&page=${page}&per_page=${teamMaeipePerPage}&employee_name=${encodeURIComponent(currentEmployeeName)}`;
                const response = await fetch(url);
                const data = await response.json();
                
                console.log('üì• ÌåÄÏû• Í∞úÏù∏ Îß§Î¨º API ÏùëÎãµ:', data);
                
                if (data.success) {
                    // ÌåÄÏû• Í∞úÏù∏ Îß§Î¨ºÎ°ú ÌïÑÌÑ∞ÎßÅ (ÏÑúÎ≤ÑÏóêÏÑú ÌïÑÌÑ∞ÎßÅÎêòÏßÄ ÏïäÏùÄ Í≤ΩÏö∞ ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ÏóêÏÑú Ï∂îÍ∞Ä ÌïÑÌÑ∞ÎßÅ)
                    const personalProperties = data.properties.filter(p => p.employee_name === currentEmployeeName);
                    
                    teamProperties = personalProperties;
                    teamMaeipleTotalPages = data.total_pages || 0;
                    console.log(`‚úÖ ÌåÄÏû• Í∞úÏù∏ Îß§Î¨º Î°úÎìú ÏôÑÎ£å: ${teamProperties.length}Í∞ú (ÌéòÏù¥ÏßÄ ${page}/${teamMaeipleTotalPages})`);
                    updateTeamLeaderFilters();
                    renderTeamMaeipeProperties();
                    renderTeamMaeipePagination();
                } else {
                    showTeamMaeipeError('Í∞úÏù∏ Îß§Î¨º Î™©Î°ùÏùÑ Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
                }
            } catch (error) {
                console.error('‚ùå ÌåÄÏû• Í∞úÏù∏ Îß§Î¨º Î°úÎìú Ïò§Î•ò:', error);
                showTeamMaeipeError('Í∞úÏù∏ Îß§Î¨º Î™©Î°ùÏùÑ Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
            }
        }
        
        // ÏÉà Îß§Î¨º Ï∂îÍ∞Ä Ìï®Ïàò (ÌåÄÏû•Ïö©)
        function addNewPropertyRow() {
            console.log('ÌåÄÏû• ÏÉà Îß§Î¨º Ìñâ Ï∂îÍ∞Ä ÏãúÏûë...');
            
            const tbody = document.querySelector('#maeiple-table-content table tbody');
            if (!tbody) {
                console.error('Îß§Î¨º ÌÖåÏù¥Î∏î tbodyÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                alert('ÌÖåÏù¥Î∏îÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§. Î©îÏù¥ÌîåÍ¥ÄÎ¶¨ ÏÑπÏÖòÏù¥ Ï†úÎåÄÎ°ú Î°úÎìúÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.');
                return;
            }
            
            // Ïò§Îäò ÎÇ†Ïßú Íµ¨ÌïòÍ∏∞ (ÌïúÍµ≠ÏãúÍ∞Ñ Í∏∞Ï§Ä)
            const now = new Date();
            now.setHours(now.getHours() + 9);
            const today = now.toISOString().slice(0, 10);
            
            const currentTeam = '{{ employee_team }}';
            const currentEmployee = '{{ employee_name }}';
            
            const newRow = document.createElement('tr');
            newRow.className = 'new-property-row';
            newRow.innerHTML = `
                <td style="text-align: center;">
                    <input type="checkbox" class="property-checkbox" style="width: 16px; height: 16px;" title="Îß§Î¨º ÏÑ†ÌÉù">
                </td>
                <td class="editable-cell" data-field="check_date" data-type="date" onclick="editAdminPropertyCell(this)">${today}</td>
                <td class="editable-cell" data-field="building_number" data-type="number" onclick="editAdminPropertyCell(this)" style="color: #64748b;">Îèô Î≤àÌò∏ (ÏÑ†ÌÉù)</td>
                <td class="editable-cell" data-field="room_number" data-type="number" onclick="editAdminPropertyCell(this)" style="color: #64748b;">Ìò∏Ïàò (ÏÑ†ÌÉù)</td>
                <td class="editable-cell" data-field="status" data-type="select" onclick="editAdminPropertyCell(this)">
                    <span class="badge" style="background: #e0f2fe; color: #0369a1; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">Í±∞ÎûòÍ∞ÄÎä•</span>
                </td>
                <td class="editable-cell" data-field="jeonse_price" data-type="number" onclick="editAdminPropertyCell(this)" style="color: #64748b;">Ï†ÑÏÑ∏Í∞Ä ÏûÖÎ†•</td>
                <td class="editable-cell" data-field="monthly_deposit" data-type="number" onclick="editAdminPropertyCell(this)" style="color: #64748b;">ÏõîÏÑ∏Î≥¥Ï¶ùÍ∏à ÏûÖÎ†•</td>
                <td class="editable-cell" data-field="monthly_rent" data-type="number" onclick="editAdminPropertyCell(this)" style="color: #64748b;">ÏõîÏÑ∏ ÏûÖÎ†•</td>
                <td class="editable-cell" data-field="sale_price" data-type="number" onclick="editAdminPropertyCell(this)" style="color: #64748b;">Îß§Îß§Í∞Ä ÏûÖÎ†•</td>
                <td class="editable-cell" data-field="is_occupied" data-type="select" onclick="editAdminPropertyCell(this)">
                    <span class="badge" style="background: #fecaca; color: #dc2626; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">X</span>
                </td>
                <td class="editable-cell" data-field="phone" data-type="text" onclick="editAdminPropertyCell(this)" style="color: #64748b;">Ïó∞ÎùΩÏ≤ò ÏûÖÎ†•</td>
                <td class="memo-cell" onclick="openNewPropertyMemoModal(this)" style="color: #64748b; cursor: pointer;">Î©îÎ™® ÏûÖÎ†•</td>
                <td>
                    <span style="color: #4f46e5; font-weight: 500;">${currentEmployee}</span>
                </td>
                <td>
                    <span class="status-badge" style="background: ${getTeamBadgeColor(currentTeam)}; color: ${getTeamTextColor(currentTeam)};">
                        ${currentTeam}
                    </span>
                </td>
                <td>
                    <div style="cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; gap: 2px;" onclick="openLikesModal('new', 'likes', 0, this)" data-count="0">
                        <span style="color: #9ca3af; font-size: 14px;">‚ù§Ô∏è 0</span>
                    </div>
                </td>
                <td>
                    <div style="cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; gap: 2px;" onclick="openLikesModal('new', 'dislikes', 0, this)" data-count="0">
                        <span style="color: #9ca3af; font-size: 14px;">üëé 0</span>
                    </div>
                </td>
            `;
            
            tbody.insertBefore(newRow, tbody.firstChild);
            console.log('ÏÉà Îß§Î¨º ÌñâÏù¥ Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§.');
            alert('ÏÉà Îß§Î¨º ÌñâÏù¥ Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§. ÏÖÄÏùÑ Ìé∏ÏßëÌïòÎ©¥ ÏûêÎèôÏúºÎ°ú Ï†ÄÏû•Îê©ÎãàÎã§.');
        }
        
        // ÌïÑÌÑ∞ Ìï®ÏàòÎì§
        function filterByRoomAdmin(value) {
            roomSearchFilterAdmin = value;
            renderMaeipeProperties();
        }
        
        function filterByRoomTeamLeader(value) {
            roomSearchFilterTeamLeader = value;
            renderTeamMaeipeProperties();
        }
        
        function setDealTypeFilterAdmin(type, btn) {
            dealTypeFilterAdmin = type;
            document.querySelectorAll('#deal-type-filter-group-admin .filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderMaeipeProperties();
        }
        
        function setDealTypeFilterTeamLeader(type, btn) {
            dealTypeFilterTeamLeader = type;
            document.querySelectorAll('#deal-type-filter-group-team-leader .filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderTeamMaeipeProperties();
        }
        
        function setStatusFilter(status, btn) {
            statusFilter = status;
            document.querySelectorAll('#status-filter-group .filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderMaeipeProperties();
        }
        
        function setStatusFilterTeamLeader(status, btn) {
            statusFilter = status;
            document.querySelectorAll('#status-filter-group-team-leader .filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderTeamMaeipeProperties();
        }
        
        function setOccupiedFilter(occupied, btn) {
            occupiedFilter = occupied;
            document.querySelectorAll('#occupied-filter-group .filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderMaeipeProperties();
        }
        
        function setOccupiedFilterTeamLeader(occupied, btn) {
            occupiedFilter = occupied;
            document.querySelectorAll('#occupied-filter-group-team-leader .filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderTeamMaeipeProperties();
        }
        
        function filterByEmployeeAdmin(value) {
            employeeSearchFilterAdmin = value;
            renderMaeipeProperties();
        }
        
        function filterByEmployeeTeamLeader(value) {
            employeeSearchFilterTeamLeader = value;
            renderTeamMaeipeProperties();
        }
        
        function setTeamFilterAdmin(team, btn) {
            const currentTeam = '{{ employee_team }}';
            // ÌåÄÏû•: ÏûêÏã†Ïùò ÌåÄ ÎòêÎäî Ï†ÑÏ≤¥Îßå ÌóàÏö©
            if (team !== 'all' && team !== currentTeam) {
                alert('ÏûêÏã†Ïùò ÌåÄÎßå ÌïÑÌÑ∞ÎßÅÌï† Ïàò ÏûàÏäµÎãàÎã§.');
                return;
            }
            teamFilterAdmin = team;
            document.querySelectorAll('#team-filter-group-admin .filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderMaeipeProperties();
        }
        
        function setTeamFilterTeamLeader(team, btn) {
            teamFilterTeamLeader = team;
            document.querySelectorAll('#team-filter-group-team-leader .filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderTeamMaeipeProperties();
        }
        
        // Îß§Î¨º Î™©Î°ù Î†åÎçîÎßÅ (Í¥ÄÎ¶¨Ïûê Ìå®ÎÑêÏóêÏÑú Ïù¥Ïãù)
        function renderMaeipeProperties() {
            const tableContent = document.getElementById('maeiple-table-content');
            
            // ÌïÑÌÑ∞ Ï†ÅÏö©
            let list = Array.isArray(properties) ? properties.slice() : [];
            // ÌåÄÏû•: ÏûêÏã†Ïùò ÌåÄ Ïô∏ Îß§Î¨ºÏùÄ Ïà®ÍπÄ
            const currentTeam = '{{ employee_team }}';
            list = list.filter(p => (p.employee_team || '') === currentTeam);
            
            // ÌòÑÌô© ÌïÑÌÑ∞
            if (statusFilter !== 'all') {
                list = list.filter(p => (p.status || '') === statusFilter);
            }
            
            // Ïã§Í±∞Ï£º ÌïÑÌÑ∞
            if (occupiedFilter !== 'all') {
                const want = occupiedFilter === 'O';
                list = list.filter(p => !!p.is_occupied === want);
            }
            
            // Í±∞ÎûòÏú†Ìòï ÌïÑÌÑ∞ (Í¥ÄÎ¶¨ÏûêÏö©)
            if (dealTypeFilterAdmin !== 'all') {
                list = list.filter(p => {
                    if (dealTypeFilterAdmin === 'Ï†ÑÏÑ∏') {
                        const jeonsePrice = parseInt(String(p.jeonse_price || '0').replace(/[^\d]/g, '')) || 0;
                        return jeonsePrice > 0;
                    } else if (dealTypeFilterAdmin === 'ÏõîÏÑ∏') {
                        const monthlyRent = parseInt(String(p.monthly_rent || '0').replace(/[^\d]/g, '')) || 0;
                        return monthlyRent > 0;
                    } else if (dealTypeFilterAdmin === 'Îß§Îß§') {
                        const salePrice = parseInt(String(p.sale_price || '0').replace(/[^\d]/g, '')) || 0;
                        return salePrice > 0;
                    }
                    return true;
                });
            }
            
            // Ìò∏Ïàò Í≤ÄÏÉâ ÌïÑÌÑ∞ (Í¥ÄÎ¶¨ÏûêÏö©)
            if (roomSearchFilterAdmin.trim()) {
                const searchTerm = roomSearchFilterAdmin.trim().toLowerCase();
                list = list.filter(p => {
                    const roomNumber = String(p.room_number || '').toLowerCase();
                    return roomNumber.includes(searchTerm);
                });
            }
            
            // Îã¥ÎãπÏûê Í≤ÄÏÉâ ÌïÑÌÑ∞ (Í¥ÄÎ¶¨ÏûêÏö©)
            if (employeeSearchFilterAdmin.trim()) {
                const searchTerm = employeeSearchFilterAdmin.trim().toLowerCase();
                list = list.filter(p => {
                    const employeeName = String(p.employee_name || '').toLowerCase();
                    return employeeName.includes(searchTerm);
                });
            }
            
            // ÌåÄ ÌïÑÌÑ∞ (Í¥ÄÎ¶¨ÏûêÏö©) - ÌåÄÏû•ÏùÄ ÏûêÏã†Ïùò ÌåÄÎßå Î≥¥ÎèÑÎ°ù ÏàòÏ†ï
            if (teamFilterAdmin !== 'all') {
                list = list.filter(p => (p.employee_team || '') === teamFilterAdmin);
            }
            
            if (list.length === 0) {
                tableContent.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #64748b;">
                        <div style="font-size: 48px; margin-bottom: 16px; opacity: 0.5;">üè¢</div>
                        <p>Ï°∞Í±¥Ïóê ÎßûÎäî Îß§Î¨ºÏù¥ ÏóÜÏäµÎãàÎã§.</p>
                        <p>ÌïÑÌÑ∞Î•º Î≥ÄÍ≤ΩÌïòÍ±∞ÎÇò ÏÉà Îß§Î¨ºÏùÑ Ï∂îÍ∞ÄÌï¥Î≥¥ÏÑ∏Ïöî.</p>
                    </div>
                `;
                return;
            }
            
            let tableHTML = `
                <table class="employees-table">
                    <thead>
                        <tr>
                            <th style="width: 50px;">
                                <input type="checkbox" id="select-all-properties" onchange="toggleSelectAll(this)" 
                                       style="width: 16px; height: 16px; cursor: pointer;">
                            </th>
                            <th>
                                <div style="display: flex; align-items: center; gap: 4px; cursor: pointer; user-select: none;" onclick="toggleSort('check_date')">
                                    ÌôïÏù∏ÎÇ†Ïßú
                                    <span style="font-size: 12px; color: #9ca3af;">${currentSortBy === 'check_date' ? (currentSortOrder === 'desc' ? '‚ñº' : '‚ñ≤') : '‚ÜïÔ∏è'}</span>
                                </div>
                            </th>
                            <th>Îèô</th>
                            <th>Ìò∏Ïàò</th>
                            <th>ÌòÑÌô©</th>
                            <th>Ï†ÑÏÑ∏ (ÎßåÏõê)</th>
                            <th>ÏõîÏÑ∏Î≥¥Ï¶ùÍ∏à (ÎßåÏõê)</th>
                            <th>ÏõîÏÑ∏ (ÎßåÏõê)</th>
                            <th>Îß§Îß§ (ÎßåÏõê)</th>
                            <th>Ïã§Í±∞Ï£º Ïó¨Î∂Ä</th>
                            <th>Ï†ÑÌôîÎ≤àÌò∏</th>
                            <th>ÌäπÏù¥ÏÇ¨Ìï≠</th>
                            <th>Îã¥ÎãπÏûê</th>
                            <th>ÌåÄ</th>
                            <th>Ï¢ãÏïÑÏöî</th>
                            <th>Ïã´Ïñ¥Ïöî</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            list.forEach(property => {
                tableHTML += `
                    <tr data-property-id="${property.id}">
                        <td style="text-align: center;">
                            <input type="checkbox" class="property-checkbox" value="${property.id}" 
                                   onchange="updateSelectionCount()" style="width: 16px; height: 16px; cursor: pointer;">
                        </td>
                        <td style="cursor: pointer;" onclick="editAdminDate(${property.id}, '${property.check_date || ''}', this)">${property.check_date || '-'}</td>
                        <td style="cursor: pointer;" onclick="editAdminNumber(${property.id}, 'building_number', '${property.building_number || ''}', this)">${property.building_number || '-'}</td>
                        <td style="cursor: pointer;" onclick="editAdminNumber(${property.id}, 'room_number', '${property.room_number || ''}', this)">${property.room_number || '-'}</td>
                        <td>
                            <button style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; ${property.status === 'Í≥ÑÏïΩÏôÑÎ£å' ? 'background: #d1fae5; color: #065f46;' : property.status === 'Î≥¥Î•ò' ? 'background: #fef3c7; color: #92400e;' : property.status === 'Î∂ÄÏû¨' ? 'background: #ede9fe; color: #5b21b6;' : 'background: #e0f2fe; color: #0369a1;'}" 
                                    onclick="showAdminStatusOptions(${property.id}, '${property.status || 'Í±∞ÎûòÍ∞ÄÎä•'}', this)">
                                ${property.status || 'Í±∞ÎûòÍ∞ÄÎä•'}
                            </button>
                        </td>
                        <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editAdminPrice(${property.id}, 'jeonse_price', '${property.jeonse_price || ''}', this)">
                            ${property.jeonse_price ? formatNumber(property.jeonse_price) + ' ÎßåÏõê' : '-'}
                        </td>
                        <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editAdminPrice(${property.id}, 'monthly_deposit', '${property.monthly_deposit || property.deposit || ''}', this)">
                            ${property.monthly_deposit || property.deposit ? formatNumber(property.monthly_deposit || property.deposit) + ' ÎßåÏõê' : '-'}
                        </td>
                        <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editAdminPrice(${property.id}, 'monthly_rent', '${property.monthly_rent || ''}', this)">
                            ${property.monthly_rent ? formatNumber(property.monthly_rent) + ' ÎßåÏõê' : '-'}
                        </td>
                        <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editAdminPrice(${property.id}, 'sale_price', '${property.sale_price || ''}', this)">
                            ${property.sale_price ? formatNumber(property.sale_price) + ' ÎßåÏõê' : '-'}
                        </td>
                        <td>
                            <button style="background: none; border: none; cursor: pointer; font-size: 18px; padding: 4px; border-radius: 4px; color: ${property.is_occupied ? '#059669' : '#dc2626'};" 
                                    onclick="toggleAdminOccupied(${property.id}, ${property.is_occupied})">
                                ${property.is_occupied ? 'O' : 'X'}
                            </button>
                        </td>
                        <td style="cursor: pointer; font-family: monospace; letter-spacing: 0.5px; max-width: 120px; overflow: hidden; text-overflow: ellipsis;" onclick="editAdminPhone(${property.id}, '${property.phone || ''}', this)">
                            ${property.phone ? formatPhoneNumber(property.phone) : '-'}
                        </td>
                        <td class="memo-cell" onclick="editAdminMemo(${property.id}, '${(property.memo || '').replace(/'/g, "\\'")}', this)" style="color: #64748b; font-style: italic; max-width: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; cursor: pointer;">
                            ${property.memo ? (property.memo.length > 20 ? property.memo.substring(0, 20) + '...' : property.memo) : 'ÌÅ¥Î¶≠ÌïòÏó¨ Î©îÎ™® Ï∂îÍ∞Ä'}
                        </td>
                        <td class="editable-cell" data-field="employee_id" data-type="select" onclick="editPropertyCell(this)" style="cursor: pointer;">
                            <span style="color: #4f46e5; font-weight: 500;">
                                ${property.employee_name || 'ÎØ∏ÏßÄÏ†ï'}
                            </span>
                        </td>
                        <td>
                            <span class="status-badge" style="background: ${getTeamBadgeColor(property.employee_team)}; color: ${getTeamTextColor(property.employee_team)};">
                                ${property.employee_team || 'ÎØ∏ÏßÄÏ†ï'}
                            </span>
                        </td>
                        <td>
                            <div style="cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; gap: 2px;" onclick="openLikesModal(${property.id}, 'likes', ${property.likes || 0}, this)" data-count="${property.likes || 0}">
                                <span style="color: ${(property.likes || 0) > 0 ? '#ef4444' : '#9ca3af'}; font-size: 14px;">‚ù§Ô∏è ${property.likes || 0}</span>
                            </div>
                        </td>
                        <td>
                            <div style="cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; gap: 2px;" onclick="openLikesModal(${property.id}, 'dislikes', ${property.dislikes || 0}, this)" data-count="${property.dislikes || 0}">
                                <span style="color: ${(property.dislikes || 0) > 0 ? '#ef4444' : '#9ca3af'}; font-size: 14px;">üëé ${property.dislikes || 0}</span>
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            tableHTML += `
                    </tbody>
                </table>
            `;
            
            tableContent.innerHTML = tableHTML;
        }

        // ÌåÄÏû• ÌåÄÏõê Î™©Î°ù Î°úÎìúÌïòÏó¨ Îã¥ÎãπÏûê Î≥ÄÍ≤Ω ÎìúÎ°≠Îã§Ïö¥ Ï±ÑÏõÄ
        async function loadTeamEmployeesForBulk() {
            try {
                console.log('üîÑ ÌåÄÏõê Î™©Î°ù Î°úÎìú ÏãúÏûë...');
                const resp = await fetch('/api/employees?per_page=200&page=1');
                const data = await resp.json();
                
                console.log('üì• API ÏùëÎãµ Îç∞Ïù¥ÌÑ∞:', data);
                
                const currentTeam = '{{ employee_team }}';
                console.log('üë• ÌòÑÏû¨ ÌåÄÏû•Ïùò ÌåÄ:', currentTeam);
                
                const select = document.getElementById('bulk-employee-select');
                if (!select) {
                    console.error('‚ùå bulk-employee-select ÏóòÎ¶¨Î®ºÌä∏Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                    return;
                }
                
                if (!data.employees) {
                    console.error('‚ùå employees Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.');
                    alert('ÏßÅÏõê Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.');
                    return;
                }
                
                // ÏûêÏã†Ïùò ÌåÄ Î©§Î≤Ñ (ÌåÄÏû• Ìè¨Ìï®) - Supabase ÌïÑÎìúÎ™Ö ÏÇ¨Ïö©
                const teamMembers = data.employees.filter(e => {
                    const isCorrectTeam = e.team === currentTeam;
                    const isTeamLeaderOrEmployee = e.role && (e.role === 'ÌåÄÏû•' || e.role === 'ÏßÅÏõê');
                    console.log(`üë§ ÏßÅÏõê: ${e.name}, ÌåÄ: ${e.team}, Ïó≠Ìï†: ${e.role}, ÌïÑÌÑ∞ Í≤∞Í≥º: ${isCorrectTeam && isTeamLeaderOrEmployee}`);
                    return isCorrectTeam && isTeamLeaderOrEmployee;
                });
                
                console.log('‚úÖ ÌïÑÌÑ∞ÎßÅÎêú ÌåÄÏõê Î™©Î°ù:', teamMembers);
                
                select.innerHTML = '<option value="">Îã¥ÎãπÏûê ÏÑ†ÌÉù</option>';
                
                if (teamMembers.length === 0) {
                    const noMembersOption = document.createElement('option');
                    noMembersOption.value = '';
                    noMembersOption.textContent = 'Ìï¥Îãπ ÌåÄÏóê ÌåÄÏõêÏù¥ ÏóÜÏäµÎãàÎã§';
                    noMembersOption.disabled = true;
                    select.appendChild(noMembersOption);
                    console.warn('‚ö†Ô∏è Ìï¥Îãπ ÌåÄÏóê ÌåÄÏõêÏù¥ ÏóÜÏäµÎãàÎã§.');
                    return;
                }
                
                teamMembers.forEach(m => {
                    const opt = document.createElement('option');
                    opt.value = m.id || m.employee_id || m.name;
                    opt.dataset.employeeName = m.name;
                    opt.dataset.employeeTeam = m.team || currentTeam;
                    opt.textContent = `${m.name}${m.role ? ` (${m.role})` : ''}`;
                    select.appendChild(opt);
                    console.log(`‚ûï ÏòµÏÖò Ï∂îÍ∞Ä: ${opt.textContent}`);
                });
                
                console.log('‚úÖ Îã¥ÎãπÏûê ÎìúÎ°≠Îã§Ïö¥ ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å');
                
            } catch (e) {
                console.error('‚ùå ÌåÄÏõê Î™©Î°ù Î°úÎìú Ïã§Ìå®:', e);
                alert('ÌåÄÏõê Î™©Î°ùÏùÑ Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§. Í¥ÄÎ¶¨ÏûêÏóêÍ≤å Î¨∏ÏùòÌïòÏÑ∏Ïöî.');
            }
        }

        // Ï†ÑÏ≤¥ ÏÑ†ÌÉù/Ìï¥Ï†ú
        function toggleSelectAll(master) {
            const boxes = document.querySelectorAll('.property-checkbox');
            boxes.forEach(b => b.checked = master.checked);
            updateSelectionCount();
        }

        // ÏÑ†ÌÉù Í∞úÏàò ÏóÖÎç∞Ïù¥Ìä∏ Î∞è Ìå®ÎÑê ÌëúÏãú
        function updateSelectionCount() {
            const selected = document.querySelectorAll('.property-checkbox:checked');
            const countEl = document.getElementById('selected-count');
            const panel = document.getElementById('bulk-actions-panel');
            if (countEl) countEl.textContent = `${selected.length}Í∞ú`;
            if (panel) panel.style.display = selected.length > 0 ? 'block' : 'none';
            const all = document.querySelectorAll('.property-checkbox');
            const master = document.getElementById('select-all-properties');
            if (master) {
                master.indeterminate = selected.length > 0 && selected.length < all.length;
                master.checked = selected.length > 0 && selected.length === all.length;
            }
        }

        function clearSelection() {
            const boxes = document.querySelectorAll('.property-checkbox, #select-all-properties');
            boxes.forEach(b => b.checked = false);
            updateSelectionCount();
        }

        // ÌåÄÏû•: ÏùºÍ¥Ñ Îã¥ÎãπÏûê Î≥ÄÍ≤Ω (ÏûêÏã†Ïùò ÌåÄ Îß§Î¨ºÎßå Ï†ÅÏö©)
        async function bulkAssignEmployeeTeamLeader() {
            const selected = Array.from(document.querySelectorAll('.property-checkbox:checked')).map(cb => cb.value);
            if (selected.length === 0) { 
                alert('ÏÑ†ÌÉùÎêú Îß§Î¨ºÏù¥ ÏóÜÏäµÎãàÎã§.'); 
                return; 
            }
            
            const employeeSelect = document.getElementById('bulk-employee-select');
            if (!employeeSelect || !employeeSelect.value) { 
                alert('Îã¥ÎãπÏûêÎ•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.'); 
                return; 
            }
            
            const employeeId = employeeSelect.value;
            const selectedOption = employeeSelect.options[employeeSelect.selectedIndex];
            const employeeName = selectedOption.dataset.employeeName || selectedOption.text.split(' (')[0];
            const employeeTeam = selectedOption.dataset.employeeTeam || '{{ employee_team }}';
            
            console.log('üîÑ ÏùºÍ¥Ñ Îã¥ÎãπÏûê Î≥ÄÍ≤Ω ÏãúÏûë:', { 
                selected, 
                employeeId,
                employeeName,
                employeeTeam,
                selectedCount: selected.length 
            });
            
            if (!confirm(`ÏÑ†ÌÉùÎêú ${selected.length}Í∞ú Îß§Î¨ºÏùò Îã¥ÎãπÏûêÎ•º "${employeeName}"ÏúºÎ°ú Î≥ÄÍ≤ΩÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) return;
            
            try {
                // ÏÑúÎ≤ÑÏùò Í≥µÏö© ÏùºÍ¥Ñ Î≥ÄÍ≤Ω API ÏÇ¨Ïö© (Í¥ÄÎ¶¨ÏûêÏôÄ ÎèôÏùº) - ÏÑúÎ≤ÑÏóêÏÑú Í∂åÌïú Í≤ÄÏ¶ù ÌïÑÏöî
                const resp = await fetch('/api/maeiple/bulk-assign', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        property_ids: selected, 
                        employee_id: employeeId,
                        employee_name: employeeName
                    })
                });
                
                const result = await resp.json();
                console.log('üì• ÏùºÍ¥Ñ Î≥ÄÍ≤Ω API ÏùëÎãµ:', result);
                
                if (result.success) {
                    // UI Ï¶âÏãú ÏóÖÎç∞Ïù¥Ìä∏ - ÏÑ†ÌÉùÎêú Îß§Î¨ºÎì§Ïùò Îã¥ÎãπÏûê ÏÖÄ ÏóÖÎç∞Ïù¥Ìä∏
                    selected.forEach(propertyId => {
                        const row = document.querySelector(`tr[data-property-id="${propertyId}"]`);
                        if (row) {
                            const employeeCell = row.querySelector('td:nth-child(13)'); // Îã¥ÎãπÏûê ÏÖÄ
                            const teamCell = row.querySelector('td:nth-child(14)'); // ÌåÄ ÏÖÄ
                            
                            if (employeeCell) {
                                employeeCell.innerHTML = `<span style="color: #4f46e5; font-weight: 500;">${employeeName}</span>`;
                            }
                            
                            if (teamCell) {
                                teamCell.innerHTML = `<span class="status-badge" style="background: ${getTeamBadgeColor(employeeTeam)}; color: ${getTeamTextColor(employeeTeam)};">${employeeTeam}</span>`;
                            }
                            
                            // Î≥ÄÍ≤ΩÎêú ÌñâÏóê ÌïòÏù¥ÎùºÏù¥Ìä∏ Ìö®Í≥º
                            row.style.backgroundColor = '#f0f9ff';
                            row.style.transition = 'background-color 0.5s ease';
                            setTimeout(() => {
                                row.style.backgroundColor = '';
                            }, 2000);
                        }
                    });
                    
                    alert(`${selected.length}Í∞ú Îß§Î¨ºÏùò Îã¥ÎãπÏûêÍ∞Ä "${employeeName}"ÏúºÎ°ú Î≥ÄÍ≤ΩÎêòÏóàÏäµÎãàÎã§.`);
                    clearSelection();
                    console.log('‚úÖ ÏùºÍ¥Ñ Îã¥ÎãπÏûê Î≥ÄÍ≤Ω ÏôÑÎ£å');
                } else {
                    console.error('‚ùå ÏùºÍ¥Ñ Î≥ÄÍ≤Ω Ïã§Ìå®:', result);
                    alert('Îã¥ÎãπÏûê Î≥ÄÍ≤ΩÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§: ' + (result.message || result.error));
                }
            } catch (e) {
                console.error('‚ùå ÏùºÍ¥Ñ Îã¥ÎãπÏûê Î≥ÄÍ≤Ω Ï§ë Ïò§Î•ò:', e);
                alert('Îã¥ÎãπÏûê Î≥ÄÍ≤Ω Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
            }
        }

        // ÏÖÄ Ìé∏Ïßë Í∏∞Îä• (ÌåÄÏû•: Îã¥ÎãπÏûê Î≥ÄÍ≤ΩÎßå Í∞ÄÎä•)
        async function editPropertyCell(cell) {
            const field = cell.dataset.field;
            const type = cell.dataset.type;
            
            // ÌåÄÏû•ÏùÄ Îã¥ÎãπÏûê(employee_id) ÌïÑÎìúÎßå Ìé∏Ïßë Í∞ÄÎä•
            if (field !== 'employee_id') {
                alert('ÌåÄÏû•ÏùÄ Îã¥ÎãπÏûêÎßå Î≥ÄÍ≤ΩÌï† Ïàò ÏûàÏäµÎãàÎã§.');
                return;
            }
            
            // Ïù¥ÎØ∏ Ìé∏Ïßë Ï§ëÏù¥Î©¥ Ìé∏Ïßë Î™®Îìú Ï¢ÖÎ£å
            if (cell.classList.contains('editing-cell')) {
                const existingSelector = cell.querySelector('.employee-selector');
                if (existingSelector) {
                    existingSelector.remove();
                }
                cell.classList.remove('editing-cell');
                return;
            }
            
            let currentValue = cell.textContent.trim();
            
            // Îã¥ÎãπÏûê ÏÑ†ÌÉù ÎìúÎ°≠Îã§Ïö¥ ÏÉùÏÑ±
            const selector = document.createElement('select');
            selector.className = 'employee-selector';
            selector.style.cssText = 'width: 100%; padding: 4px; border: 1px solid #3b82f6; border-radius: 4px; font-size: 12px; background: white;';
            
            // ÌåÄÏû•Ïùò ÌåÄÏõê Î™©Î°ù Î°úÎìú
            try {
                console.log('üîÑ Í∞úÎ≥Ñ Ìé∏ÏßëÏö© ÌåÄÏõê Î™©Î°ù Î°úÎìú ÏãúÏûë...');
                const resp = await fetch('/api/employees?per_page=200&page=1');
                const data = await resp.json();
                const currentTeam = '{{ employee_team }}';
                
                console.log('üì• Í∞úÎ≥Ñ Ìé∏Ïßë API ÏùëÎãµ:', data);
                console.log('üë• ÌòÑÏû¨ ÌåÄ:', currentTeam);
                
                if (data.employees) {
                    // ÏûêÏã†Ïùò ÌåÄ Î©§Î≤Ñ ÌïÑÌÑ∞ÎßÅ (ÌåÄÏû• Ìè¨Ìï®) - Supabase ÌïÑÎìúÎ™Ö ÏÇ¨Ïö©
                    const teamMembers = data.employees.filter(e => {
                        const isCorrectTeam = e.team === currentTeam;
                        const isTeamLeaderOrEmployee = e.role && (e.role === 'ÌåÄÏû•' || e.role === 'ÏßÅÏõê');
                        return isCorrectTeam && isTeamLeaderOrEmployee;
                    });
                    
                    console.log('‚úÖ Í∞úÎ≥Ñ Ìé∏ÏßëÏö© ÌïÑÌÑ∞ÎßÅÎêú ÌåÄÏõê:', teamMembers);
                    
                    selector.innerHTML = '<option value="">Îã¥ÎãπÏûê ÏÑ†ÌÉù</option>';
                    
                    if (teamMembers.length === 0) {
                        const noMembersOption = document.createElement('option');
                        noMembersOption.value = '';
                        noMembersOption.textContent = 'Ìï¥Îãπ ÌåÄÏóê ÌåÄÏõêÏù¥ ÏóÜÏäµÎãàÎã§';
                        noMembersOption.disabled = true;
                        selector.appendChild(noMembersOption);
                        console.warn('‚ö†Ô∏è Í∞úÎ≥Ñ Ìé∏Ïßë: Ìï¥Îãπ ÌåÄÏóê ÌåÄÏõêÏù¥ ÏóÜÏäµÎãàÎã§.');
                    } else {
                        teamMembers.forEach(emp => {
                            const option = document.createElement('option');
                            option.value = emp.id || emp.employee_id || emp.name;
                            option.dataset.employeeName = emp.name;
                            option.dataset.employeeTeam = emp.team || currentTeam;
                            option.textContent = `${emp.name}${emp.role ? ` (${emp.role})` : ''}`;
                            if (emp.name === currentValue) {
                                option.selected = true;
                            }
                            selector.appendChild(option);
                        });
                    }
                }
            } catch (error) {
                console.error('‚ùå Í∞úÎ≥Ñ Ìé∏ÏßëÏö© ÌåÄÏõê Î™©Î°ù Î°úÎìú Ïã§Ìå®:', error);
                alert('ÌåÄÏõê Î™©Î°ùÏùÑ Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
                return;
            }
            
            // ÏÖÄÏùÑ Ìé∏Ïßë Î™®ÎìúÎ°ú Î≥ÄÍ≤Ω
            cell.classList.add('editing-cell');
            const originalContent = cell.innerHTML;
            cell.innerHTML = '';
            cell.appendChild(selector);
            
            // Ìè¨Ïª§Ïä§ ÏÑ§Ï†ï
            selector.focus();
            
            // Ï†ÄÏû• Ìï®Ïàò
            const saveCell = async (moveNext = false) => {
                const newValue = selector.value;
                const propertyId = cell.closest('tr').dataset.propertyId;
                
                if (newValue !== currentValue) {
                    try {
                        // ÏÑ†ÌÉùÎêú ÏßÅÏõêÏùò Ïù¥Î¶Ñ Í∞ÄÏ†∏Ïò§Í∏∞
                        const selectedOption = selector.options[selector.selectedIndex];
                        const employeeName = selectedOption.dataset.employeeName || selectedOption.textContent.split(' (')[0];
                        
                        // ÏÑúÎ≤ÑÏóê Î≥ÄÍ≤ΩÏÇ¨Ìï≠ Ï†ÄÏû•
                        const response = await fetch(`/api/maeiple/${propertyId}/update`, {
                            method: 'PUT',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                employee_id: newValue,
                                employee_name: employeeName
                            })
                        });
                        
                        const result = await response.json();
                        if (result.success) {
                            // ÏÑ±Í≥µÏãú UI ÏóÖÎç∞Ïù¥Ìä∏
                            cell.innerHTML = `<span style="color: #4f46e5; font-weight: 500;">${employeeName || 'ÎØ∏ÏßÄÏ†ï'}</span>`;
                            console.log('Îã¥ÎãπÏûê Î≥ÄÍ≤Ω ÏÑ±Í≥µ');
                        } else {
                            throw new Error(result.message || 'Ï†ÄÏû• Ïã§Ìå®');
                        }
                    } catch (error) {
                        console.error('Ï†ÄÏû• Ïã§Ìå®:', error);
                        alert('Î≥ÄÍ≤ΩÏÇ¨Ìï≠ Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
                        cell.innerHTML = originalContent;
                    }
                } else {
                    // Î≥ÄÍ≤ΩÏÇ¨Ìï≠Ïù¥ ÏóÜÏúºÎ©¥ ÏõêÎûò ÎÇ¥Ïö© Î≥µÏõê
                    cell.innerHTML = originalContent;
                }
                
                cell.classList.remove('editing-cell');
            };
            
            // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà
            selector.addEventListener('change', () => {
                saveCell();
            });
            
            selector.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    saveCell();
                } else if (e.key === 'Escape') {
                    e.preventDefault();
                    cell.innerHTML = originalContent;
                    cell.classList.remove('editing-cell');
                }
            });
            
            selector.addEventListener('blur', () => {
                saveCell();
            });
        }

        // ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠Ïö© Îß§Î¨º Ìé∏Ïßë Í∏∞Îä•Îì§ (Í¥ÄÎ¶¨Ïûê Ìå®ÎÑê Ïä§ÌÉÄÏùº)
        
        // ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠Ïö© ÎÇ†Ïßú Ìé∏Ïßë
        function editAdminDate(propertyId, currentDate, cell) {
            if (cell.querySelector('input')) return;
            
            const input = document.createElement('input');
            input.type = 'date';
            input.value = currentDate;
            input.className = 'admin-edit-input';
            input.style.cssText = 'width: 100%; padding: 4px; border: 1px solid #ccc; border-radius: 4px;';
            
            cell.innerHTML = '';
            cell.appendChild(input);
            input.focus();
            
            input.onblur = async function() {
                const newValue = input.value;
                cell.textContent = newValue;
                
                if (propertyId === 'new') {
                    await autoSaveNewProperty(cell);
                } else {
                    await updateAdminProperty(propertyId, 'check_date', newValue);
                }
            };
            
            input.onkeypress = function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    input.blur();
                    // Îã§Ïùå Ìé∏Ïßë Í∞ÄÎä•Ìïú ÏÖÄÎ°ú Ïù¥Îèô
                    const nextCell = cell.nextElementSibling;
                    if (nextCell && nextCell.onclick) {
                        nextCell.click();
                    }
                }
            };
        }
        
        // ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠Ïö© Ìò∏Ïàò/Îèô Î≤àÌò∏ Ìé∏Ïßë
        function editAdminNumber(propertyId, field, currentValue, cell) {
            if (cell.querySelector('input')) return;
            
            const input = document.createElement('input');
            input.type = 'text';
            input.value = currentValue;
            input.className = 'admin-edit-input';
            input.style.cssText = 'width: 100%; padding: 4px; border: 1px solid #ccc; border-radius: 4px;';
            input.placeholder = field === 'building_number' ? 'Îèô Î≤àÌò∏' : 'Ìò∏Ïàò';
            
            cell.innerHTML = '';
            cell.appendChild(input);
            input.focus();
            
            input.onblur = async function() {
                const newValue = input.value;
                cell.textContent = newValue;
                
                if (propertyId === 'new') {
                    await autoSaveNewProperty(cell);
                } else {
                    await updateAdminProperty(propertyId, field, newValue);
                }
            };
            
            input.onkeypress = function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    input.blur();
                    // Îã§Ïùå Ìé∏Ïßë Í∞ÄÎä•Ìïú ÏÖÄÎ°ú Ïù¥Îèô
                    const nextCell = cell.nextElementSibling;
                    if (nextCell && nextCell.onclick) {
                        nextCell.click();
                    }
                }
            };
        }
        
        // ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠Ïö© Í∞ÄÍ≤© Ìé∏Ïßë
        function editAdminPrice(propertyId, field, currentValue, cell) {
            if (cell.querySelector('input')) return;
            
            const input = document.createElement('input');
            input.type = 'text';
            input.value = extractNumber(currentValue) || '';
            input.className = 'admin-edit-input';
            input.style.cssText = 'width: 100%; padding: 4px; border: 1px solid #ccc; border-radius: 4px;';
            input.placeholder = 'Í∞ÄÍ≤© (ÎßåÏõê)';
            
            cell.innerHTML = '';
            cell.appendChild(input);
            input.focus();
            
            input.onblur = async function() {
                const newValue = input.value;
                const displayValue = newValue ? formatNumber(newValue) + ' ÎßåÏõê' : '-';
                cell.innerHTML = `<span style="cursor: pointer; color: #2563eb; font-weight: 500;">${displayValue}</span>`;
                
                if (propertyId === 'new') {
                    await autoSaveNewProperty(cell);
                } else {
                    await updateAdminProperty(propertyId, field, newValue);
                }
            };
            
            input.onkeypress = function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    input.blur();
                    // Îã§Ïùå Ìé∏Ïßë Í∞ÄÎä•Ìïú ÏÖÄÎ°ú Ïù¥Îèô
                    const nextCell = cell.nextElementSibling;
                    if (nextCell && nextCell.onclick) {
                        nextCell.click();
                    }
                }
            };
        }
        
        // ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠Ïö© Ï†ÑÌôîÎ≤àÌò∏ Ìé∏Ïßë
        function editAdminPhone(propertyId, currentValue, cell) {
            if (cell.querySelector('input')) return;
            
            const input = document.createElement('input');
            input.type = 'tel';
            input.value = currentValue === '-' ? '' : currentValue;
            input.className = 'admin-edit-input';
            input.style.cssText = 'width: 100%; padding: 4px; border: 1px solid #ccc; border-radius: 4px; font-family: monospace;';
            input.placeholder = 'Ï†ÑÌôîÎ≤àÌò∏';
            
            cell.innerHTML = '';
            cell.appendChild(input);
            input.focus();
            
            input.onblur = async function() {
                const newValue = input.value || '-';
                cell.textContent = newValue === '-' ? '-' : formatPhoneNumber(newValue);
                
                if (propertyId === 'new') {
                    await autoSaveNewProperty(cell);
                } else {
                    await updateAdminProperty(propertyId, 'phone', newValue === '-' ? '' : newValue);
                }
            };
            
            input.onkeypress = function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    input.blur();
                    // Îã§Ïùå Ìé∏Ïßë Í∞ÄÎä•Ìïú ÏÖÄÎ°ú Ïù¥Îèô
                    const nextCell = cell.nextElementSibling;
                    if (nextCell && nextCell.onclick) {
                        nextCell.click();
                    }
                }
            };
        }
        
        // ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠Ïö© Î©îÎ™® Ìé∏Ïßë (Î™®Îã¨ Î∞©Ïãù)
        function editAdminMemo(propertyId, currentValue, cell) {
            // Îß§Î¨º Ï†ïÎ≥¥ Ï∂îÏ∂ú
            const row = cell.closest('tr');
            const buildingCell = row.cells[2]; // Îèô Î≤àÌò∏
            const roomCell = row.cells[3]; // Ìò∏Ïàò
            const buildingNumber = buildingCell ? buildingCell.textContent.trim() : '';
            const roomNumber = roomCell ? roomCell.textContent.trim() : '';
            
            if (propertyId === 'new') {
                // ÏÉà Îß§Î¨ºÏù∏ Í≤ΩÏö∞ ÏÉà Îß§Î¨º Î™®Îã¨ Ìï®Ïàò ÏÇ¨Ïö©
                openNewPropertyMemoModal(cell);
            } else {
                // Í∏∞Ï°¥ Îß§Î¨ºÏù∏ Í≤ΩÏö∞ Í∏∞Ï°¥ Îß§Î¨º Î™®Îã¨ Ìï®Ïàò ÏÇ¨Ïö©
                openPropertyMemoModal(propertyId, currentValue, buildingNumber, roomNumber);
            }
        }
        
        // ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠Ïö© ÏÉÅÌÉú Î≥ÄÍ≤Ω
        function showAdminStatusOptions(propertyId, currentStatus, button) {
            const options = ['Í±∞ÎûòÍ∞ÄÎä•', 'Í≥ÑÏïΩÏôÑÎ£å', 'Î≥¥Î•ò', 'Î∂ÄÏû¨'];
            
            // Í∏∞Ï°¥ ÏòµÏÖò Î©îÎâ¥Í∞Ä ÏûàÎã§Î©¥ Ï†úÍ±∞
            const existingMenu = document.querySelector('.admin-status-menu');
            if (existingMenu) {
                existingMenu.remove();
                return;
            }
            
            const menu = document.createElement('div');
            menu.className = 'admin-status-menu';
            menu.style.cssText = `
                position: absolute;
                background: white;
                border: 1px solid #e2e8f0;
                border-radius: 6px;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
                z-index: 1000;
                min-width: 100px;
            `;
            
            options.forEach(status => {
                const option = document.createElement('button');
                option.textContent = status;
                option.style.cssText = `
                    width: 100%;
                    padding: 8px 12px;
                    border: none;
                    background: ${status === currentStatus ? '#f1f5f9' : 'transparent'};
                    text-align: left;
                    cursor: pointer;
                    font-size: 12px;
                `;
                
                option.onmouseenter = () => option.style.background = '#f1f5f9';
                option.onmouseleave = () => option.style.background = status === currentStatus ? '#f1f5f9' : 'transparent';
                
                option.onclick = async () => {
                    button.textContent = status;
                    button.style.cssText = getAdminStatusBadge(status);
                    menu.remove();
                    
                    if (propertyId === 'new') {
                        await autoSaveNewProperty(button.closest('td'));
                    } else {
                        await updateAdminProperty(propertyId, 'status', status);
                    }
                };
                
                menu.appendChild(option);
            });
            
            // Î©îÎâ¥ ÏúÑÏπò ÏÑ§Ï†ï
            const rect = button.getBoundingClientRect();
            menu.style.left = rect.left + 'px';
            menu.style.top = (rect.bottom + window.scrollY) + 'px';
            
            document.body.appendChild(menu);
            
            // Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Î©îÎâ¥ Îã´Í∏∞
            setTimeout(() => {
                document.addEventListener('click', function closeMenu(e) {
                    if (!menu.contains(e.target)) {
                        menu.remove();
                        document.removeEventListener('click', closeMenu);
                    }
                });
            }, 0);
        }
                
        // ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠Ïö© Í±∞Ï£º ÏÉÅÌÉú ÌÜ†Í∏Ä
        async function toggleAdminOccupied(propertyId, currentState) {
            const newState = !currentState;
            
            // UI Ï¶âÏãú ÏóÖÎç∞Ïù¥Ìä∏
            const button = event.target;
            button.textContent = newState ? 'O' : 'X';
            button.style.cssText = getAdminOccupiedBadge(newState);
            
            if (propertyId === 'new') {
                await autoSaveNewProperty(button.closest('td'));
            } else {
                await updateAdminProperty(propertyId, 'is_occupied', newState);
            }
        }
        
        // ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠Ïö© Îß§Î¨º ÏóÖÎç∞Ïù¥Ìä∏ (Í¥ÄÎ¶¨ÏûêÏôÄ ÎèôÏùºÌïú Î∞©Ïãù)
        async function updateAdminProperty(propertyId, field, value) {
            console.log('üîÑ updateAdminProperty Ìò∏Ï∂ú:', { propertyId, field, value });
            try {
                const requestData = {
                    id: propertyId,
                    field: field,
                    value: value
                };
                console.log('üì§ API ÏöîÏ≤≠ Îç∞Ïù¥ÌÑ∞:', requestData);
                
                const response = await fetch('/api/maeiple/update', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestData)
                });
                
                console.log('üì• API ÏùëÎãµ ÏÉÅÌÉú:', response.status, response.statusText);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('‚ùå API ÏóêÎü¨ ÏùëÎãµ:', errorText);
                    throw new Error(`HTTP ${response.status}: ${errorText}`);
                }
                
                const result = await response.json();
                console.log('üì• API ÏùëÎãµ Îç∞Ïù¥ÌÑ∞:', result);
                
                if (!result.success) {
                    console.error('‚ùå API Ïã§Ìå® ÏùëÎãµ:', result);
                    throw new Error(result.error || 'ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìå®');
                }
                
                console.log('‚úÖ updateAdminProperty ÏÑ±Í≥µ:', field, value);
                
                // Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ÎèÑ ÏóÖÎç∞Ïù¥Ìä∏ÌïòÏó¨ ÏàúÏÑú Ïú†ÏßÄ
                const property = properties.find(p => p.id === propertyId);
                if (property) {
                    property[field] = value;
                }
                
            } catch (error) {
                console.error('ÏïÑÌååÌä∏Î™©Î°ù Îß§Î¨º ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìå®:', error);
                alert('ÏàòÏ†ï Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
            }
        }
        
        // Í¥ÄÎ¶¨Ïûê Ïä§ÌÉÄÏùº Îß§Î¨º ÏÖÄ Ìé∏Ïßë Ìï®Ïàò (Í¥ÄÎ¶¨Ïûê Ìå®ÎÑêÍ≥º ÎèôÏùº)
        function editAdminPropertyCell(cell) {
            // Ïù¥ÎØ∏ Ìé∏Ïßë Ï§ëÏù¥Î©¥ Ìé∏Ïßë Î™®Îìú Ï¢ÖÎ£å
            if (cell.classList.contains('editing-cell')) {
                return;
            }
            
            const field = cell.dataset.field;
            const type = cell.dataset.type;
            let currentValue = cell.textContent.trim();
            
            // Î∞∞ÏßÄÏóêÏÑú ÌòÑÏû¨ Í∞í Ï∂îÏ∂ú
            if (field === 'status') {
                const badge = cell.querySelector('.badge');
                currentValue = badge ? badge.textContent.trim() : 'Í±∞ÎûòÍ∞ÄÎä•';
            } else if (field === 'is_occupied') {
                const badge = cell.querySelector('.badge');
                currentValue = badge ? badge.textContent.trim() : 'X';
            }
            
            cell.classList.add('editing-cell');
            
            if (field === 'status') {
                // ÏÉÅÌÉú ÏÑ†ÌÉù ÎìúÎ°≠Îã§Ïö¥
                const statusOptions = ['Í±∞ÎûòÍ∞ÄÎä•', 'Í±∞ÎûòÏ§ë', 'Í≥ÑÏïΩÏôÑÎ£å', 'Î≥¥Î•ò', 'Î∂ÄÏû¨'];
                const selector = document.createElement('select');
                selector.className = 'status-selector';
                selector.style.cssText = 'width: 100%; padding: 4px; border: 1px solid #ccc; border-radius: 4px; font-size: 12px;';
                
                statusOptions.forEach(status => {
                    const option = document.createElement('option');
                    option.value = status;
                    option.textContent = status;
                    if (status === currentValue) {
                        option.selected = true;
                    }
                    selector.appendChild(option);
                });
                
                selector.addEventListener('change', () => {
                    const selectedValue = selector.value;
                    const statusColors = {
                        'Í±∞ÎûòÍ∞ÄÎä•': { bg: '#e0f2fe', color: '#0369a1' },
                        'Í±∞ÎûòÏ§ë': { bg: '#fef3c7', color: '#d97706' },
                        'Í≥ÑÏïΩÏôÑÎ£å': { bg: '#dcfce7', color: '#16a34a' },
                        'Î≥¥Î•ò': { bg: '#fef3c7', color: '#d97706' },
                        'Î∂ÄÏû¨': { bg: '#fecaca', color: '#dc2626' }
                    };
                    const colors = statusColors[selectedValue] || statusColors['Í±∞ÎûòÍ∞ÄÎä•'];
                    
                    cell.innerHTML = `<span class="badge" style="background: ${colors.bg}; color: ${colors.color}; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">${selectedValue}</span>`;
                    cell.classList.remove('editing-cell');
                    
                    // ÏûêÎèôÏ†ÄÏû• Ïã§Ìñâ
                    autoSaveNewProperty(cell);
                });
                
                cell.innerHTML = '';
                cell.appendChild(selector);
                selector.focus();
                
            } else if (field === 'is_occupied') {
                // Í±∞Ï£º Ïó¨Î∂Ä ÏÑ†ÌÉù
                const occupiedOptions = [
                    { value: false, text: 'X', bg: '#fecaca', color: '#dc2626' },
                    { value: true, text: 'O', bg: '#dcfce7', color: '#16a34a' }
                ];
                const selector = document.createElement('select');
                selector.className = 'occupied-selector';
                selector.style.cssText = 'width: 100%; padding: 4px; border: 1px solid #ccc; border-radius: 4px; font-size: 12px;';
                
                occupiedOptions.forEach(option => {
                    const opt = document.createElement('option');
                    opt.value = option.value;
                    opt.textContent = option.text;
                    if ((option.text === 'O' && currentValue === 'O') || (option.text === 'X' && currentValue === 'X')) {
                        opt.selected = true;
                    }
                    selector.appendChild(opt);
                });
                
                selector.addEventListener('change', () => {
                    const selectedValue = selector.value === 'true';
                    const option = occupiedOptions.find(opt => opt.value === selectedValue);
                    
                    cell.innerHTML = `<span class="badge" style="background: ${option.bg}; color: ${option.color}; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">${option.text}</span>`;
                    cell.classList.remove('editing-cell');
                    
                    // ÏûêÎèôÏ†ÄÏû• Ïã§Ìñâ
                    autoSaveNewProperty(cell);
                });
                
                cell.innerHTML = '';
                cell.appendChild(selector);
                selector.focus();
                
            } else {
                // ÏùºÎ∞ò ÏûÖÎ†• ÌïÑÎìú
                const input = document.createElement('input');
                input.type = type === 'date' ? 'date' : (type === 'number' ? 'text' : 'text');
                // ÌîåÎ†àÏù¥Ïä§ÌôÄÎçî ÌÖçÏä§Ìä∏Ïù∏ Í≤ΩÏö∞ÏóêÎßå Îπà Î¨∏ÏûêÏó¥Î°ú ÏÑ§Ï†ï
                const placeholderTexts = [
                    'Ï†ÑÏÑ∏Í∞Ä ÏûÖÎ†•', 'ÏõîÏÑ∏Î≥¥Ï¶ùÍ∏à ÏûÖÎ†•', 'ÏõîÏÑ∏ ÏûÖÎ†•', 'Îß§Îß§Í∞Ä ÏûÖÎ†•', 
                    'Ïó∞ÎùΩÏ≤ò ÏûÖÎ†•', 'Î©îÎ™® ÏûÖÎ†•', 'Ìò∏Ïàò ÏûÖÎ†•', 'Î©¥Ï†Å ÏûÖÎ†•',
                    'Ï∏µÏàò ÏûÖÎ†•', 'Î∞©Ìñ• ÏûÖÎ†•', 'Í±¥Ï∂ïÎÖÑÎèÑ ÏûÖÎ†•'
                ];
                input.value = placeholderTexts.includes(currentValue.trim()) ? '' : currentValue;
                input.style.cssText = 'width: 100%; padding: 4px; border: 1px solid #ccc; border-radius: 4px; font-size: 12px;';
                
                input.addEventListener('blur', () => {
                    let newValue = input.value;
                    if (type === 'number' && field.includes('price')) {
                        const num = parseInt(newValue.replace(/[^0-9]/g, ''));
                        if (!isNaN(num) && num > 0) {
                            newValue = num.toLocaleString();
                        }
                    }
                    
                    cell.textContent = newValue || (field.includes('price') || field.includes('deposit') || field.includes('rent') ? '0' : '');
                    cell.style.color = newValue ? '#1f2937' : '#64748b';
                    cell.classList.remove('editing-cell');
                    
                    // ÏûêÎèôÏ†ÄÏû• Ïã§Ìñâ
                    autoSaveNewProperty(cell);
                });
                
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        input.blur();
                        // Îã§Ïùå Ìé∏Ïßë Í∞ÄÎä•Ìïú ÏÖÄÎ°ú Ïù¥Îèô
                        const nextCell = cell.parentElement.nextElementSibling?.querySelector('.editable-cell');
                        if (nextCell) {
                            nextCell.click();
                        }
                    }
                });
                
                cell.innerHTML = '';
                cell.appendChild(input);
                input.focus();
            }
        }

        // ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠Ïö© ÏûêÎèôÏ†ÄÏû• (Í¥ÄÎ¶¨ÏûêÏôÄ ÎèôÏùºÌïú Î∞©Ïãù)
        async function autoSaveNewProperty(cell) {
            const row = cell.closest('tr');
            if (!row || !row.classList.contains('new-property-row')) {
                return; // ÏÉà Îß§Î¨º ÌñâÏù¥ ÏïÑÎãàÎ©¥ Ï†ÄÏû•ÌïòÏßÄ ÏïäÏùå
            }
            
            console.log('üîÑ ÏÉà Îß§Î¨º ÏûêÎèôÏ†ÄÏû• ÏãúÏûë...');
            
            try {
                // Îç∞Ïù¥ÌÑ∞ ÏàòÏßë (Í¥ÄÎ¶¨Ïûê Ìå®ÎÑêÍ≥º ÎèôÏùºÌïú Î∞©Ïãù)
                const propertyData = {};
                const cells = row.querySelectorAll('.editable-cell');
                
                cells.forEach(cell => {
                    const field = cell.dataset.field;
                    let value = cell.textContent.trim();
                    
                    // Î∞∞ÏßÄÏóêÏÑú Í∞í Ï∂îÏ∂ú
                    if (field === 'status') {
                        const badge = cell.querySelector('.badge');
                        value = badge ? badge.textContent.trim() : 'Í±∞ÎûòÍ∞ÄÎä•';
                    } else if (field === 'is_occupied') {
                        const badge = cell.querySelector('.badge');
                        value = badge && badge.textContent.trim() === 'O';
                    } else if (field.includes('price') || field.includes('deposit') || field.includes('rent')) {
                        // Í∞ÄÍ≤© ÌïÑÎìú Ï≤òÎ¶¨
                        const numValue = value.replace(/[^0-9]/g, '');
                        value = numValue ? parseInt(numValue) : null;
                    } else if (field === 'building_number' || field === 'room_number') {
                        // Îèô/Ìò∏Ïàò Ï≤òÎ¶¨ (ÏÑ†ÌÉùÏÇ¨Ìï≠)
                        value = value.replace(/[^0-9]/g, '');
                        // ÌïÑÏàò Í≤ÄÏ¶ù Ï†úÍ±∞ - Îπà Í∞íÎèÑ ÌóàÏö©
                    } else if (field === 'phone') {
                        // Ï†ÑÌôîÎ≤àÌò∏ Ï≤òÎ¶¨
                        if (value === 'Ïó∞ÎùΩÏ≤ò ÏûÖÎ†•' || value === '') {
                            value = '';
                        }
                    }
                    
                    // ÌîåÎ†àÏù¥Ïä§ÌôÄÎçî ÌÖçÏä§Ìä∏ Ï†úÍ±∞ (Í¥ÄÎ¶¨Ïûê Ìå®ÎÑêÍ≥º ÎèôÏùº)
                    if (field === 'employee_name' && typeof value === 'string' && value.includes('ÏûÖÎ†•')) {
                        value = '';
                    }
                    
                    propertyData[field] = value;
                });
                
                // Î©îÎ™® Ï≤òÎ¶¨
                const memoCell = row.querySelector('.memo-cell');
                propertyData.memo = memoCell.dataset.memo || '';
                
                // Îã¥ÎãπÏûêÏôÄ ÌåÄ Ï†ïÎ≥¥ (Í¥ÄÎ¶¨Ïûê Ìå®ÎÑêÍ≥º ÎèôÏùº)
                propertyData.employee_name = propertyData.employee_name || '';
                propertyData.employee_team = propertyData.employee_team || '';
                
                // Ï¢ãÏïÑÏöî/Ïã´Ïñ¥Ïöî Ï†ïÎ≥¥ Ï∂îÍ∞Ä
                const likesElement = row.querySelector('[onclick*="editNewPropertyLikes"][onclick*="like"]');
                const dislikesElement = row.querySelector('[onclick*="editNewPropertyLikes"][onclick*="dislike"]');
                propertyData.likes = parseInt(likesElement?.dataset?.count) || 0;
                propertyData.dislikes = parseInt(dislikesElement?.dataset?.count) || 0;
                
                console.log('ÏûêÎèôÏ†ÄÏû•Ìï† Îß§Î¨º Îç∞Ïù¥ÌÑ∞:', propertyData);
                
                // API Ìò∏Ï∂ú
                const response = await fetch('/api/maeiple', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(propertyData)
                });
                
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('ÏÑúÎ≤Ñ ÏùëÎãµ Ïò§Î•ò:', response.status, errorText);
                    return;
                }
                
                const result = await response.json();
                console.log('ÏÑúÎ≤Ñ ÏùëÎãµ:', result);
                
                if (result && result.success === true) {
                    console.log('‚úÖ ÏÉà Îß§Î¨º ÏûêÎèôÏ†ÄÏû• ÏÑ±Í≥µ:', result);
                    
                    // ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ÄÏû•Îêú Í≤ΩÏö∞ ÏÉà ÌñâÏùÑ Ï†úÍ±∞ÌïòÍ≥† ÌÖåÏù¥Î∏îÏóê Ï∂îÍ∞Ä
                    if (result.created_property) {
                        await addNewPropertyToTable(result.created_property);
                        row.remove();
                        
                        // ÏÑ±Í≥µ Î©îÏãúÏßÄ ÌëúÏãú
                        alert('Îß§Î¨ºÏù¥ ÏûêÎèôÏúºÎ°ú Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.');
                    }
                        } else {
                    const errorMsg = result?.error || result?.message || 'ÏûêÎèôÏ†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.';
                    console.warn('ÏûêÎèôÏ†ÄÏû• Ïã§Ìå®:', errorMsg);
                }
                
            } catch (error) {
                console.error('Îß§Î¨º ÏûêÎèôÏ†ÄÏû• Ïò§Î•ò:', error);
                // Ïò§Î•òÍ∞Ä Î∞úÏÉùÌï¥ÎèÑ ÏÇ¨Ïö©ÏûêÏóêÍ≤åÎäî ÏïåÎ¶¨ÏßÄ ÏïäÏùå (ÏûêÎèôÏ†ÄÏû•Ïù¥ÎØÄÎ°ú)
            }
        }
        
        // ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠Ïö© ÏÉÅÌÉú Î∞∞ÏßÄ ÏÉùÏÑ±
        function getAdminStatusBadge(status) {
            const styles = {
                'Í±∞ÎûòÍ∞ÄÎä•': 'padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; background: #e0f2fe; color: #0369a1;',
                'Í±∞ÎûòÏ§ë': 'padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; background: #fef3c7; color: #92400e;',
                'Í≥ÑÏïΩÏôÑÎ£å': 'padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; background: #d1fae5; color: #065f46;',
                'Î≥¥Î•ò': 'padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; background: #fecaca; color: #dc2626;',
                'Î∂ÄÏû¨': 'padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; background: #ede9fe; color: #5b21b6;'
            };
            return styles[status] || styles['Í±∞ÎûòÍ∞ÄÎä•'];
        }
        
        // ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠Ïö© Í±∞Ï£º ÏÉÅÌÉú Î∞∞ÏßÄ ÏÉùÏÑ±
        function getAdminOccupiedBadge(isOccupied) {
            return `background: none; border: none; cursor: pointer; font-size: 18px; padding: 4px; border-radius: 4px; color: ${isOccupied ? '#059669' : '#dc2626'};`;
        }

        // ÏÉàÎ°ú Ï∂îÍ∞ÄÎêú Îß§Î¨ºÏùÑ ÏïÑÌååÌä∏Î™©Î°ù ÌÖåÏù¥Î∏îÏóê Ï¶âÏãú ÌëúÏãú
        async function addNewPropertyToTable(property) {
            console.log('üîÑ ÏÉà Îß§Î¨ºÏùÑ ÏïÑÌååÌä∏Î™©Î°ù ÌÖåÏù¥Î∏îÏóê Ï¶âÏãú Ï∂îÍ∞Ä:', property);
            
            const tbody = document.querySelector('#maeiple-table-content table tbody');
            if (!tbody) {
                console.error('ÏïÑÌååÌä∏Î™©Î°ù ÌÖåÏù¥Î∏î tbodyÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            // ÏÉà Ìñâ ÏÉùÏÑ±
            const newRow = document.createElement('tr');
            newRow.className = 'property-row';
            newRow.dataset.propertyId = property.id;
            
            newRow.innerHTML = `
                <td style="text-align: center;">
                    <input type="checkbox" class="property-checkbox" value="${property.id}" 
                           onchange="updateSelectionCount()" style="width: 16px; height: 16px; cursor: pointer;">
                </td>
                <td style="cursor: pointer;" onclick="editAdminDate(${property.id}, '${property.check_date || ''}', this)">${property.check_date || '-'}</td>
                <td style="cursor: pointer;" onclick="editAdminNumber(${property.id}, 'building_number', '${property.building_number || ''}', this)">${property.building_number || '-'}</td>
                <td style="cursor: pointer;" onclick="editAdminNumber(${property.id}, 'room_number', '${property.room_number || ''}', this)">${property.room_number || '-'}</td>
                <td>
                    <button style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; ${property.status === 'Í≥ÑÏïΩÏôÑÎ£å' ? 'background: #d1fae5; color: #065f46;' : property.status === 'Î≥¥Î•ò' ? 'background: #fef3c7; color: #92400e;' : property.status === 'Î∂ÄÏû¨' ? 'background: #ede9fe; color: #5b21b6;' : 'background: #e0f2fe; color: #0369a1;'}" 
                            onclick="showAdminStatusOptions(${property.id}, '${property.status || 'Í±∞ÎûòÍ∞ÄÎä•'}', this)">
                        ${property.status || 'Í±∞ÎûòÍ∞ÄÎä•'}
                    </button>
                </td>
                <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editAdminPrice(${property.id}, 'jeonse_price', '${property.jeonse_price || ''}', this)">
                    ${property.jeonse_price ? formatNumber(property.jeonse_price) + ' ÎßåÏõê' : '-'}
                </td>
                <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editAdminPrice(${property.id}, 'monthly_deposit', '${property.monthly_deposit || property.deposit || ''}', this)">
                    ${property.monthly_deposit || property.deposit ? formatNumber(property.monthly_deposit || property.deposit) + ' ÎßåÏõê' : '-'}
                </td>
                <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editAdminPrice(${property.id}, 'monthly_rent', '${property.monthly_rent || ''}', this)">
                    ${property.monthly_rent ? formatNumber(property.monthly_rent) + ' ÎßåÏõê' : '-'}
                </td>
                <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editAdminPrice(${property.id}, 'sale_price', '${property.sale_price || ''}', this)">
                    ${property.sale_price ? formatNumber(property.sale_price) + ' ÎßåÏõê' : '-'}
                </td>
                <td>
                    <button style="background: none; border: none; cursor: pointer; font-size: 18px; padding: 4px; border-radius: 4px; color: ${property.is_occupied ? '#059669' : '#dc2626'};" 
                            onclick="toggleAdminOccupied(${property.id}, ${property.is_occupied})">
                        ${property.is_occupied ? 'O' : 'X'}
                    </button>
                </td>
                <td style="cursor: pointer; font-family: monospace; letter-spacing: 0.5px; max-width: 120px; overflow: hidden; text-overflow: ellipsis;" onclick="editAdminPhone(${property.id}, '${property.phone || ''}', this)">
                    ${property.phone || '-'}
                </td>
                <td class="memo-cell" onclick="editAdminMemo(${property.id}, '${(property.memo || '').replace(/'/g, "\\'")}', this)" style="color: #64748b; font-style: italic; max-width: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; cursor: pointer;">
                    ${property.memo ? (property.memo.length > 20 ? property.memo.substring(0, 20) + '...' : property.memo) : 'ÌÅ¥Î¶≠ÌïòÏó¨ Î©îÎ™® Ï∂îÍ∞Ä'}
                </td>
                <td class="editable-cell" data-field="employee_id" data-type="select" onclick="editPropertyCell(this)" style="cursor: pointer;">
                    <span style="color: #4f46e5; font-weight: 500;">
                        ${property.employee_name || 'ÎØ∏ÏßÄÏ†ï'}
                    </span>
                </td>
                <td>
                    <span class="status-badge" style="background: ${getTeamBadgeColor(property.employee_team)}; color: ${getTeamTextColor(property.employee_team)};">
                        ${property.employee_team || 'ÎØ∏ÏßÄÏ†ï'}
                    </span>
                </td>
                <td>
                    <div style="cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; gap: 2px;" onclick="editPropertyLikes(${property.id}, 'likes', ${property.likes || 0}, this)" data-count="${property.likes || 0}">
                        <span style="color: #9ca3af; font-size: 14px;">‚ù§Ô∏è ${property.likes || 0}</span>
                    </div>
                </td>
                <td>
                    <div style="cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; gap: 2px;" onclick="editPropertyLikes(${property.id}, 'dislikes', ${property.dislikes || 0}, this)" data-count="${property.dislikes || 0}">
                        <span style="color: #9ca3af; font-size: 14px;">üëé ${property.dislikes || 0}</span>
                    </div>
                </td>
            `;
            
            tbody.insertBefore(newRow, tbody.firstChild);
            
            // ÏÉàÎ°ú Ï∂îÍ∞ÄÎêú ÌñâÏóê ÌïòÏù¥ÎùºÏù¥Ìä∏ Ìö®Í≥º Ï†ÅÏö©
            newRow.style.backgroundColor = '#f0f9ff';
            newRow.style.transition = 'background-color 0.5s ease';
            
            setTimeout(() => {
                newRow.style.backgroundColor = '';
            }, 2000);
            
            console.log('‚úÖ ÏÉà Îß§Î¨ºÏù¥ ÏïÑÌååÌä∏Î™©Î°ù ÌÖåÏù¥Î∏îÏóê Ï¶âÏãú Ï∂îÍ∞ÄÎê®');
        }

        // ÌåÄÏû•Ïö© Îß§Î¨º ÏÖÄ Ìé∏Ïßë Í∏∞Îä• (Í¥ÄÎ¶¨Ïûê Ìå®ÎÑê Í∏∞Îä• Ïù¥Ïãù)
        function editTeamLeaderPropertyCell(cell) {
            // Ïù¥ÎØ∏ Ìé∏Ïßë Ï§ëÏù¥Î©¥ Ìé∏Ïßë Î™®Îìú Ï¢ÖÎ£å
            if (cell.classList.contains('editing-cell')) {
                const existingSelector = cell.querySelector('.status-selector');
                if (existingSelector) {
                    existingSelector.remove();
                }
                cell.classList.remove('editing-cell');
                return;
            }
            
            const field = cell.dataset.field;
            const type = cell.dataset.type;
            let currentValue = cell.textContent.trim();
            
            // Î∞∞ÏßÄÏóêÏÑú Ïã§Ï†ú Í∞í Ï∂îÏ∂ú
            if (field === 'status') {
                const badge = cell.querySelector('.badge');
                currentValue = badge ? badge.textContent.trim() : 'Í±∞ÎûòÍ∞ÄÎä•';
            } else if (field === 'is_occupied') {
                const badge = cell.querySelector('.badge');
                currentValue = badge && badge.textContent.trim() === 'O' ? true : false;
            }
            
            // ÌîåÎ†àÏù¥Ïä§ÌôÄÎçî ÌÖçÏä§Ìä∏ Ï†úÍ±∞ (Ï†ïÌôïÌïú ÌîåÎ†àÏù¥Ïä§ÌôÄÎçî Î¨∏ÏûêÏó¥Îßå Ï†úÍ±∞)
            const placeholderTexts = [
                'Ï†ÑÏÑ∏Í∞Ä ÏûÖÎ†•', 'ÏõîÏÑ∏Î≥¥Ï¶ùÍ∏à ÏûÖÎ†•', 'ÏõîÏÑ∏ ÏûÖÎ†•', 'Îß§Îß§Í∞Ä ÏûÖÎ†•', 
                'Ïó∞ÎùΩÏ≤ò ÏûÖÎ†•', 'Î©îÎ™® ÏûÖÎ†•', 'Ìò∏Ïàò ÏûÖÎ†•', 'Î©¥Ï†Å ÏûÖÎ†•',
                'Ï∏µÏàò ÏûÖÎ†•', 'Î∞©Ìñ• ÏûÖÎ†•', 'Í±¥Ï∂ïÎÖÑÎèÑ ÏûÖÎ†•'
            ];
            if (placeholderTexts.includes(currentValue.trim())) {
                currentValue = '';
            }
            
            cell.classList.add('editing-cell');
            
            if (type === 'select') {
                if (field === 'status') {
                    // ÏÉÅÌÉú ÏÑ†ÌÉù ÎìúÎ°≠Îã§Ïö¥
                    const statusOptions = ['Í±∞ÎûòÍ∞ÄÎä•', 'Í≥ÑÏïΩÏôÑÎ£å', 'Î≥¥Î•ò', 'Î∂ÄÏû¨'];
                    const selector = document.createElement('select');
                    selector.className = 'status-selector';
                    selector.style.cssText = 'width: 100%; padding: 4px; border: 2px solid #3b82f6; border-radius: 4px; background: white; font-size: 12px;';
                    
                    statusOptions.forEach(option => {
                        const optionElement = document.createElement('option');
                        optionElement.value = option;
                        optionElement.textContent = option;
                        if (option === currentValue) {
                            optionElement.selected = true;
                        }
                        selector.appendChild(optionElement);
                    });
                    
                    const updateStatusCell = () => {
                        const selectedValue = selector.value;
                        const statusColors = {
                            'Í±∞ÎûòÍ∞ÄÎä•': { bg: '#e0f2fe', color: '#0369a1' },
                            'Í≥ÑÏïΩÏôÑÎ£å': { bg: '#dcfce7', color: '#16a34a' },
                            'Î≥¥Î•ò': { bg: '#fef3c7', color: '#d97706' },
                            'Î∂ÄÏû¨': { bg: '#fecaca', color: '#dc2626' }
                        };
                        const colors = statusColors[selectedValue] || statusColors['Í±∞ÎûòÍ∞ÄÎä•'];
                        
                        cell.innerHTML = `<span class="badge" style="background: ${colors.bg}; color: ${colors.color}; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">${selectedValue}</span>`;
                        cell.classList.remove('editing-cell');
                        
                        // ÏûêÎèôÏ†ÄÏû• Ïã§Ìñâ
                        autoSaveNewProperty(cell);
                    };
                    
                    selector.addEventListener('change', updateStatusCell);
                    selector.addEventListener('blur', updateStatusCell);
                    
                    cell.innerHTML = '';
                    cell.appendChild(selector);
                    selector.focus();
                    
                } else if (field === 'is_occupied') {
                    // Í±∞Ï£º Ïó¨Î∂Ä ÏÑ†ÌÉù
                    const occupiedOptions = [
                        { value: false, text: 'X', bg: '#fecaca', color: '#dc2626' },
                        { value: true, text: 'O', bg: '#dcfce7', color: '#16a34a' }
                    ];
                    
                    const selector = document.createElement('select');
                    selector.className = 'status-selector';
                    selector.style.cssText = 'width: 100%; padding: 4px; border: 2px solid #3b82f6; border-radius: 4px; background: white; font-size: 12px;';
                    
                    occupiedOptions.forEach(option => {
                        const optionElement = document.createElement('option');
                        optionElement.value = option.value;
                        optionElement.textContent = option.text;
                        if (option.value === currentValue) {
                            optionElement.selected = true;
                        }
                        selector.appendChild(optionElement);
                    });
                    
                    const updateOccupiedCell = () => {
                        const selectedValue = selector.value === 'true';
                        const option = occupiedOptions.find(opt => opt.value === selectedValue);
                        
                        cell.innerHTML = `<span class="badge" style="background: ${option.bg}; color: ${option.color}; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">${option.text}</span>`;
                        cell.classList.remove('editing-cell');
                        
                        // ÏûêÎèôÏ†ÄÏû• Ïã§Ìñâ
                        autoSaveNewProperty(cell);
                    };
                    
                    selector.addEventListener('change', updateOccupiedCell);
                    selector.addEventListener('blur', updateOccupiedCell);
                    
                    cell.innerHTML = '';
                    cell.appendChild(selector);
                    selector.focus();
                }
                        } else {
                // ÏùºÎ∞ò ÏûÖÎ†• ÌïÑÎìú
                const input = document.createElement('input');
                input.type = type === 'date' ? 'date' : (type === 'number' ? 'number' : 'text');
                input.value = currentValue;
                input.style.cssText = 'width: 100%; padding: 4px; border: 2px solid #3b82f6; border-radius: 4px; background: white; font-size: 12px;';
                
                const saveInput = () => {
                    const newValue = input.value;
                    
                    // UI ÏóÖÎç∞Ïù¥Ìä∏
                    if (type === 'number' && newValue) {
                        cell.innerHTML = formatNumber(newValue) + ' ÎßåÏõê';
                        cell.style.color = '#2563eb';
                        cell.style.fontWeight = '500';
                    } else {
                        cell.innerHTML = newValue || '-';
                        if (field === 'building_number' || field === 'room_number') {
                            cell.style.color = '#1a202c';
                        }
                    }
                    
                    cell.classList.remove('editing-cell');
                    
                    // ÏûêÎèôÏ†ÄÏû• Ïã§Ìñâ
                    autoSaveNewProperty(cell);
                };
                
                input.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        saveInput();
                    } else if (e.key === 'Escape') {
                        e.preventDefault();
                        cell.innerHTML = currentValue || '-';
                        cell.classList.remove('editing-cell');
                    }
                });
                
                input.addEventListener('blur', saveInput);
                
                cell.innerHTML = '';
                cell.appendChild(input);
                input.focus();
                if (input.type === 'text') {
                    input.select();
                }
            }
        }




        // ÏÉà Îß§Î¨º Î©îÎ™® Ìé∏Ïßë
        function openNewPropertyMemoModal(cell) {
            const currentMemo = cell.textContent.trim();
            const newMemo = prompt('Î©îÎ™®Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî:', currentMemo === 'Î©îÎ™® ÏûÖÎ†•' ? '' : currentMemo);
            if (newMemo !== null) {
                const row = cell.closest('tr');
                row.dataset.memo = newMemo;
                cell.textContent = newMemo || 'Î©îÎ™® ÏûÖÎ†•';
                cell.style.color = newMemo ? '#1a202c' : '#64748b';
            }
        }

        // ÏÉà Îß§Î¨º Ï¢ãÏïÑÏöî/Ïã´Ïñ¥Ïöî Ìé∏Ïßë
        async function editNewPropertyLikes(element, type) {
            const currentCount = parseInt(element.dataset.count) || 0;
            const newCount = prompt(`${type === 'like' ? 'Ï¢ãÏïÑÏöî' : 'Ïã´Ïñ¥Ïöî'} ÏàòÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî:`, currentCount);
            if (newCount !== null && !isNaN(newCount)) {
                const count = Math.max(0, parseInt(newCount));
                element.dataset.count = count;
                const row = element.closest('tr');
                row.dataset[type === 'like' ? 'likes' : 'dislikes'] = count;
                
                const emoji = type === 'like' ? '‚ù§Ô∏è' : 'üëé';
                element.innerHTML = `<span style="color: ${count > 0 ? '#ef4444' : '#9ca3af'}; font-size: 14px;">${emoji} ${count}</span>`;
                
                // ÏÉàÎß§Î¨ºÏù∏ Í≤ΩÏö∞ ÏûêÎèôÏ†ÄÏû•
                if (row.classList.contains('new-property-row')) {
                    await autoSaveNewProperty(element);
                }
            }
        }
        
        // Í∏∞Ï°¥ Îß§Î¨º Ï¢ãÏïÑÏöî/Ïã´Ïñ¥Ïöî Ìé∏Ïßë
        async function editPropertyLikes(propertyId, field, currentCount, element) {
            console.log('üîÑ Ï¢ãÏïÑÏöî/Ïã´Ïñ¥Ïöî Ìé∏Ïßë ÏãúÏûë:', field, 'propertyId:', propertyId, 'currentCount:', currentCount);
            
            const fieldName = field === 'likes' ? 'Ï¢ãÏïÑÏöî' : 'Ïã´Ïñ¥Ïöî';
            const newCount = prompt(`${fieldName} ÏàòÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî:`, currentCount);
            
            if (newCount !== null && !isNaN(newCount)) {
                const count = Math.max(0, parseInt(newCount));
                element.dataset.count = count;
                
                const emoji = field === 'likes' ? '‚ù§Ô∏è' : 'üëé';
                element.innerHTML = `<span style="color: ${count > 0 ? '#ef4444' : '#9ca3af'}; font-size: 14px;">${emoji} ${count}</span>`;
                
                // ÏÑúÎ≤ÑÏóê Ï†ÄÏû•
                console.log('üíæ ÏÑúÎ≤Ñ Ï†ÄÏû• ÏãúÎèÑ:', { propertyId, field, count });
                try {
                    await updateAdminProperty(propertyId, field, count);
                    console.log('‚úÖ Ï¢ãÏïÑÏöî/Ïã´Ïñ¥Ïöî Ï†ÄÏû• ÏÑ±Í≥µ');
                    alert(`${fieldName}Í∞Ä ${count}Í∞úÎ°ú Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.`);
                } catch (error) {
                    console.error('‚ùå Ï¢ãÏïÑÏöî/Ïã´Ïñ¥Ïöî Ï†ÄÏû• Ïã§Ìå®:', error);
                    alert('Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§: ' + error.message);
                }
            }
        }

        // Î©îÎ™® Î™®Îã¨ Í∏∞Îä•
        function openPropertyMemoModal(propertyId, currentMemo, building, room) {
            const newMemo = prompt(`Îß§Î¨º ${building}Îèô ${room}Ìò∏ Î©îÎ™® Ìé∏Ïßë:`, currentMemo || '');
            if (newMemo !== null) {
                // ÏÑúÎ≤ÑÏóê Î©îÎ™® ÏóÖÎç∞Ïù¥Ìä∏
                updatePropertyMemo(propertyId, newMemo);
            }
        }

        async function updatePropertyMemo(propertyId, memo) {
            try {
                const response = await fetch('/api/maeiple/update', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        id: propertyId,
                        field: 'memo',
                        value: memo
                    })
                });
                
                const result = await response.json();
                if (result.success) {
                    // UIÎßå ÏóÖÎç∞Ïù¥Ìä∏ (ÏàúÏÑú Ïú†ÏßÄÎ•º ÏúÑÌï¥ ÌéòÏù¥ÏßÄ ÏÉàÎ°úÍ≥†Ïπ®ÌïòÏßÄ ÏïäÏùå)
                    console.log('Î©îÎ™® ÏóÖÎç∞Ïù¥Ìä∏ ÏÑ±Í≥µ');
                        } else {
                    alert('Î©îÎ™® Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§: ' + (result.message || result.error));
                }
            } catch (error) {
                console.error('Î©îÎ™® ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìå®:', error);
                alert('Î©îÎ™® Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
            }
        }

        // Ïú†Ìã∏Î¶¨Ìã∞ Ìï®ÏàòÎì§
        function formatNumber(num) {
            if (!num) return '';
            return parseInt(num).toLocaleString();
        }

        function getTeamBadgeColor(team) {
            const colors = {
                '1ÌåÄ': '#e0f2fe',
                '2ÌåÄ': '#fef3c7', 
                '3ÌåÄ': '#d1fae5',
                '4ÌåÄ': '#ede9fe',
                '5ÌåÄ': '#fecaca'
            };
            return colors[team] || '#f1f5f9';
        }

        function getTeamTextColor(team) {
            const colors = {
                '1ÌåÄ': '#0369a1',
                '2ÌåÄ': '#92400e',
                '3ÌåÄ': '#065f46', 
                '4ÌåÄ': '#5b21b6',
                '5ÌåÄ': '#dc2626'
            };
            return colors[team] || '#64748b';
        }

        function showMaeipeError(message) {
            const tableContent = document.getElementById('maeiple-table-content');
            if (tableContent) {
                tableContent.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #ef4444;">
                        <div style="font-size: 48px; margin-bottom: 16px;">‚ö†Ô∏è</div>
                        <p>${message}</p>
                        <button onclick="loadMaeipeProperties(1)" style="margin-top: 16px; padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer;">Îã§Ïãú ÏãúÎèÑ</button>
                    </div>
                `;
            }
        }
        
        function renderTeamMaeipeProperties() {
            const tableContent = document.getElementById('maeiple-table-content-team-leader');
            
            // ÌïÑÌÑ∞ Ï†ÅÏö©
            let list = Array.isArray(teamProperties) ? teamProperties.slice() : [];
            
            // ÌòÑÌô© ÌïÑÌÑ∞
            if (statusFilter !== 'all') {
                list = list.filter(p => (p.status || '') === statusFilter);
            }
            
            // Ïã§Í±∞Ï£º ÌïÑÌÑ∞
            if (occupiedFilter !== 'all') {
                const want = occupiedFilter === 'O';
                list = list.filter(p => !!p.is_occupied === want);
            }
            
            // Í±∞ÎûòÏú†Ìòï ÌïÑÌÑ∞
            if (dealTypeFilterTeamLeader !== 'all') {
                list = list.filter(p => {
                    if (dealTypeFilterTeamLeader === 'Ï†ÑÏÑ∏') {
                        const jeonsePrice = parseInt(String(p.jeonse_price || '0').replace(/[^\\d]/g, '')) || 0;
                        return jeonsePrice > 0;
                    } else if (dealTypeFilterTeamLeader === 'ÏõîÏÑ∏') {
                        const monthlyRent = parseInt(String(p.monthly_rent || '0').replace(/[^\\d]/g, '')) || 0;
                        const monthlyDeposit = parseInt(String(p.monthly_deposit || p.deposit || '0').replace(/[^\\d]/g, '')) || 0;
                        return monthlyRent > 0 || monthlyDeposit > 0;
                    } else if (dealTypeFilterTeamLeader === 'Îß§Îß§') {
                        const salePrice = parseInt(String(p.sale_price || '0').replace(/[^\\d]/g, '')) || 0;
                        return salePrice > 0;
                    }
                    return true;
                });
            }
            
            // Ìò∏Ïàò Í≤ÄÏÉâ ÌïÑÌÑ∞
            if (roomSearchFilterTeamLeader.trim()) {
                const searchTerm = roomSearchFilterTeamLeader.trim().toLowerCase();
                list = list.filter(p => {
                    const roomNumber = String(p.room_number || '').toLowerCase();
                    return roomNumber.includes(searchTerm);
                });
            }
            
            // Îã¥ÎãπÏûê Í≤ÄÏÉâ ÌïÑÌÑ∞
            if (employeeSearchFilterTeamLeader.trim()) {
                const searchTerm = employeeSearchFilterTeamLeader.trim().toLowerCase();
                list = list.filter(p => {
                    const employeeName = String(p.employee_name || '').toLowerCase();
                    return employeeName.includes(searchTerm);
                });
            }
            
            // ÌåÄ ÌïÑÌÑ∞
            if (teamFilterTeamLeader !== 'all') {
                list = list.filter(p => (p.employee_team || '') === teamFilterTeamLeader);
            }
            
            let tableHTML = `
                <table class="employees-table">
                    <thead>
                        <tr>
                            <th>
                                <div style="display: flex; align-items: center; gap: 4px; cursor: pointer; user-select: none;" onclick="toggleTeamSort('check_date')">
                                    ÌôïÏù∏ÎÇ†Ïßú
                                    <span style="font-size: 12px; color: #9ca3af;">${currentTeamSortBy === 'check_date' ? (currentTeamSortOrder === 'desc' ? '‚ñº' : '‚ñ≤') : '‚ÜïÔ∏è'}</span>
                                </div>
                            </th>
                            <th>Îèô</th>
                            <th>Ìò∏Ïàò</th>
                            <th>ÌòÑÌô©</th>
                            <th>Ï†ÑÏÑ∏ (ÎßåÏõê)</th>
                            <th>ÏõîÏÑ∏Î≥¥Ï¶ùÍ∏à (ÎßåÏõê)</th>
                            <th>ÏõîÏÑ∏ (ÎßåÏõê)</th>
                            <th>Îß§Îß§ (ÎßåÏõê)</th>
                            <th>Ïã§Í±∞Ï£º Ïó¨Î∂Ä</th>
                            <th>Ï†ÑÌôîÎ≤àÌò∏</th>
                            <th>ÌäπÏù¥ÏÇ¨Ìï≠</th>
                            <th>Ï¢ãÏïÑÏöî</th>
                            <th>Ïã´Ïñ¥Ïöî</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            if (list.length === 0) {
                tableHTML += `
                    <tr>
                        <td colspan="13" style="text-align: center; padding: 60px 20px; color: #64748b;">
                            <div style="font-size: 48px; margin-bottom: 16px; opacity: 0.5;">üè†</div>
                            <p>Ï°∞Í±¥Ïóê ÎßûÎäî Í∞úÏù∏ Îß§Î¨ºÏù¥ ÏóÜÏäµÎãàÎã§.</p>
                            <p>ÌïÑÌÑ∞Î•º Î≥ÄÍ≤ΩÌïòÍ±∞ÎÇò ÏÉàÎ°úÏö¥ Í∞úÏù∏ Îß§Î¨ºÏùÑ Ï∂îÍ∞ÄÌï¥Î≥¥ÏÑ∏Ïöî.</p>
                        </td>
                    </tr>
                `;
                    } else {
                list.forEach(property => {
                tableHTML += `
                    <tr data-property-id="${property.id}">
                        <td style="cursor: pointer;" onclick="editTeamDate(${property.id}, '${property.check_date || ''}', this)">${property.check_date || '-'}</td>
                        <td style="cursor: pointer;" onclick="editTeamNumber(${property.id}, 'building_number', '${property.building_number || ''}', this)">${property.building_number || '-'}</td>
                        <td style="cursor: pointer;" onclick="editTeamNumber(${property.id}, 'room_number', '${property.room_number || ''}', this)">${property.room_number || '-'}</td>
                        <td>
                            <button style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; ${property.status === 'Í≥ÑÏïΩÏôÑÎ£å' ? 'background: #d1fae5; color: #065f46;' : property.status === 'Î≥¥Î•ò' ? 'background: #fef3c7; color: #92400e;' : property.status === 'Î∂ÄÏû¨' ? 'background: #ede9fe; color: #5b21b6;' : 'background: #e0f2fe; color: #0369a1;'}" 
                                    onclick="showTeamStatusOptions(${property.id}, '${property.status || 'Í±∞ÎûòÍ∞ÄÎä•'}', this)">
                                ${property.status || 'Í±∞ÎûòÍ∞ÄÎä•'}
                            </button>
                        </td>
                        <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editTeamPrice(${property.id}, 'jeonse_price', '${property.jeonse_price || ''}', this)">
                            ${property.jeonse_price ? formatNumber(property.jeonse_price) + ' ÎßåÏõê' : '-'}
                        </td>
                        <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editTeamPrice(${property.id}, 'monthly_deposit', '${property.monthly_deposit || property.deposit || ''}', this)">
                            ${property.monthly_deposit || property.deposit ? formatNumber(property.monthly_deposit || property.deposit) + ' ÎßåÏõê' : '-'}
                        </td>
                        <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editTeamPrice(${property.id}, 'monthly_rent', '${property.monthly_rent || ''}', this)">
                            ${property.monthly_rent ? formatNumber(property.monthly_rent) + ' ÎßåÏõê' : '-'}
                        </td>
                        <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editTeamPrice(${property.id}, 'sale_price', '${property.sale_price || ''}', this)">
                            ${property.sale_price ? formatNumber(property.sale_price) + ' ÎßåÏõê' : '-'}
                        </td>
                        <td>
                            <button style="background: none; border: none; cursor: pointer; font-size: 18px; padding: 4px; border-radius: 4px; color: ${property.is_occupied ? '#059669' : '#dc2626'};" 
                                    onclick="toggleTeamOccupied(${property.id}, ${property.is_occupied})">
                                ${property.is_occupied ? 'O' : 'X'}
                            </button>
                        </td>
                        <td style="cursor: pointer; font-family: monospace; letter-spacing: 0.5px; max-width: 120px; overflow: hidden; text-overflow: ellipsis;" onclick="editTeamPhone(${property.id}, '${property.phone || ''}', this)">
                            ${property.phone || '-'}
                        </td>
                        <td class="memo-cell" onclick="editTeamMemo(${property.id}, '${(property.memo || '').replace(/'/g, "\\'")}', this)" style="color: #64748b; font-style: italic; max-width: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; cursor: pointer;">
                            ${property.memo ? (property.memo.length > 20 ? property.memo.substring(0, 20) + '...' : property.memo) : 'ÌÅ¥Î¶≠ÌïòÏó¨ Î©îÎ™® Ï∂îÍ∞Ä'}
                        </td>
                        <td>
                            <div style="cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; gap: 2px;" onclick="openLikesModal(${property.id}, 'likes', ${property.likes || 0}, this)" data-count="${property.likes || 0}">
                                <span style="color: ${(property.likes || 0) > 0 ? '#ef4444' : '#9ca3af'}; font-size: 14px;">‚ù§Ô∏è ${property.likes || 0}</span>
                            </div>
                        </td>
                        <td>
                            <div style="cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; gap: 2px;" onclick="openLikesModal(${property.id}, 'dislikes', ${property.dislikes || 0}, this)" data-count="${property.dislikes || 0}">
                                <span style="color: ${(property.dislikes || 0) > 0 ? '#ef4444' : '#9ca3af'}; font-size: 14px;">üëé ${property.dislikes || 0}</span>
                            </div>
                        </td>
                    </tr>
                `;
                });
            }
            
            tableHTML += `
                    </tbody>
                </table>
            `;
            
            tableContent.innerHTML = tableHTML;
        }
        
        function renderMaeipePagination() {
            const pagination = document.getElementById('maeiple-pagination');
            if (!pagination || maeipleTotalPages <= 1) {
                if (pagination) pagination.innerHTML = '';
                return;
            }
            
            let paginationHTML = '';
            
            // Ïù¥Ï†Ñ ÌéòÏù¥ÏßÄ Î≤ÑÌäº
            if (currentMaeiplePage > 1) {
                paginationHTML += `<button class="btn btn-outline-primary btn-sm" onclick="loadMaeipeProperties(${currentMaeiplePage - 1})" style="margin-right: 5px;">‚Äπ Ïù¥Ï†Ñ</button>`;
            }
            
            // ÌéòÏù¥ÏßÄ Î≤àÌò∏ Î≤ÑÌäºÎì§
            const startPage = Math.max(1, currentMaeiplePage - 2);
            const endPage = Math.min(maeipleTotalPages, currentMaeiplePage + 2);
            
            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentMaeiplePage;
                paginationHTML += `
                    <button class="btn ${isActive ? 'btn-primary' : 'btn-outline-primary'} btn-sm" 
                            onclick="loadMaeipeProperties(${i})" 
                            style="margin: 0 2px; ${isActive ? 'font-weight: bold;' : ''}">
                        ${i}
                    </button>
                `;
            }
            
            // Îã§Ïùå ÌéòÏù¥ÏßÄ Î≤ÑÌäº
            if (currentMaeiplePage < maeipleTotalPages) {
                paginationHTML += `<button class="btn btn-outline-primary btn-sm" onclick="loadMaeipeProperties(${currentMaeiplePage + 1})" style="margin-left: 5px;">Îã§Ïùå ‚Ä∫</button>`;
            }
            
            // ÌéòÏù¥ÏßÄ Ï†ïÎ≥¥
            paginationHTML += `<span style="margin-left: 15px; color: #64748b; font-size: 14px;">${currentMaeiplePage} / ${maeipleTotalPages} ÌéòÏù¥ÏßÄ</span>`;
            
            pagination.innerHTML = paginationHTML;
        }
        
        function renderTeamMaeipePagination() {
            const pagination = document.getElementById('maeiple-pagination-team-leader');
            if (!pagination || teamMaeipleTotalPages <= 1) {
                if (pagination) pagination.innerHTML = '';
                return;
            }
            
            let paginationHTML = '';
            
            // Ïù¥Ï†Ñ ÌéòÏù¥ÏßÄ Î≤ÑÌäº
            if (currentTeamMaeiplePage > 1) {
                paginationHTML += `<button class="btn btn-outline-primary btn-sm" onclick="loadMaeipePropertiesTeamLeader(${currentTeamMaeiplePage - 1})" style="margin-right: 5px;">‚Äπ Ïù¥Ï†Ñ</button>`;
            }
            
            // ÌéòÏù¥ÏßÄ Î≤àÌò∏ Î≤ÑÌäºÎì§
            const startPage = Math.max(1, currentTeamMaeiplePage - 2);
            const endPage = Math.min(teamMaeipleTotalPages, currentTeamMaeiplePage + 2);
            
            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentTeamMaeiplePage;
                paginationHTML += `
                    <button class="btn ${isActive ? 'btn-primary' : 'btn-outline-primary'} btn-sm" 
                            onclick="loadMaeipePropertiesTeamLeader(${i})" 
                            style="margin: 0 2px; ${isActive ? 'font-weight: bold;' : ''}">
                        ${i}
                    </button>
                `;
            }
            
            // Îã§Ïùå ÌéòÏù¥ÏßÄ Î≤ÑÌäº
            if (currentTeamMaeiplePage < teamMaeipleTotalPages) {
                paginationHTML += `<button class="btn btn-outline-primary btn-sm" onclick="loadMaeipePropertiesTeamLeader(${currentTeamMaeiplePage + 1})" style="margin-left: 5px;">Îã§Ïùå ‚Ä∫</button>`;
            }
            
            // ÌéòÏù¥ÏßÄ Ï†ïÎ≥¥
            paginationHTML += `<span style="margin-left: 15px; color: #64748b; font-size: 14px;">${currentTeamMaeiplePage} / ${teamMaeipleTotalPages} ÌéòÏù¥ÏßÄ</span>`;
            
            pagination.innerHTML = paginationHTML;
        }
        
        function updateAdminFilters() {
            // ÌåÄ ÌïÑÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏ (ÌåÄÏû•ÏùÄ ÏûêÏã†Ïùò ÌåÄÎßå ÌëúÏãú)
            updateTeamFilter();
            // ÌåÄÏû•: ÏûêÏã†Ïùò ÌåÄ Ïô∏ Î≤ÑÌäº ÎπÑÌôúÏÑ±Ìôî
            const currentTeam = '{{ employee_team }}';
            const buttons = document.querySelectorAll('#team-filter-group-admin .filter-btn');
            buttons.forEach(btn => {
                const value = btn.getAttribute('data-value');
                if (value && value !== 'all' && value !== currentTeam) {
                    btn.disabled = true;
                    btn.style.opacity = '0.5';
                    btn.style.cursor = 'not-allowed';
                }
            });
        }
        
        function updateTeamLeaderFilters() {
            // ÌåÄÏû•Ïö© ÌïÑÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏ (ÌåÄÏû•Î©îÏù¥ÌîåÍ¥ÄÎ¶¨ ÌÉ≠)
            updateTeamLeaderFilter();
        }
        
        // ÌåÄ ÌïÑÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏ (ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠Ïö©)
        function updateTeamFilter() {
            const filterGroup = document.getElementById('team-filter-group-admin');
            const filterButtons = filterGroup.querySelector('.filter-buttons');
            
            // ÌòÑÏû¨ ÌåÄÏû•Ïùò ÌåÄ Ï†ïÎ≥¥Îßå ÌëúÏãú
            const teams = [...new Set(properties.map(p => p.employee_team).filter(Boolean))];
            
            filterButtons.innerHTML = '<button class="filter-btn active" data-value="all" onclick="setTeamFilterAdmin(\'all\', this)">Ï†ÑÏ≤¥</button>';
            
            teams.forEach(team => {
                const button = document.createElement('button');
                button.className = 'filter-btn';
                button.setAttribute('data-value', team);
                button.onclick = () => setTeamFilterAdmin(team, button);
                button.textContent = team;
                filterButtons.appendChild(button);
            });
            // Í∏∞Î≥∏Í∞í: ÏûêÏã†Ïùò ÌåÄÏúºÎ°ú ÌïÑÌÑ∞ Ï†ÅÏö©
            const currentTeam = '{{ employee_team }}';
            const selfTeamButton = Array.from(filterButtons.querySelectorAll('.filter-btn')).find(b => b.getAttribute('data-value') === currentTeam);
            if (selfTeamButton) {
                setTeamFilterAdmin(currentTeam, selfTeamButton);
            }
        }
        
        // ÌåÄÏû•Ïö© ÌåÄ ÌïÑÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏ (ÌåÄÏû•Î©îÏù¥ÌîåÍ¥ÄÎ¶¨ ÌÉ≠Ïö©)
        function updateTeamLeaderFilter() {
            const filterGroup = document.getElementById('team-filter-group-team-leader');
            const filterButtons = filterGroup.querySelector('.filter-buttons');
            
            // ÌòÑÏû¨ ÌåÄÏû•Ïùò ÌåÄ Ï†ïÎ≥¥Îßå ÌëúÏãú
            const teams = [...new Set(teamProperties.map(p => p.employee_team).filter(Boolean))];
            
            filterButtons.innerHTML = '<button class="filter-btn active" data-value="all" onclick="setTeamFilterTeamLeader(\'all\', this)">Ï†ÑÏ≤¥</button>';
            
            teams.forEach(team => {
                const button = document.createElement('button');
                button.className = 'filter-btn';
                button.setAttribute('data-value', team);
                button.onclick = () => setTeamFilterTeamLeader(team, button);
                button.textContent = team;
                filterButtons.appendChild(button);
            });
        }
        
        function showMaeipeError(message) {
            const content = document.getElementById('maeiple-table-content');
            content.innerHTML = `<div style="padding: 40px; text-align: center; color: #ef4444;">${message}</div>`;
        }
        
        function showTeamMaeipeError(message) {
            const content = document.getElementById('maeiple-table-content-team-leader');
            content.innerHTML = `<div style="padding: 40px; text-align: center; color: #ef4444;">${message}</div>`;
        }
        
        // ÌåÄÏû• Í∞úÏù∏ Îß§Î¨º Ï∂îÍ∞Ä Ìï®Ïàò (Í∞úÏù∏Îß§Î¨ºÍ¥ÄÎ¶¨ ÌÉ≠Ïö©)
        function addNewPersonalPropertyRow() {
            console.log('üîÑ ÌåÄÏû• Í∞úÏù∏ Îß§Î¨º Ï∂îÍ∞Ä ÏãúÏûë...');
            
            const tbody = document.querySelector('#maeiple-table-content-team-leader table tbody');
            if (!tbody) {
                console.error('‚ùå Í∞úÏù∏Îß§Î¨º ÌÖåÏù¥Î∏î tbodyÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                alert('ÌÖåÏù¥Î∏îÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§. Í∞úÏù∏Îß§Î¨ºÍ¥ÄÎ¶¨ ÌÉ≠Ïù¥ Ï†úÎåÄÎ°ú Î°úÎìúÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.');
                return;
            }
            
            console.log('ÌåÄÏû• ÌÖåÏù¥Î∏î tbody Ï∞æÏùå:', tbody);
            
            // ÌòÑÏû¨ ÎÇ†ÏßúÎ•º Í∏∞Î≥∏Í∞íÏúºÎ°ú ÏÑ§Ï†ï
            const now = new Date();
            now.setHours(now.getHours() + 9);
            const today = now.toISOString().slice(0, 10);
            
            const newRow = document.createElement('tr');
            newRow.className = 'new-team-property-row';
            newRow.innerHTML = `
                <td style="cursor: pointer;" onclick="editTeamDate('new', '${today}', this)">${today}</td>
                <td style="cursor: pointer;" onclick="editTeamNumber('new', 'building_number', '', this)"></td>
                <td style="cursor: pointer;" onclick="editTeamNumber('new', 'room_number', '', this)"></td>
                <td>
                    <button style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; background: #e0f2fe; color: #0369a1;" 
                            onclick="showTeamStatusOptions('new', 'Í±∞ÎûòÍ∞ÄÎä•', this)">
                        Í±∞ÎûòÍ∞ÄÎä•
                    </button>
                </td>
                <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editTeamPrice('new', 'jeonse_price', '', this)">-</td>
                <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editTeamPrice('new', 'monthly_deposit', '', this)">-</td>
                <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editTeamPrice('new', 'monthly_rent', '', this)">-</td>
                <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editTeamPrice('new', 'sale_price', '', this)">-</td>
                <td>
                    <button style="background: none; border: none; cursor: pointer; font-size: 18px; padding: 4px; border-radius: 4px; color: #dc2626;" 
                            onclick="toggleTeamOccupied('new', false)">
                        X
                    </button>
                </td>
                <td style="cursor: pointer; font-family: monospace; letter-spacing: 0.5px;" onclick="editTeamPhone('new', '', this)">-</td>
                <td style="cursor: pointer; font-size: 12px; color: #64748b;" onclick="editTeamMemo('new', '', this)">ÌÅ¥Î¶≠ÌïòÏó¨ Î©îÎ™® Ï∂îÍ∞Ä</td>
                <td>
                    <div style="cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; gap: 2px;" onclick="openLikesModal('new', 'likes', 0, this)" data-count="0">
                        <span style="color: #9ca3af; font-size: 14px;">‚ù§Ô∏è 0</span>
                    </div>
                </td>
                <td>
                    <div style="cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; gap: 2px;" onclick="openLikesModal('new', 'dislikes', 0, this)" data-count="0">
                        <span style="color: #9ca3af; font-size: 14px;">üëé 0</span>
                    </div>
                </td>
            `;
            
            tbody.insertBefore(newRow, tbody.firstChild);
            console.log('ÏÉà ÌåÄÏû• Îß§Î¨º ÌñâÏù¥ ÌÖåÏù¥Î∏îÏóê Ï∂îÍ∞ÄÎê®');
            
            console.log('ÏÉà ÌåÄÏû• Îß§Î¨º Ìñâ Ï∂îÍ∞Ä ÏôÑÎ£å - ÏõêÌïòÎäî ÏÖÄÏùÑ ÌÅ¥Î¶≠ÌïòÏó¨ Ìé∏ÏßëÌïòÏÑ∏Ïöî');
            alert('ÏÉà Îß§Î¨º ÌñâÏù¥ Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§. ÏÖÄÏùÑ Ìé∏ÏßëÌïòÎ©¥ ÏûêÎèôÏúºÎ°ú Ï†ÄÏû•Îê©ÎãàÎã§.');
        }

        // ÌåÄÏû•Ïö© Îß§Î¨º ÏûêÎèôÏ†ÄÏû• Ìï®Ïàò
        async function autoSaveNewTeamProperty(cell) {
            const row = cell.closest('tr');
            if (!row || !row.classList.contains('new-team-property-row')) {
                return; // ÏÉà Îß§Î¨º ÌñâÏù¥ ÏïÑÎãàÎ©¥ Ï†ÄÏû•ÌïòÏßÄ ÏïäÏùå
            }
            
            console.log('üîÑ ÌåÄÏû• ÏÉà Îß§Î¨º ÏûêÎèôÏ†ÄÏû• ÏãúÏûë...');
            
            // ÌñâÏùò Î™®Îì† Îç∞Ïù¥ÌÑ∞ ÏàòÏßë
            const cells = row.cells;
            const currentEmployeeName = '{{ employee_name }}';
            const newProperty = {
                check_date: cells[0].textContent.trim(),
                building_number: cells[1].textContent.trim(),
                room_number: cells[2].textContent.trim(),
                status: cells[3].querySelector('button').textContent.trim(),
                jeonse_price: extractNumber(cells[4].textContent),
                monthly_deposit: extractNumber(cells[5].textContent),
                monthly_rent: extractNumber(cells[6].textContent),
                sale_price: extractNumber(cells[7].textContent),
                is_occupied: cells[8].querySelector('button').textContent.trim() === 'O',
                phone: cells[9].textContent.trim() === '-' ? '' : cells[9].textContent.trim(),
                memo: cells[10].textContent.trim() === 'ÌÅ¥Î¶≠ÌïòÏó¨ Î©îÎ™® Ï∂îÍ∞Ä' ? '' : cells[10].textContent.trim(),
                employee_name: currentEmployeeName
            };
            
            console.log('ÌåÄÏû• ÏÉà Îß§Î¨º Ï†ÄÏû• Îç∞Ïù¥ÌÑ∞:', newProperty);
            
            try {
                const response = await fetch('/api/maeiple', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(newProperty)
                });
                
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`HTTP ${response.status}: ${errorText}`);
                }
                
                const result = await response.json();
                
                if (result && result.success === true) {
                    console.log('‚úÖ ÌåÄÏû• ÏÉà Îß§Î¨º ÏûêÎèôÏ†ÄÏû• ÏÑ±Í≥µ:', result);
                    
                    // ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ÄÏû•Îêú Í≤ΩÏö∞ ÏÉà ÌñâÏùÑ Ï†úÍ±∞ÌïòÍ≥† ÌåÄÏû• ÌÖåÏù¥Î∏îÏóê Ï∂îÍ∞Ä
                    if (result.created_property) {
                        await addNewTeamPropertyToTable(result.created_property);
                        row.remove();
                        
                        // ÏÑ±Í≥µ Î©îÏãúÏßÄ ÌëúÏãú
                        alert('Îß§Î¨ºÏù¥ ÏûêÎèôÏúºÎ°ú Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.');
                    }
                } else {
                    const errorMsg = result?.error || result?.message || 'ÏûêÎèôÏ†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.';
                    console.warn('ÌåÄÏû• ÏûêÎèôÏ†ÄÏû• Ïã§Ìå®:', errorMsg);
                }
                
            } catch (error) {
                console.error('ÌåÄÏû• Îß§Î¨º ÏûêÎèôÏ†ÄÏû• Ïò§Î•ò:', error);
                // Ïò§Î•òÍ∞Ä Î∞úÏÉùÌï¥ÎèÑ ÏÇ¨Ïö©ÏûêÏóêÍ≤åÎäî ÏïåÎ¶¨ÏßÄ ÏïäÏùå (ÏûêÎèôÏ†ÄÏû•Ïù¥ÎØÄÎ°ú)
            }
        }

        // ÏÉàÎ°ú Ï∂îÍ∞ÄÎêú ÌåÄÏû• Îß§Î¨ºÏùÑ ÌÖåÏù¥Î∏îÏóê Ï¶âÏãú ÌëúÏãú
        async function addNewTeamPropertyToTable(property) {
            console.log('üîÑ ÏÉà ÌåÄÏû• Îß§Î¨ºÏùÑ ÌÖåÏù¥Î∏îÏóê Ï¶âÏãú Ï∂îÍ∞Ä:', property);
            
            const tbody = document.querySelector('#maeiple-table-content-team-leader table tbody');
            if (!tbody) {
                console.error('ÌåÄÏû• Îß§Î¨º ÌÖåÏù¥Î∏î tbodyÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            // ÏÉà Ìñâ ÏÉùÏÑ±
            const newRow = document.createElement('tr');
            newRow.className = 'property-row';
            newRow.dataset.propertyId = property.id;
            
            // ÏÉÅÌÉúÏóê Îî∞Î•∏ Î∞∞ÏßÄ ÏÉâÏÉÅ ÏÑ§Ï†ï
            const statusBadge = getTeamStatusBadge(property.status);
            const occupiedBadge = getTeamOccupiedBadge(property.is_occupied);
            
            newRow.innerHTML = `
                <td style="cursor: pointer;" onclick="editTeamDate(${property.id}, '${property.check_date || ''}', this)">${property.check_date || ''}</td>
                <td style="cursor: pointer;" onclick="editTeamNumber(${property.id}, 'building_number', '${property.building_number || ''}', this)">${property.building_number || ''}</td>
                <td style="cursor: pointer;" onclick="editTeamNumber(${property.id}, 'room_number', '${property.room_number || ''}', this)">${property.room_number || ''}</td>
                <td>
                    <button style="${statusBadge}" 
                            onclick="showTeamStatusOptions(${property.id}, '${property.status || 'Í±∞ÎûòÍ∞ÄÎä•'}', this)">
                        ${property.status || 'Í±∞ÎûòÍ∞ÄÎä•'}
                    </button>
                </td>
                <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editTeamPrice(${property.id}, 'jeonse_price', '${property.jeonse_price || ''}', this)">
                    ${property.jeonse_price ? formatNumber(property.jeonse_price) + ' ÎßåÏõê' : '-'}
                </td>
                <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editTeamPrice(${property.id}, 'monthly_deposit', '${property.monthly_deposit || ''}', this)">
                    ${property.monthly_deposit ? formatNumber(property.monthly_deposit) + ' ÎßåÏõê' : '-'}
                </td>
                <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editTeamPrice(${property.id}, 'monthly_rent', '${property.monthly_rent || ''}', this)">
                    ${property.monthly_rent ? formatNumber(property.monthly_rent) + ' ÎßåÏõê' : '-'}
                </td>
                <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editTeamPrice(${property.id}, 'sale_price', '${property.sale_price || ''}', this)">
                    ${property.sale_price ? formatNumber(property.sale_price) + ' ÎßåÏõê' : '-'}
                </td>
                <td>
                    <button style="${occupiedBadge}" 
                            onclick="toggleTeamOccupied(${property.id}, ${property.is_occupied})">
                        ${property.is_occupied ? 'O' : 'X'}
                    </button>
                </td>
                <td style="cursor: pointer; font-family: monospace; letter-spacing: 0.5px;" onclick="editTeamPhone(${property.id}, '${property.phone || ''}', this)">
                    ${property.phone ? formatPhoneNumber(property.phone) : '-'}
                </td>
                <td style="cursor: pointer; font-size: 12px; color: #64748b;" onclick="editTeamMemo(${property.id}, '${property.memo || ''}', this)">
                    ${property.memo || 'ÌÅ¥Î¶≠ÌïòÏó¨ Î©îÎ™® Ï∂îÍ∞Ä'}
                </td>
                <td>
                    <div style="cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; gap: 2px;" onclick="openLikesModal(${property.id}, 'likes', ${property.likes || 0}, this)" data-count="${property.likes || 0}">
                        <span style="color: ${(property.likes || 0) > 0 ? '#ef4444' : '#9ca3af'}; font-size: 14px;">‚ù§Ô∏è ${property.likes || 0}</span>
                    </div>
                </td>
                <td>
                    <div style="cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; gap: 2px;" onclick="openLikesModal(${property.id}, 'dislikes', ${property.dislikes || 0}, this)" data-count="${property.dislikes || 0}">
                        <span style="color: ${(property.dislikes || 0) > 0 ? '#ef4444' : '#9ca3af'}; font-size: 14px;">üëé ${property.dislikes || 0}</span>
                    </div>
                </td>
            `;
            
            tbody.insertBefore(newRow, tbody.firstChild);
            
            // ÏÉàÎ°ú Ï∂îÍ∞ÄÎêú ÌñâÏóê ÌïòÏù¥ÎùºÏù¥Ìä∏ Ìö®Í≥º Ï†ÅÏö©
            newRow.style.backgroundColor = '#f0f9ff';
            newRow.style.transition = 'background-color 0.5s ease';
            
            setTimeout(() => {
                newRow.style.backgroundColor = '';
            }, 2000);
            
            console.log('‚úÖ ÏÉà ÌåÄÏû• Îß§Î¨ºÏù¥ ÌÖåÏù¥Î∏îÏóê Ï¶âÏãú Ï∂îÍ∞ÄÎê®');
        }

        // Ïú†Ìã∏Î¶¨Ìã∞ Ìï®ÏàòÎì§ (Í¥ÄÎ¶¨Ïûê Ìå®ÎÑêÏóêÏÑú Ïù¥Ïãù)
        function formatNumber(num) {
            if (!num) return '';
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }
        
        function getTeamBadgeColor(team) {
            const colors = {
                'ÎπàÏãúÌä∏': '#e0f2fe',
                'ÌåÄA': '#fef3c7', 
                'ÌåÄB': '#e0e7ff',
                'ÌåÄC': '#f0fdf4',
                'ÌåÄD': '#fce7f3'
            };
            return colors[team] || '#f1f5f9';
        }
        
        function getTeamTextColor(team) {
            const colors = {
                'ÎπàÏãúÌä∏': '#0369a1',
                'ÌåÄA': '#92400e',
                'ÌåÄB': '#3730a3', 
                'ÌåÄC': '#166534',
                'ÌåÄD': '#be185d'
            };
            return colors[team] || '#64748b';
        }
        
        // ÌåÄÏû•Ïö© Îß§Î¨º ÏàòÏ†ï Í∏∞Îä•Îì§
        
        // ÌåÄÏû•Ïö© ÎÇ†Ïßú Ìé∏Ïßë
        function editTeamDate(propertyId, currentDate, cell) {
            if (cell.querySelector('input')) return; // Ïù¥ÎØ∏ Ìé∏Ïßë Ï§ëÏù¥Î©¥ Î¶¨ÌÑ¥
            
            const input = document.createElement('input');
            input.type = 'date';
            input.value = currentDate;
            input.className = 'team-edit-input';
            input.style.cssText = 'width: 100%; padding: 4px; border: 1px solid #ccc; border-radius: 4px;';

                cell.innerHTML = '';
                cell.appendChild(input);
                input.focus();
                
            input.onblur = async function() {
                const newValue = input.value;
                cell.textContent = newValue;
                
                if (propertyId === 'new') {
                    // ÏÉà Îß§Î¨ºÏùò Í≤ΩÏö∞ ÏûêÎèôÏ†ÄÏû• ÏãúÎèÑ
                    await autoSaveNewTeamProperty(cell);
                } else {
                    // Í∏∞Ï°¥ Îß§Î¨º ÏóÖÎç∞Ïù¥Ìä∏
                    await updateTeamProperty(propertyId, 'check_date', newValue);
                }
            };
            
            input.onkeypress = function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    input.blur();
                    // Îã§Ïùå Ìé∏Ïßë Í∞ÄÎä•Ìïú ÏÖÄÎ°ú Ïù¥Îèô
                    const nextCell = cell.nextElementSibling;
                    if (nextCell && nextCell.onclick) {
                        nextCell.click();
                    }
                }
            };
        }
        
        // ÌåÄÏû•Ïö© Ìò∏Ïàò/Îèô Î≤àÌò∏ Ìé∏Ïßë
        function editTeamNumber(propertyId, field, currentValue, cell) {
            if (cell.querySelector('input')) return;
            
            const input = document.createElement('input');
            input.type = 'text';
            input.value = currentValue;
            input.className = 'team-edit-input';
            input.style.cssText = 'width: 100%; padding: 4px; border: 1px solid #ccc; border-radius: 4px;';
            input.placeholder = field === 'building_number' ? 'Îèô Î≤àÌò∏' : 'Ìò∏Ïàò';
            
            cell.innerHTML = '';
            cell.appendChild(input);
            input.focus();
            
            input.onblur = async function() {
                const newValue = input.value;
                cell.textContent = newValue;
                
                if (propertyId === 'new') {
                    await autoSaveNewTeamProperty(cell);
                } else {
                    await updateTeamProperty(propertyId, field, newValue);
                }
            };
            
            input.onkeypress = function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    input.blur();
                    // Îã§Ïùå Ìé∏Ïßë Í∞ÄÎä•Ìïú ÏÖÄÎ°ú Ïù¥Îèô
                    const nextCell = cell.nextElementSibling;
                    if (nextCell && nextCell.onclick) {
                        nextCell.click();
                    }
                }
            };
        }
        
        // ÌåÄÏû•Ïö© Í∞ÄÍ≤© Ìé∏Ïßë
        function editTeamPrice(propertyId, field, currentValue, cell) {
            if (cell.querySelector('input')) return;
            
            const input = document.createElement('input');
            input.type = 'text';
            input.value = extractNumber(currentValue) || '';
            input.className = 'team-edit-input';
            input.style.cssText = 'width: 100%; padding: 4px; border: 1px solid #ccc; border-radius: 4px;';
            input.placeholder = 'Í∞ÄÍ≤© (ÎßåÏõê)';
            
            cell.innerHTML = '';
            cell.appendChild(input);
            input.focus();
            
            input.onblur = async function() {
                const newValue = input.value;
                const displayValue = newValue ? formatNumber(newValue) + ' ÎßåÏõê' : '-';
                cell.innerHTML = `<span style="cursor: pointer; color: #2563eb; font-weight: 500;">${displayValue}</span>`;
                
                if (propertyId === 'new') {
                    await autoSaveNewTeamProperty(cell);
                } else {
                    await updateTeamProperty(propertyId, field, newValue);
                }
            };
            
            input.onkeypress = function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    input.blur();
                    // Îã§Ïùå Ìé∏Ïßë Í∞ÄÎä•Ìïú ÏÖÄÎ°ú Ïù¥Îèô
                    const nextCell = cell.nextElementSibling;
                    if (nextCell && nextCell.onclick) {
                        nextCell.click();
                    }
                }
            };
        }
        
        // ÌåÄÏû•Ïö© Ï†ÑÌôîÎ≤àÌò∏ Ìé∏Ïßë
        function editTeamPhone(propertyId, currentValue, cell) {
            if (cell.querySelector('input')) return;
            
            const input = document.createElement('input');
            input.type = 'tel';
            input.value = currentValue === '-' ? '' : currentValue;
            input.className = 'team-edit-input';
            input.style.cssText = 'width: 100%; padding: 4px; border: 1px solid #ccc; border-radius: 4px; font-family: monospace;';
            input.placeholder = 'Ï†ÑÌôîÎ≤àÌò∏';
            
            cell.innerHTML = '';
            cell.appendChild(input);
            input.focus();
            
            input.onblur = async function() {
                const newValue = input.value || '-';
                cell.textContent = newValue === '-' ? '-' : formatPhoneNumber(newValue);
                
                if (propertyId === 'new') {
                    await autoSaveNewTeamProperty(cell);
                } else {
                    await updateTeamProperty(propertyId, 'phone', newValue === '-' ? '' : newValue);
                }
            };
            
            input.onkeypress = function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    input.blur();
                    // Îã§Ïùå Ìé∏Ïßë Í∞ÄÎä•Ìïú ÏÖÄÎ°ú Ïù¥Îèô
                    const nextCell = cell.nextElementSibling;
                    if (nextCell && nextCell.onclick) {
                        nextCell.click();
                    }
                }
            };
        }
        
        // ÌåÄÏû•Ïö© Î©îÎ™® Ìé∏Ïßë (Î™®Îã¨ Î∞©Ïãù)
        function editTeamMemo(propertyId, currentValue, cell) {
            // Îß§Î¨º Ï†ïÎ≥¥ Ï∂îÏ∂ú
            const row = cell.closest('tr');
            const buildingCell = row.cells[1]; // Îèô Î≤àÌò∏ (ÌåÄÏû•Î©îÏù¥ÌîåÍ¥ÄÎ¶¨ ÌÉ≠ÏùÄ Ï≤¥ÌÅ¨Î∞ïÏä§Í∞Ä ÏóÜÏúºÎØÄÎ°ú Ïù∏Îç±Ïä§ 1)
            const roomCell = row.cells[2]; // Ìò∏Ïàò
            const buildingNumber = buildingCell ? buildingCell.textContent.trim() : '';
            const roomNumber = roomCell ? roomCell.textContent.trim() : '';
            
            if (propertyId === 'new') {
                // ÏÉà Îß§Î¨ºÏù∏ Í≤ΩÏö∞ ÏÉà Îß§Î¨º Î™®Îã¨ Ìï®Ïàò ÏÇ¨Ïö©
                openNewPropertyMemoModal(cell);
            } else {
                // Í∏∞Ï°¥ Îß§Î¨ºÏù∏ Í≤ΩÏö∞ Í∏∞Ï°¥ Îß§Î¨º Î™®Îã¨ Ìï®Ïàò ÏÇ¨Ïö©
                openPropertyMemoModal(propertyId, currentValue, buildingNumber, roomNumber);
            }
        }
        
        // ÌåÄÏû•Ïö© ÏÉÅÌÉú Î≥ÄÍ≤Ω
        function showTeamStatusOptions(propertyId, currentStatus, button) {
            const options = ['Í±∞ÎûòÍ∞ÄÎä•', 'Í≥ÑÏïΩÏôÑÎ£å', 'Î≥¥Î•ò', 'Î∂ÄÏû¨'];
            
            // Í∏∞Ï°¥ ÏòµÏÖò Î©îÎâ¥Í∞Ä ÏûàÎã§Î©¥ Ï†úÍ±∞
            const existingMenu = document.querySelector('.team-status-menu');
            if (existingMenu) {
                existingMenu.remove();
                return;
            }
            
            const menu = document.createElement('div');
            menu.className = 'team-status-menu';
            menu.style.cssText = `
                position: absolute;
                background: white;
                border: 1px solid #e2e8f0;
                border-radius: 6px;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
                z-index: 1000;
                min-width: 100px;
            `;
            
            options.forEach(status => {
                const option = document.createElement('button');
                option.textContent = status;
                option.style.cssText = `
                    width: 100%;
                    padding: 8px 12px;
                    border: none;
                    background: ${status === currentStatus ? '#f1f5f9' : 'transparent'};
                    text-align: left;
                    cursor: pointer;
                    font-size: 12px;
                `;
                
                option.onmouseenter = () => option.style.background = '#f1f5f9';
                option.onmouseleave = () => option.style.background = status === currentStatus ? '#f1f5f9' : 'transparent';
                
                option.onclick = async () => {
                    button.textContent = status;
                    button.style.cssText = getTeamStatusBadge(status);
                    menu.remove();
                    
                    if (propertyId === 'new') {
                        await autoSaveNewTeamProperty(button.closest('td'));
                    } else {
                        await updateTeamProperty(propertyId, 'status', status);
                    }
                };
                
                menu.appendChild(option);
            });
            
            // Î©îÎâ¥ ÏúÑÏπò ÏÑ§Ï†ï
            const rect = button.getBoundingClientRect();
            menu.style.left = rect.left + 'px';
            menu.style.top = (rect.bottom + window.scrollY) + 'px';
            
            document.body.appendChild(menu);
            
            // Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Î©îÎâ¥ Îã´Í∏∞
            setTimeout(() => {
                document.addEventListener('click', function closeMenu(e) {
                    if (!menu.contains(e.target)) {
                        menu.remove();
                        document.removeEventListener('click', closeMenu);
                    }
                });
            }, 0);
        }
        
        // ÌåÄÏû•Ïö© Í±∞Ï£º ÏÉÅÌÉú ÌÜ†Í∏Ä
        async function toggleTeamOccupied(propertyId, currentState) {
            const newState = !currentState;
            
            // UI Ï¶âÏãú ÏóÖÎç∞Ïù¥Ìä∏
            const button = event.target;
            button.textContent = newState ? 'O' : 'X';
            button.style.cssText = getTeamOccupiedBadge(newState);
            
            if (propertyId === 'new') {
                await autoSaveNewTeamProperty(button.closest('td'));
            } else {
                await updateTeamProperty(propertyId, 'is_occupied', newState);
            }
        }
        
        // ÌåÄÏû•Ïö© Îß§Î¨º ÏóÖÎç∞Ïù¥Ìä∏ (Í¥ÄÎ¶¨ÏûêÏôÄ ÎèôÏùºÌïú Î∞©Ïãù)
        async function updateTeamProperty(propertyId, field, value) {
            console.log('üîÑ updateTeamProperty Ìò∏Ï∂ú:', { propertyId, field, value });
            try {
                const requestData = {
                    id: propertyId,
                    field: field,
                    value: value
                };
                console.log('üì§ ÌåÄÏû• API ÏöîÏ≤≠ Îç∞Ïù¥ÌÑ∞:', requestData);
                
                const response = await fetch('/api/maeiple/update', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestData)
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const result = await response.json();
                
                if (!result.success) {
                    throw new Error(result.error || 'ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìå®');
                }
                
                console.log('ÌåÄÏû• Îß§Î¨º ÏóÖÎç∞Ïù¥Ìä∏ ÏÑ±Í≥µ:', field, value);
                
                // Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ÎèÑ ÏóÖÎç∞Ïù¥Ìä∏ÌïòÏó¨ ÏàúÏÑú Ïú†ÏßÄ
                const teamProperty = teamProperties.find(p => p.id === propertyId);
                if (teamProperty) {
                    teamProperty[field] = value;
                }
                
            } catch (error) {
                console.error('ÌåÄÏû• Îß§Î¨º ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìå®:', error);
                alert('ÏàòÏ†ï Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
            }
        }
        
        // ÌåÄÏû•Ïö© ÏÉÅÌÉú Î∞∞ÏßÄ ÏÉùÏÑ±
        function getTeamStatusBadge(status) {
            const styles = {
                'Í±∞ÎûòÍ∞ÄÎä•': 'padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; background: #e0f2fe; color: #0369a1;',
                'Í±∞ÎûòÏ§ë': 'padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; background: #fef3c7; color: #92400e;',
                'Í≥ÑÏïΩÏôÑÎ£å': 'padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; background: #d1fae5; color: #065f46;',
                'Î≥¥Î•ò': 'padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; background: #fecaca; color: #dc2626;',
                'Î∂ÄÏû¨': 'padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; background: #ede9fe; color: #5b21b6;'
            };
            return styles[status] || styles['Í±∞ÎûòÍ∞ÄÎä•'];
        }
        
        // ÌåÄÏû•Ïö© Í±∞Ï£º ÏÉÅÌÉú Î∞∞ÏßÄ ÏÉùÏÑ±
        function getTeamOccupiedBadge(isOccupied) {
            return `background: none; border: none; cursor: pointer; font-size: 18px; padding: 4px; border-radius: 4px; color: ${isOccupied ? '#059669' : '#dc2626'};`;
        }
        
        // Ïà´Ïûê Ï∂îÏ∂ú Ìó¨Ìçº Ìï®Ïàò
        function extractNumber(text) {
            if (!text) return '';
            return text.toString().replace(/[^\d]/g, '');
        }
        
        // Ï†ïÎ†¨ Í∏∞Îä•
        async function toggleSort(field) {
            if (currentSortBy === field) {
                currentSortOrder = currentSortOrder === 'desc' ? 'asc' : 'desc';
            } else {
                currentSortBy = field;
                currentSortOrder = 'desc';
            }
            await loadMaeipeProperties(currentMaeiplePage);
        }

        // ÌåÄÏû• Í∞úÏù∏Îß§Î¨ºÍ¥ÄÎ¶¨ Ï†ïÎ†¨ ÌÜ†Í∏Ä Ìï®Ïàò
        async function toggleTeamSort(field) {
            if (currentTeamSortBy === field) {
                currentTeamSortOrder = currentTeamSortOrder === 'desc' ? 'asc' : 'desc';
            } else {
                currentTeamSortBy = field;
                currentTeamSortOrder = 'desc';
            }
            await loadMaeipePropertiesTeamLeader(currentTeamMaeiplePage);
        }

        // ==================== Ï¢ãÏïÑÏöî/Ïã´Ïñ¥Ïöî Î™®Îã¨ Í¥ÄÎ†® Ìï®ÏàòÎì§ ====================
        
        // Ï¢ãÏïÑÏöî/Ïã´Ïñ¥Ïöî Î™®Îã¨ Ïó¥Í∏∞
        function openLikesModal(propertyId, type, currentCount, element) {
            const modal = document.getElementById('likes-modal');
            const title = document.getElementById('likes-modal-title');
            const propertyInfo = document.getElementById('likes-property-info');
            const inputLabel = document.getElementById('likes-input-label');
            const input = document.getElementById('likes-input');
            
            // Îß§Î¨º Ï†ïÎ≥¥ Ï∂îÏ∂ú
            const row = element.closest('tr');
            const buildingCell = row.cells[2]; // Îèô Î≤àÌò∏
            const roomCell = row.cells[3]; // Ìò∏Ïàò
            const buildingNumber = buildingCell ? buildingCell.textContent.trim() : '';
            const roomNumber = roomCell ? roomCell.textContent.trim() : '';
            const propertyDisplay = `${buildingNumber || 'Îèô'}${roomNumber ? '-' + roomNumber + 'Ìò∏' : ''}`;
            
            // Î™®Îã¨ ÎÇ¥Ïö© ÏÑ§Ï†ï
            const isLikes = type === 'likes';
            title.textContent = isLikes ? '‚ù§Ô∏è Ï¢ãÏïÑÏöî Ìé∏Ïßë' : 'üëé Ïã´Ïñ¥Ïöî Ìé∏Ïßë';
            propertyInfo.textContent = propertyDisplay;
            inputLabel.textContent = isLikes ? 'Ï¢ãÏïÑÏöî Ïàò:' : 'Ïã´Ïñ¥Ïöî Ïàò:';
            input.value = currentCount || 0;
            
            // Î™®Îã¨ ÌëúÏãú
            modal.classList.add('active');
            
            // Ìè¨Ïª§Ïä§ ÏÑ§Ï†ï Î∞è ÌÇ§Î≥¥Îìú Ïù¥Î≤§Ìä∏
            setTimeout(() => {
                input.focus();
                    input.select();
            }, 100);
            
            // Enter ÌÇ§Î°ú Ï†ÄÏû•
            input.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    saveLikes();
                } else if (e.key === 'Escape') {
                    e.preventDefault();
                    closeLikesModal();
                }
            });
            
            // Ï†ÑÏó≠ Î≥ÄÏàòÏóê ÌòÑÏû¨ Ìé∏Ïßë Ï§ëÏù∏ Ï†ïÎ≥¥ Ï†ÄÏû•
            window.currentLikesEdit = {
                propertyId: propertyId,
                type: type,
                element: element
            };
        }
        
        // Ï¢ãÏïÑÏöî/Ïã´Ïñ¥Ïöî Î™®Îã¨ Îã´Í∏∞
        function closeLikesModal() {
            const modal = document.getElementById('likes-modal');
            modal.classList.remove('active');
            window.currentLikesEdit = null;
        }
        
        // Ï¢ãÏïÑÏöî/Ïã´Ïñ¥Ïöî Ï†ÄÏû•
        async function saveLikes() {
            const input = document.getElementById('likes-input');
            const count = parseInt(input.value) || 0;
            
            if (!window.currentLikesEdit) {
                alert('Ïò§Î•ò: Ìé∏Ïßë Ï†ïÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            const { propertyId, type, element } = window.currentLikesEdit;
            
            try {
                // ÏÉà Îß§Î¨ºÏù∏ Í≤ΩÏö∞
                if (propertyId === 'new') {
                    // UI Ï¶âÏãú ÏóÖÎç∞Ïù¥Ìä∏
                    const emoji = type === 'likes' ? '‚ù§Ô∏è' : 'üëé';
                    element.dataset.count = count;
                    element.innerHTML = `<span style="color: ${count > 0 ? '#ef4444' : '#9ca3af'}; font-size: 14px;">${emoji} ${count}</span>`;
                    
                    // ÏÉà Îß§Î¨º ÌñâÏóê Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                    const row = element.closest('tr');
                    row.dataset[type] = count;
                    
                    // ÏûêÎèôÏ†ÄÏû• Ïã§Ìñâ
                    if (row.classList.contains('new-property-row')) {
                        autoSaveNewProperty(element);
                    } else if (row.classList.contains('new-team-property-row')) {
                        autoSaveNewTeamProperty(element);
                    }
                    
                    closeLikesModal();
                    return;
                }
                
                // Í∏∞Ï°¥ Îß§Î¨ºÏù∏ Í≤ΩÏö∞ - ÏÑúÎ≤ÑÏóê Ï†ÄÏû•
                const response = await fetch('/api/maeiple/update', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        id: propertyId,
                        field: type,
                        value: count
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // UI ÏóÖÎç∞Ïù¥Ìä∏
                    const emoji = type === 'likes' ? '‚ù§Ô∏è' : 'üëé';
                    element.dataset.count = count;
                    element.innerHTML = `<span style="color: ${count > 0 ? '#ef4444' : '#9ca3af'}; font-size: 14px;">${emoji} ${count}</span>`;
                    
                    closeLikesModal();
                    alert(`${type === 'likes' ? 'Ï¢ãÏïÑÏöî' : 'Ïã´Ïñ¥Ïöî'}Í∞Ä ${count}Í∞úÎ°ú Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.`);
                    } else {
                    alert('Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§: ' + result.error);
                }
            } catch (error) {
                console.error('Ï¢ãÏïÑÏöî/Ïã´Ïñ¥Ïöî Ï†ÄÏû• Ïò§Î•ò:', error);
                alert('Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
            }
        }

        // ==================== Î©îÎ™® Î™®Îã¨ Í¥ÄÎ†® Ìï®ÏàòÎì§ ====================
        
        // ÏÉà Îß§Î¨º Î©îÎ™® Î™®Îã¨ Ïó¥Í∏∞
        function openNewPropertyMemoModal(cell) {
            const modal = document.getElementById('property-memo-modal');
            const textarea = document.getElementById('property-memo-textarea');
            const propertyInfo = document.getElementById('property-memo-info');
            
            // Îß§Î¨º Ï†ïÎ≥¥ ÌëúÏãú (ÏÉà Îß§Î¨º)
            propertyInfo.textContent = 'ÏÉà Îß§Î¨º';
            
            // ÌòÑÏû¨ Î©îÎ™® ÎÇ¥Ïö© ÏÑ§Ï†ï
            const currentMemo = cell.textContent.trim() === 'Î©îÎ™® ÏûÖÎ†•' ? '' : cell.textContent.trim();
            textarea.value = currentMemo;
            
            // Î™®Îã¨ ÌëúÏãú
            modal.classList.add('active');
            
            // Ìè¨Ïª§Ïä§ ÏÑ§Ï†ï
            setTimeout(() => {
                textarea.focus();
            }, 100);
            
            // Ï†ÑÏó≠ Î≥ÄÏàòÏóê ÌòÑÏû¨ Ìé∏Ïßë Ï§ëÏù∏ ÏÖÄ Ï†ÄÏû•
            window.currentMemoCell = cell;
        }

        // Í∏∞Ï°¥ Îß§Î¨º Î©îÎ™® Î™®Îã¨ Ïó¥Í∏∞
        function openPropertyMemoModal(propertyId, currentMemo, buildingNumber, roomNumber) {
            const modal = document.getElementById('property-memo-modal');
            const textarea = document.getElementById('property-memo-textarea');
            const propertyInfo = document.getElementById('property-memo-info');
            
            // Îß§Î¨º Ï†ïÎ≥¥ ÌëúÏãú
            const propertyDisplay = `${buildingNumber || 'Îèô'}${roomNumber ? '-' + roomNumber + 'Ìò∏' : ''}`;
            propertyInfo.textContent = propertyDisplay;
            
            // ÌòÑÏû¨ Î©îÎ™® ÎÇ¥Ïö© ÏÑ§Ï†ï
            textarea.value = currentMemo || '';
            
            // Î™®Îã¨ ÌëúÏãú
            modal.classList.add('active');
            
            // Ìè¨Ïª§Ïä§ ÏÑ§Ï†ï
            setTimeout(() => {
                textarea.focus();
            }, 100);
            
            // Ï†ÑÏó≠ Î≥ÄÏàòÏóê ÌòÑÏû¨ Ìé∏Ïßë Ï§ëÏù∏ Îß§Î¨º Ï†ïÎ≥¥ Ï†ÄÏû•
            window.currentPropertyMemo = {
                id: propertyId,
                element: null
            };
        }
        
        // Î©îÎ™® Î™®Îã¨ Îã´Í∏∞
        function closePropertyMemoModal() {
            const modal = document.getElementById('property-memo-modal');
            modal.classList.remove('active');
            window.currentPropertyMemo = null;
            window.currentMemoCell = null;
        }
        
        // Î©îÎ™® Ï†ÄÏû•
        async function savePropertyMemo() {
            const textarea = document.getElementById('property-memo-textarea');
            const memo = textarea.value.trim();
            
            // ÏÉà Îß§Î¨ºÏùò Î©îÎ™®Ïù∏ Í≤ΩÏö∞
            if (window.currentMemoCell) {
                const cell = window.currentMemoCell;
                cell.textContent = memo || 'Î©îÎ™® ÏûÖÎ†•';
                cell.style.color = memo ? '#1f2937' : '#64748b';
                
                // Î©îÎ™® Îç∞Ïù¥ÌÑ∞Î•º datasetÏóê Ï†ÄÏû•
                cell.dataset.memo = memo;
                
                // ÏÉà Îß§Î¨º ÌñâÏùò Ï¢ÖÎ•òÏóê Îî∞Îùº Ï†ÅÏ†àÌïú ÏûêÎèôÏ†ÄÏû• Ìï®Ïàò Ìò∏Ï∂ú
                const row = cell.closest('tr');
                if (row.classList.contains('new-property-row')) {
                    // ÏïÑÌååÌä∏Î™©Î°ù ÌÉ≠Ïùò ÏÉà Îß§Î¨º
                    autoSaveNewProperty(cell);
                } else if (row.classList.contains('new-team-property-row')) {
                    // ÌåÄÏû•Î©îÏù¥ÌîåÍ¥ÄÎ¶¨ ÌÉ≠Ïùò ÏÉà Îß§Î¨º
                    autoSaveNewTeamProperty(cell);
                }
                
                closePropertyMemoModal();
                return;
            }
            
            // Í∏∞Ï°¥ Îß§Î¨ºÏùò Î©îÎ™®Ïù∏ Í≤ΩÏö∞
            if (!window.currentPropertyMemo) {
                alert('Ïò§Î•ò: Îß§Î¨º Ï†ïÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            try {
                const response = await fetch('/api/maeiple/update', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        id: window.currentPropertyMemo.id,
                        field: 'memo',
                        value: memo
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // UI Ï¶âÏãú ÏóÖÎç∞Ïù¥Ìä∏ (ÏàúÏÑú Ïú†ÏßÄÎ•º ÏúÑÌï¥ ÌéòÏù¥ÏßÄ ÏÉàÎ°úÍ≥†Ïπ®ÌïòÏßÄ ÏïäÏùå)
                    const propertyRow = document.querySelector(`tr[data-property-id="${window.currentPropertyMemo.id}"]`);
                    if (propertyRow) {
                        const memoCell = propertyRow.querySelector('.memo-cell');
                        if (memoCell) {
                            const memoText = memo || 'ÌÅ¥Î¶≠ÌïòÏó¨ Î©îÎ™® Ï∂îÍ∞Ä';
                            const displayText = memoText.length > 20 ? memoText.substring(0, 20) + '...' : memoText;
                            memoCell.textContent = displayText;
                            memoCell.style.color = memo ? '#1f2937' : '#64748b';
                            memoCell.style.fontStyle = memo ? 'normal' : 'italic';
                            
                            // onclick Ïù¥Î≤§Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
                            const escapedMemo = (memo || '').replace(/'/g, "\\'");
                            memoCell.setAttribute('onclick', `editTeamMemo(${window.currentPropertyMemo.id}, '${escapedMemo}', this)`);
                        }
                    }
                    
                    // ÌåÄ properties Î∞∞Ïó¥ÎèÑ ÏóÖÎç∞Ïù¥Ìä∏ (Í∞úÏù∏Îß§Î¨ºÍ¥ÄÎ¶¨Ïö©)
                    const teamProperty = teamProperties.find(p => p.id === window.currentPropertyMemo.id);
                    if (teamProperty) {
                        teamProperty.memo = memo;
                    }
                    
                    // ÏùºÎ∞ò properties Î∞∞Ïó¥ÎèÑ ÏóÖÎç∞Ïù¥Ìä∏ (ÏïÑÌååÌä∏Î™©Î°ùÏö©)  
                    const property = properties.find(p => p.id === window.currentPropertyMemo.id);
                    if (property) {
                        property.memo = memo;
                    }
                    
                    closePropertyMemoModal();
                    } else {
                    alert('Î©îÎ™® Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§: ' + result.error);
                }
            } catch (error) {
                console.error('Î©îÎ™® Ï†ÄÏû• Ïò§Î•ò:', error);
                alert('Î©îÎ™® Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
            }
        }

        // ===== ÏßÅÏõê Í¥ÄÎ¶¨ JavaScript Ìï®ÏàòÎì§ =====
        // Ï†ÑÏó≠ Î≥ÄÏàòÎì§
        let currentEmployeePage = 1;
        const employeePerPage = 20;
        let employeeTotalPages = 1;
        let employees = [];

        // ÏßÅÏõê Î™©Î°ù Î∂àÎü¨Ïò§Í∏∞ (ÌåÄÏû•Ïö©)
        async function loadTeamLeaderEmployees(page = 1) {
            console.log(`üë• ÏßÅÏõê Î™©Î°ù Î°úÎìú ÏãúÏûë (ÌéòÏù¥ÏßÄ ${page})`);
            try {
                currentEmployeePage = page;
                const response = await fetch(`/api/employees?page=${page}&per_page=${employeePerPage}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('üë• ÏßÅÏõê API ÏùëÎãµ Îç∞Ïù¥ÌÑ∞:', data);
                
                if (data.success && data.employees) {
                    console.log(`‚úÖ ÏßÅÏõê ${data.employees.length}Î™Ö Î°úÎìú ÏôÑÎ£å`);
                    employees = data.employees;
                    displayTeamLeaderEmployees(data.employees);
                    
                    // ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò ÏóÖÎç∞Ïù¥Ìä∏
                    employeeTotalPages = data.total_pages || data.totalPages || 1;
                    console.log(`üìÑ Ï¥ù ÌéòÏù¥ÏßÄ Ïàò: ${employeeTotalPages}`);
                    renderTeamLeaderEmployeePagination();
                } else {
                    console.error('‚ùå API ÏùëÎãµ Ïò§Î•ò:', data);
                    throw new Error(data.error || data.message || 'ÏßÅÏõê Î™©Î°ùÏùÑ Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§');
                }
            } catch (error) {
                console.error('‚ùå ÏßÅÏõê Î™©Î°ù Î°úÎìú Ïã§Ìå®:', error);
                
                let errorMessage = 'ÏßÅÏõê Î™©Î°ùÏùÑ Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.';
                if (error.message.includes('HTTP 401')) {
                    errorMessage = 'Í∂åÌïúÏù¥ ÏóÜÏäµÎãàÎã§. Î°úÍ∑∏Ïù∏ ÏÉÅÌÉúÎ•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.';
                } else if (error.message.includes('HTTP 403')) {
                    errorMessage = 'Ï†ëÍ∑º Í∂åÌïúÏù¥ ÏóÜÏäµÎãàÎã§. Í¥ÄÎ¶¨ÏûêÏóêÍ≤å Î¨∏ÏùòÌïòÏÑ∏Ïöî.';
                } else if (error.message.includes('HTTP 500')) {
                    errorMessage = 'ÏÑúÎ≤Ñ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.';
                }
                
                showAlert(errorMessage, 'error');
                
                // Îπà ÌÖåÏù¥Î∏î ÌëúÏãú
                const tbody = document.querySelector('#employees-list');
                if (tbody) {
                    tbody.innerHTML = `<tr><td colspan="7" style="text-align: center; padding: 40px; color: #64748b;">
                        <div>üìã ÏßÅÏõê Î™©Î°ùÏùÑ Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.</div>
                        <div style="margin-top: 8px; font-size: 12px;">${errorMessage}</div>
                        <button class="btn btn-sm btn-primary" onclick="loadTeamLeaderEmployees()" style="margin-top: 12px;">üîÑ Îã§Ïãú ÏãúÎèÑ</button>
                    </td></tr>`;
                }
            }
        }

        // ÏÉà Í≥†Í∞ù Ìñâ Ï∂îÍ∞Ä
        function addNewCustomerRow() {
            const tbody = document.getElementById('customers-list');
            const newRow = document.createElement('tr');
            newRow.classList.add('new-customer-row');
            
            // Ïò§Îäò ÎÇ†Ïßú Íµ¨ÌïòÍ∏∞ (ÌïúÍµ≠ÏãúÍ∞Ñ Í∏∞Ï§Ä)
            const now = new Date();
            const todayString = now.getFullYear() + '-' + 
                String(now.getMonth() + 1).padStart(2, '0') + '-' + 
                String(now.getDate()).padStart(2, '0');
            
            newRow.innerHTML = `
                <td class="editable-cell" data-field="date" data-type="date" onclick="editCustomerCell(this)">${todayString}</td>
                <td class="editable-cell" data-field="move_in_date" data-type="date" onclick="editCustomerCell(this)">-</td>
                <td class="editable-cell" data-field="customer_name" data-type="text" onclick="editCustomerCell(this)">-</td>
                <td class="editable-cell" data-field="customer_phone" data-type="text" onclick="editCustomerCell(this)">-</td>
                <td class="editable-cell" data-field="budget" data-type="text" onclick="editCustomerCell(this)">-</td>
                <td class="editable-cell" data-field="rooms" data-type="text" onclick="editCustomerCell(this)">-</td>
                <td class="editable-cell" data-field="location" data-type="text" onclick="editCustomerCell(this)">-</td>
                <td class="editable-cell" data-field="loan" data-type="text" onclick="editCustomerCell(this)">-</td>
                <td class="editable-cell" data-field="parking" data-type="text" onclick="editCustomerCell(this)">-</td>
                <td class="editable-cell" data-field="pets" data-type="text" onclick="editCustomerCell(this)">-</td>
                <td class="memo-cell" onclick="editCustomerMemo(this)">-</td>
                <td class="editable-cell" data-field="status" data-type="select" onclick="editCustomerCell(this)">
                    <span class="status-badge status-progress">ÏßÑÌñâÏ§ë</span>
                </td>
                <td><span class="property-link-placeholder">Ï£ºÍ±∞ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ± Ï§ë...</span></td>
                <td><span class="property-link-placeholder">ÏóÖÎ¨¥ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ± Ï§ë...</span></td>
            `;
            tbody.insertBefore(newRow, tbody.firstChild);
        }

        // Í≥†Í∞ù ÏÖÄ Ìé∏Ïßë
        function editCustomerCell(cell) {
            if (cell.querySelector('input') || cell.querySelector('select')) return;
            
            const row = cell.closest('tr');
            const customerId = row.getAttribute('data-customer-id');
            const field = cell.getAttribute('data-field');
            const type = cell.getAttribute('data-type');
            let currentValue = cell.textContent.trim();
            
            // ÏÉÅÌÉú Î∞∞ÏßÄÏóêÏÑú Ïã§Ï†ú Í∞í Ï∂îÏ∂ú
            if (field === 'status') {
                const badge = cell.querySelector('.status-badge');
                currentValue = badge ? badge.textContent.trim() : currentValue;
            }
            
            if (currentValue === '-' || currentValue === '') {
                currentValue = '';
            }
            
            cell.classList.add('editing-cell');
            
            let inputElement;
            if (type === 'select' && field === 'status') {
                inputElement = document.createElement('select');
                inputElement.innerHTML = `
                    <option value="ÏßÑÌñâÏ§ë" ${currentValue === 'ÏßÑÌñâÏ§ë' ? 'selected' : ''}>ÏßÑÌñâÏ§ë</option>
                    <option value="ÏôÑÎ£å" ${currentValue === 'ÏôÑÎ£å' ? 'selected' : ''}>ÏôÑÎ£å</option>
                    <option value="Í≥ÑÏïΩ" ${currentValue === 'Í≥ÑÏïΩ' ? 'selected' : ''}>Í≥ÑÏïΩ</option>
                    <option value="Î≥¥Î•ò" ${currentValue === 'Î≥¥Î•ò' ? 'selected' : ''}>Î≥¥Î•ò</option>
                `;
            } else {
                inputElement = document.createElement('input');
                inputElement.type = type;
                inputElement.value = currentValue === '-' ? '' : currentValue;
                
                if (type === 'date' && !inputElement.value) {
                    const now = new Date();
                    const todayString = now.getFullYear() + '-' + 
                        String(now.getMonth() + 1).padStart(2, '0') + '-' + 
                        String(now.getDate()).padStart(2, '0');
                    inputElement.value = todayString;
                }
            }
            
            inputElement.style.width = '100%';
            inputElement.style.border = 'none';
            inputElement.style.background = 'transparent';
            inputElement.style.outline = 'none';
            
            const saveEdit = async (moveNext = false) => {
                const newValue = inputElement.value.trim();
                
                if (row.classList.contains('new-customer-row')) {
                    // ÏÉà Í≥†Í∞ùÏùò Í≤ΩÏö∞
                    if (field === 'status') {
                        const statusClass = newValue === 'Í≥ÑÏïΩ' ? 'status-complete' : 
                                           newValue === 'Î≥¥Î•ò' ? 'status-hold' : 'status-progress';
                        cell.innerHTML = `<span class="status-badge ${statusClass}">${newValue}</span>`;
                    } else if (field === 'customer_phone') {
                        cell.textContent = newValue || '-';
                        cell.style.fontFamily = newValue ? 'monospace' : 'inherit';
                        cell.style.letterSpacing = newValue ? '0.5px' : 'normal';
                    } else {
                        cell.textContent = newValue || '-';
                    }
                    cell.classList.remove('editing-cell');
                } else if (customerId) {
                    // Í∏∞Ï°¥ Í≥†Í∞ù ÏóÖÎç∞Ïù¥Ìä∏
                    const success = await updateCustomerField(customerId, field, newValue, cell, moveNext);
                    if (success) {
                        if (field === 'status') {
                            const statusClass = newValue === 'Í≥ÑÏïΩ' ? 'status-complete' : 
                                               newValue === 'Î≥¥Î•ò' ? 'status-hold' : 'status-progress';
                            cell.innerHTML = `<span class="status-badge ${statusClass}">${newValue}</span>`;
                        } else if (field === 'customer_phone') {
                            cell.textContent = newValue || '-';
                            cell.style.fontFamily = newValue ? 'monospace' : 'inherit';
                            cell.style.letterSpacing = newValue ? '0.5px' : 'normal';
                        } else {
                            cell.textContent = newValue || '-';
                        }
                        cell.classList.remove('editing-cell');
                        showAlert('ÏàòÏ†ïÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.', 'success');
                    } else {
                        cell.classList.remove('editing-cell');
                        cell.textContent = currentValue || '-';
                    }
                }
                
                // ÏóîÌÑ∞Î°ú Ï†ÄÏû• ÌõÑ ÏòÜ ÏÖÄÎ°ú Ïù¥Îèô
                if (moveNext) {
                    const editableCells = Array.from(cell.parentElement.querySelectorAll('.editable-cell, .memo-cell'));
                    const idx = editableCells.indexOf(cell);
                    if (idx !== -1 && idx < editableCells.length - 1) {
                        setTimeout(() => editCustomerCell(editableCells[idx + 1]), 50);
                    }
                }
            };
            
            inputElement.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    saveEdit(true);
                } else if (e.key === 'Escape') {
                    cell.classList.remove('editing-cell');
                    if (field === 'status') {
                        const statusClass = currentValue === 'Í≥ÑÏïΩ' ? 'status-complete' : 
                                           currentValue === 'Î≥¥Î•ò' ? 'status-hold' : 'status-progress';
                        cell.innerHTML = `<span class="status-badge ${statusClass}">${currentValue}</span>`;
                    } else {
                        cell.textContent = currentValue;
                    }
                }
            });
            
            inputElement.addEventListener('blur', () => saveEdit(false));
            
            cell.innerHTML = '';
            cell.appendChild(inputElement);
            inputElement.focus();
        }

        // Í≥†Í∞ù ÌïÑÎìú ÏóÖÎç∞Ïù¥Ìä∏
        async function updateCustomerField(customerId, field, value, cell, moveNext = false) {
            try {
                const response = await fetch(`/api/customers/${customerId}/field`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ [field]: value })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    return true;
                } else {
                    showAlert(result.error || 'ÏàòÏ†ïÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
                    return false;
                }
            } catch (error) {
                console.error('ÌïÑÎìú ÏóÖÎç∞Ïù¥Ìä∏ Ïò§Î•ò:', error);
                showAlert('ÏÑúÎ≤Ñ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
                return false;
            }
        }



        // ÌïÑÌÑ∞ Í∏∞Îä•
        function filterCustomers(status) {
            // ÌôúÏÑ± Î≤ÑÌäº ÏóÖÎç∞Ïù¥Ìä∏
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-filter="${status}"]`).classList.add('active');
            
            // ÌïÑÌÑ∞ÎßÅ
            if (status === 'all') {
                filteredCustomers = [...customers];
            } else {
                filteredCustomers = customers.filter(customer => 
                    customer.status === status
                );
            }
            
            displayCustomers(filteredCustomers);
        }

        // ÎÇ†ÏßúÎ≥Ñ ÌïÑÌÑ∞
        function filterByDate(period) {
            const now = new Date();
            let startDate;
            
            switch(period) {
                case 'today':
                    startDate = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                    break;
                case 'week':
                    startDate = new Date(now.getFullYear(), now.getMonth(), now.getDate() - 7);
                    break;
                case 'month':
                    startDate = new Date(now.getFullYear(), now.getMonth(), 1);
                    break;
                case 'all':
                default:
                    startDate = null;
                    break;
            }
            
            if (startDate) {
                filteredCustomers = customers.filter(customer => {
                    if (!customer.date) return false;
                    const customerDate = new Date(customer.date);
                    return customerDate >= startDate;
                });
            } else {
                filteredCustomers = [...customers];
            }
            
            displayCustomers(filteredCustomers);
        }

        // ===== ÏßÅÏõê Í¥ÄÎ¶¨ JavaScript Ìï®ÏàòÎì§ =====
        // Ï§ëÎ≥µ Ï†úÍ±∞ - Ïù¥ÎØ∏ ÏúÑÏóêÏÑú Ï†ïÏùòÎê®

        // ÏßÅÏõê Î™©Î°ù ÌëúÏãú
        function displayTeamLeaderEmployees(employeeList) {
            const tbody = document.getElementById('employees-list');
            
            if (employeeList.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 40px; color: #64748b;">Îì±Î°ùÎêú ÏßÅÏõêÏù¥ ÏóÜÏäµÎãàÎã§.</td></tr>';
                return;
            }
            
            tbody.innerHTML = employeeList.map(emp => {
                // status ÎòêÎäî employee_status ÌôïÏù∏
                const isActive = (emp.status === 'active' || emp.employee_status === 'active');
                const employeeName = emp.name || emp.employee_name || emp.employee_id || '-';
                const employeeRole = emp.role || emp.employee_role || 'ÏßÅÏõê';
                
                return `
                <tr data-employee-id="${emp.id}">
                    <td><strong>${emp.employee_id || emp.name || '-'}</strong></td>
                    <td>${employeeName}</td>
                    <td><span class="status-badge" style="background: #e0e7ff; color: #4338ca;">${emp.team || 'ÎØ∏ÏßÄÏ†ï'}</span></td>
                    <td><span class="status-badge" style="background: ${getRoleBadgeColor(employeeRole)}; color: ${getRoleTextColor(employeeRole)};">${employeeRole}</span></td>
                    <td><span class="status-badge" style="background: ${isActive ? '#dcfce7' : '#fee2e2'}; color: ${isActive ? '#166534' : '#991b1b'};">${isActive ? 'ÌôúÏÑ±' : 'ÎπÑÌôúÏÑ±'}</span></td>
                    <td>${emp.created_at ? new Date(emp.created_at).toLocaleDateString() : '-'}</td>
                    <td>
                        <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                            <button class="btn btn-sm" style="background: #3b82f6; color: white; font-size: 11px; padding: 4px 8px;" onclick="editEmployee(${emp.id})">ÏàòÏ†ï</button>
                            ${isActive ? 
                                `<button class="btn btn-sm" style="background: #dc2626; color: white; font-size: 11px; padding: 4px 8px;" onclick="handleEmployeeDeletion(${emp.id}, '${employeeName}')">ÏÇ≠Ï†ú</button>` :
                                `<button class="btn btn-sm" style="background: #059669; color: white; font-size: 11px; padding: 4px 8px;" onclick="activateEmployee(${emp.id})">ÌôúÏÑ±Ìôî</button>`
                            }
                            ${!isActive ? 
                                `<button class="btn btn-sm" style="background: #ef4444; color: white; font-size: 11px; padding: 4px 8px;" onclick="handleEmployeeDeletion(${emp.id}, '${employeeName}')">ÏôÑÏ†ÑÏÇ≠Ï†ú</button>` :
                                ''
                            }
                            <button class="btn btn-sm" style="background: #6b7280; color: white; font-size: 11px; padding: 4px 8px;" onclick="resetPasswordModal(${emp.id})">ÎπÑÎ∞ÄÎ≤àÌò∏ Ïû¨ÏÑ§Ï†ï</button>
                        </div>
                    </td>
                </tr>`;
            }).join('');
        }

        // Ïó≠Ìï†Î≥Ñ Î∞∞ÏßÄ ÏÉâÏÉÅ
        function getRoleBadgeColor(role) {
            switch(role) {
                case 'ÌåÄÏû•': return '#dcfce7';
                case 'ÏßÅÏõê': return '#e0f2fe';
                default: return '#f3f4f6';
            }
        }

        function getRoleTextColor(role) {
            switch(role) {
                case 'ÌåÄÏû•': return '#166534';
                case 'ÏßÅÏõê': return '#0369a1';
                default: return '#374151';
            }
        }

        // ÏßÅÏõê Ï∂îÍ∞Ä/ÏàòÏ†ï Ìèº ÌÜ†Í∏Ä
        // ÏßÅÏõê Ï∂îÍ∞Ä Î™®Îã¨ Ïó¥Í∏∞
        function openAddEmployeeModal() {
            const modal = document.getElementById('addEmployeeModal');
            modal.style.display = 'flex';
            resetEmployeeForm();
            // Ï≤´ Î≤àÏß∏ ÏûÖÎ†• ÌïÑÎìúÏóê Ìè¨Ïª§Ïä§
            setTimeout(() => {
                document.getElementById('employee_id').focus();
            }, 100);
        }
        
        // ÏßÅÏõê Ï∂îÍ∞Ä Î™®Îã¨ Îã´Í∏∞
        function closeAddEmployeeModal() {
            const modal = document.getElementById('addEmployeeModal');
            modal.style.display = 'none';
            resetEmployeeForm();
        }
        
        // ESC ÌÇ§Î°ú Î™®Îã¨ Îã´Í∏∞
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const modal = document.getElementById('addEmployeeModal');
                if (modal.style.display === 'flex') {
                    closeAddEmployeeModal();
                }
            }
        });

        // ÏßÅÏõê Ìèº Ï¥àÍ∏∞Ìôî
        function resetEmployeeForm() {
            const form = document.getElementById('add-employee-form');
            if (form) {
            form.reset();
            form.removeAttribute('data-edit-mode');
            form.removeAttribute('data-employee-id');
            }
            
            const employeeIdField = document.getElementById('employee_id');
            if (employeeIdField) {
                employeeIdField.readOnly = false;
            }
            
            const teamField = document.getElementById('team');
            if (teamField) {
                teamField.disabled = false;
                // ÌåÄ Ï∂îÍ∞Ä Î≤ÑÌäº Îã§Ïãú ÌëúÏãú
                const addTeamBtn = teamField.parentElement ? teamField.parentElement.querySelector('button') : null;
                if (addTeamBtn) {
                    addTeamBtn.style.display = '';
                }
            }
            
            const addBtn = document.getElementById('add-btn');
            if (addBtn) {
                addBtn.innerHTML = '<span>‚ûï</span> ÏßÅÏõê Ï∂îÍ∞Ä';
            }
            
            // cancel-btnÏùÄ Ï°¥Ïû¨ÌïòÏßÄ ÏïäÏùÑ Ïàò ÏûàÏúºÎØÄÎ°ú Ï≤¥ÌÅ¨
            const cancelBtn = document.getElementById('cancel-btn');
            if (cancelBtn) {
                cancelBtn.style.display = 'none';
            }
        }

        // ÏßÅÏõê ÏàòÏ†ï
        async function editEmployee(empId) {
            const employee = employees.find(emp => emp.id === empId);
            if (!employee) {
                showAlert('ÏßÅÏõêÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.', 'error');
                return;
            }
            
            // Î™®Îã¨ Ïó¥Í∏∞
            const modal = document.getElementById('addEmployeeModal');
            modal.style.display = 'flex';
            
            // Ìèº ÌïÑÎìúÏóê Í∏∞Ï°¥ Í∞í ÏÑ§Ï†ï
            document.getElementById('employee_id').value = employee.employee_id || employee.name || '';
            document.getElementById('employee_id').readOnly = true; // IDÎäî ÏàòÏ†ï Î∂àÍ∞Ä
            document.getElementById('employee_name').value = employee.employee_name || employee.name || '';
            document.getElementById('team').value = employee.team || '';
            
            const roleField = document.getElementById('employee_role');
            if (roleField) {
                roleField.value = employee.role || employee.employee_role || 'ÏßÅÏõê';
            }
            
            const statusField = document.getElementById('employee_status');
            if (statusField) {
                statusField.value = employee.status || employee.employee_status || 'active';
            }
            
            const passwordField = document.getElementById('employee_password');
            if (passwordField) {
                passwordField.value = ''; // ÎπÑÎ∞ÄÎ≤àÌò∏Îäî ÌëúÏãúÌïòÏßÄ ÏïäÏùå
            }
            
            // ÌåÄÏû•Ïù∏ Í≤ΩÏö∞ ÌåÄ ÌïÑÎìú ÎπÑÌôúÏÑ±Ìôî
            const currentTeam = '{{ employee_team }}';
            const isTeamLeader = '{{ employee_role }}' === 'ÌåÄÏû•';
            const isAdmin = '{{ is_admin }}' === 'True';
            
            if (isTeamLeader && !isAdmin) {
                const teamSelect = document.getElementById('team');
                teamSelect.value = currentTeam;
                teamSelect.disabled = true;
            }
            
            // Î≤ÑÌäº ÌÖçÏä§Ìä∏ Î≥ÄÍ≤Ω
            const addBtn = document.getElementById('add-btn');
            if (addBtn) {
            addBtn.innerHTML = '<span>‚úèÔ∏è</span> ÏßÅÏõê ÏàòÏ†ï';
            }
            
            // ÌèºÏóê ÏàòÏ†ï Î™®Îìú ÌëúÏãú
            const form = document.getElementById('add-employee-form');
            form.setAttribute('data-edit-mode', 'true');
            form.setAttribute('data-employee-id', empId);
        }
        
        // ÏßÅÏõê ÌôúÏÑ±Ìôî
        async function activateEmployee(empId) {
            if (!confirm('Ïù¥ ÏßÅÏõêÏùÑ ÌôúÏÑ±ÌôîÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;
            
            try {
                const response = await fetch(`/api/employees/${empId}/activate`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showAlert('ÏßÅÏõêÏù¥ ÌôúÏÑ±ÌôîÎêòÏóàÏäµÎãàÎã§.', 'success');
                    loadTeamLeaderEmployees(currentEmployeePage);
                } else {
                    showAlert(result.message || 'ÌôúÏÑ±ÌôîÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
                }
            } catch (error) {
                console.error('ÌôúÏÑ±Ìôî Ïò§Î•ò:', error);
                showAlert('ÏÑúÎ≤Ñ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
            }
        }
        
        // 2Îã®Í≥Ñ ÏßÅÏõê ÏÇ≠Ï†ú Ï≤òÎ¶¨ (ÎπÑÌôúÏÑ±Ìôî ‚Üí ÏôÑÏ†ÑÏÇ≠Ï†ú)
        async function handleEmployeeDeletion(empId, employeeName) {
            // ÏßÅÏõê ÏÉÅÌÉú ÌôïÏù∏
            const employee = employees.find(emp => emp.id === empId);
            if (!employee) {
                showAlert('ÏßÅÏõêÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.', 'error');
                return;
            }
            
            const isActive = (employee.status === 'active' || employee.employee_status === 'active');
            
            if (isActive) {
                // 1Îã®Í≥Ñ: ÌôúÏÑ± ÏÉÅÌÉúÏù∏ Í≤ΩÏö∞ ÎπÑÌôúÏÑ±Ìôî
                if (!confirm(`"${employeeName}" ÏßÅÏõêÏùÑ ÎπÑÌôúÏÑ±ÌôîÌïòÏãúÍ≤†ÏäµÎãàÍπå?\n\n‚ö†Ô∏è ÎπÑÌôúÏÑ±ÌôîÎêú ÏßÅÏõêÏùÄ Î°úÍ∑∏Ïù∏Ïù¥ Î∂àÍ∞ÄÎä•Ìï©ÎãàÎã§.`)) {
                    return;
                }
                
                try {
                    const response = await fetch(`/api/employees/${empId}/deactivate`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                        }
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        showAlert(`"${employeeName}" ÏßÅÏõêÏù¥ ÎπÑÌôúÏÑ±ÌôîÎêòÏóàÏäµÎãàÎã§.\n\nÎã§Ïãú ÏÇ≠Ï†ú Î≤ÑÌäºÏùÑ ÎàÑÎ•¥Î©¥ ÏôÑÏ†ÑÌûà ÏÇ≠Ï†úÎê©ÎãàÎã§.`, 'success');
                        loadTeamLeaderEmployees(currentEmployeePage);
                    } else {
                        showAlert(result.message || 'ÎπÑÌôúÏÑ±ÌôîÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
                    }
                } catch (error) {
                    console.error('ÎπÑÌôúÏÑ±Ìôî Ïò§Î•ò:', error);
                    showAlert('ÏÑúÎ≤Ñ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
                }
            } else {
                // 2Îã®Í≥Ñ: Ïù¥ÎØ∏ ÎπÑÌôúÏÑ±ÌôîÎêú Í≤ΩÏö∞ ÏôÑÏ†Ñ ÏÇ≠Ï†ú
                if (!confirm(`"${employeeName}" ÏßÅÏõêÏùÑ ÏôÑÏ†ÑÌûà ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?\n\n‚ö†Ô∏è Ïù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏúºÎ©∞, Î™®Îì† Îç∞Ïù¥ÌÑ∞Í∞Ä ÏòÅÍµ¨Ï†ÅÏúºÎ°ú ÏÇ≠Ï†úÎê©ÎãàÎã§.`)) {
                    return;
                }
                
                try {
                    const response = await fetch(`/api/employees/${empId}/permanent-delete`, {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json',
                        }
                    });

                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`HTTP ${response.status}: ${errorText}`);
                }

                const result = await response.json();
                
                if (result.success) {
                        showAlert(`"${employeeName}" ÏßÅÏõêÏù¥ ÏôÑÏ†ÑÌûà ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.`, 'success');
                        loadTeamLeaderEmployees(currentEmployeePage);
                    } else {
                        showAlert(result.message || 'ÏÇ≠Ï†úÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
                    }
                } catch (error) {
                    console.error('ÏÇ≠Ï†ú Ïò§Î•ò:', error);
                    showAlert(`ÏÑúÎ≤Ñ Ïò§Î•ò: ${error.message}`, 'error');
                }
            }
        }
        
        // ÎπÑÎ∞ÄÎ≤àÌò∏ Ïû¨ÏÑ§Ï†ï Î™®Îã¨ Ïó¥Í∏∞
        function resetPasswordModal(empId) {
            const employee = employees.find(emp => emp.id === empId);
            if (!employee) {
                showAlert('ÏßÅÏõêÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.', 'error');
                return;
            }
            
            const employeeName = employee.name || employee.employee_name || employee.employee_id || 'ÏßÅÏõê';
            const newPassword = prompt(`${employeeName}Ïùò ÏÉà ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî:\n(ÎπÑÏõåÎëêÎ©¥ Í∏∞Î≥∏Í∞í 1234Î°ú ÏÑ§Ï†ïÎê©ÎãàÎã§)`);
            
            if (newPassword === null) return; // Ï∑®ÏÜå ÌÅ¥Î¶≠
            
            resetPassword(empId, newPassword || '1234');
        }
        
        // ÎπÑÎ∞ÄÎ≤àÌò∏ Ïû¨ÏÑ§Ï†ï
        async function resetPassword(empId, newPassword) {
            try {
                console.log('ÎπÑÎ∞ÄÎ≤àÌò∏ Ïû¨ÏÑ§Ï†ï ÏöîÏ≤≠:', empId, newPassword);
                const response = await fetch(`/api/employees/${empId}/reset-password`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        new_password: newPassword
                    })
                });
                
                console.log('ÏùëÎãµ ÏÉÅÌÉú:', response.status);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('ÏóêÎü¨ ÏùëÎãµ:', errorText);
                    throw new Error(`HTTP ${response.status}: ${errorText}`);
                }
                
                const result = await response.json();
                console.log('ÏùëÎãµ Í≤∞Í≥º:', result);
                
                if (result.success) {
                    showAlert(result.message || 'ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä Ïû¨ÏÑ§Ï†ïÎêòÏóàÏäµÎãàÎã§.', 'success');
                } else {
                    showAlert(result.error || result.message || 'ÎπÑÎ∞ÄÎ≤àÌò∏ Ïû¨ÏÑ§Ï†ïÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
                }
            } catch (error) {
                console.error('ÎπÑÎ∞ÄÎ≤àÌò∏ Ïû¨ÏÑ§Ï†ï Ïò§Î•ò ÏÉÅÏÑ∏:', error);
                showAlert(`ÏÑúÎ≤Ñ Ïò§Î•ò: ${error.message}`, 'error');
            }
        }
        
        // ÏßÅÏõê ÏÇ≠Ï†ú
        async function deleteEmployee(empId) {
            if (!confirm('Ï†ïÎßêÎ°ú Ïù¥ ÏßÅÏõêÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?\nÏù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§.')) return;
            
            try {
                console.log('ÏßÅÏõê ÏÇ≠Ï†ú ÏöîÏ≤≠:', empId);
                const response = await fetch(`/api/employees/${empId}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });
                
                console.log('ÏÇ≠Ï†ú ÏùëÎãµ ÏÉÅÌÉú:', response.status);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('ÏÇ≠Ï†ú ÏóêÎü¨ ÏùëÎãµ:', errorText);
                    throw new Error(`HTTP ${response.status}: ${errorText}`);
                }
                
                const result = await response.json();
                console.log('ÏÇ≠Ï†ú ÏùëÎãµ Í≤∞Í≥º:', result);
                
                if (result.success) {
                    showAlert(result.message || 'ÏßÅÏõêÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.', 'success');
                    loadTeamLeaderEmployees(currentEmployeePage);
                } else {
                    showAlert(result.message || 'ÏÇ≠Ï†úÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
                }
            } catch (error) {
                console.error('ÏÇ≠Ï†ú Ïò§Î•ò ÏÉÅÏÑ∏:', error);
                showAlert(`ÏÑúÎ≤Ñ Ïò§Î•ò: ${error.message}`, 'error');
            }
        }

        // ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò Î†åÎçîÎßÅ
        function renderTeamLeaderEmployeePagination() {
            const paginationDiv = document.getElementById('employee-pagination');
            if (!paginationDiv || window.teamLeaderEmployeeTotalPages <= 1) {
                if (paginationDiv) paginationDiv.style.display = 'none';
                return;
            }
            
            paginationDiv.style.display = 'flex';
            let paginationHTML = '';
            
            // Ïù¥Ï†Ñ ÌéòÏù¥ÏßÄ Î≤ÑÌäº
            if (window.teamLeaderEmployeePage > 1) {
                paginationHTML += `<button onclick="loadTeamLeaderEmployees(${window.teamLeaderEmployeePage - 1})" style="padding: 8px 12px; border: 1px solid #d1d5db; background: #f9fafb; border-radius: 6px; cursor: pointer; color: #374151;">Ïù¥Ï†Ñ</button>`;
            }
            
            // ÌéòÏù¥ÏßÄ Î≤àÌò∏ Î≤ÑÌäºÎì§
            const startPage = Math.max(1, window.teamLeaderEmployeePage - 3);
            const endPage = Math.min(window.teamLeaderEmployeeTotalPages, startPage + 6);
            
            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === window.teamLeaderEmployeePage;
                paginationHTML += `
                    <button onclick="loadTeamLeaderEmployees(${i})" 
                            style="padding: 8px 12px; border: 1px solid ${isActive ? '#3b82f6' : '#d1d5db'}; 
                                   background: ${isActive ? '#3b82f6' : '#f9fafb'}; color: ${isActive ? 'white' : '#374151'}; 
                                   border-radius: 6px; cursor: pointer; font-weight: ${isActive ? '600' : 'normal'};">
                        ${i}
                    </button>
                `;
            }
            
            // Îã§Ïùå ÌéòÏù¥ÏßÄ Î≤ÑÌäº
            if (window.teamLeaderEmployeePage < window.teamLeaderEmployeeTotalPages) {
                paginationHTML += `<button onclick="loadTeamLeaderEmployees(${window.teamLeaderEmployeePage + 1})" style="padding: 8px 12px; border: 1px solid #d1d5db; background: #f9fafb; border-radius: 6px; cursor: pointer; color: #374151;">Îã§Ïùå</button>`;
            }
            
            paginationDiv.innerHTML = paginationHTML;
        }

        // ÏßÅÏõê ÎπÑÌôúÏÑ±Ìôî
        async function deactivateEmployee(empId) {
            if (!confirm('Ïù¥ ÏßÅÏõêÏùÑ ÎπÑÌôúÏÑ±ÌôîÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;
            
            try {
                const response = await fetch(`/api/employees/${empId}/deactivate`, {
                    method: 'PUT'
                });
                const result = await response.json();
                
                if (result.success) {
                    showAlert('ÏßÅÏõêÏù¥ ÎπÑÌôúÏÑ±ÌôîÎêòÏóàÏäµÎãàÎã§.', 'success');
                    loadTeamLeaderEmployees();
                } else {
                    showAlert(result.message || 'ÎπÑÌôúÏÑ±ÌôîÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
                }
            } catch (error) {
                showAlert('ÏÑúÎ≤Ñ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
            }
        }

        // ÏßÅÏõê ÌôúÏÑ±Ìôî
        async function activateEmployee(empId) {
            try {
                const response = await fetch(`/api/employees/${empId}/activate`, {
                    method: 'PUT'
                });
                const result = await response.json();
                
                if (result.success) {
                    showAlert('ÏßÅÏõêÏù¥ ÌôúÏÑ±ÌôîÎêòÏóàÏäµÎãàÎã§.', 'success');
                    loadTeamLeaderEmployees();
                } else {
                    showAlert('ÌôúÏÑ±ÌôîÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
                }
            } catch (error) {
                showAlert('ÏÑúÎ≤Ñ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
            }
        }

        // ÎπÑÎ∞ÄÎ≤àÌò∏ Ïû¨ÏÑ§Ï†ï
        async function resetPassword(empId) {
            if (!confirm('Ïù¥ ÏßÅÏõêÏùò ÎπÑÎ∞ÄÎ≤àÌò∏Î•º Ïû¨ÏÑ§Ï†ïÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;
            
            try {
                const response = await fetch(`/api/employees/${empId}/reset-password`, {
                    method: 'PUT'
                });
                const result = await response.json();
                
                if (result.success) {
                    showAlert(`ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä Ïû¨ÏÑ§Ï†ïÎêòÏóàÏäµÎãàÎã§. ÏÉà ÎπÑÎ∞ÄÎ≤àÌò∏: ${result.new_password}`, 'success');
                } else {
                    showAlert('ÎπÑÎ∞ÄÎ≤àÌò∏ Ïû¨ÏÑ§Ï†ïÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
                }
            } catch (error) {
                showAlert('ÏÑúÎ≤Ñ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
            }
        }

        // ÏßÅÏõê ÏÇ≠Ï†ú
        async function deleteEmployee(empId) {
            if (!confirm('Ï†ïÎßêÎ°ú Ïù¥ ÏßÅÏõêÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå? Ïù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§.')) return;
            
            try {
                const response = await fetch(`/api/employees/${empId}`, {
                    method: 'DELETE'
                });
                const result = await response.json();
                
                if (result.success) {
                    showAlert('ÏßÅÏõêÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.', 'success');
                    loadTeamLeaderEmployees();
                } else {
                    showAlert(result.message || 'ÏÇ≠Ï†úÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
                }
            } catch (error) {
                showAlert('ÏÑúÎ≤Ñ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
            }
        }

        // ÏïåÎ¶º ÌëúÏãú Ìï®Ïàò
        function showAlert(message, type) {
            // Í∏∞Ï°¥ ÏïåÎ¶ºÏù¥ ÏûàÎã§Î©¥ Ï†úÍ±∞
            const existingAlert = document.querySelector('.alert-message');
            if (existingAlert) {
                existingAlert.remove();
            }
            
            const alert = document.createElement('div');
            alert.className = 'alert-message';
            alert.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 12px 20px;
                border-radius: 8px;
                font-weight: 500;
                z-index: 10000;
                opacity: 0;
                transition: all 0.3s ease;
                ${type === 'success' ? 'background: #dcfce7; color: #166534; border: 1px solid #bbf7d0;' : 'background: #fee2e2; color: #991b1b; border: 1px solid #fecaca;'}
            `;
            alert.textContent = message;
            
            document.body.appendChild(alert);
            
            // Ïï†ÎãàÎ©îÏù¥ÏÖò Ìö®Í≥º
            requestAnimationFrame(() => {
                alert.style.opacity = '1';
            });
            
            // 3Ï¥à ÌõÑ ÏûêÎèô Ï†úÍ±∞
            setTimeout(() => {
                alert.style.opacity = '0';
                setTimeout(() => {
                    if (alert.parentNode) {
                        alert.parentNode.removeChild(alert);
                    }
                }, 300);
            }, 3000);
        }

        // ÌåÄ Í¥ÄÎ¶¨ Î™®Îã¨ Ìï®ÏàòÎì§
        function showAddTeamModal() {
            const modal = document.getElementById('addTeamModal');
            if (modal) {
                modal.style.display = 'flex';
                modal.classList.add('active');
                document.getElementById('newTeamName').value = '';
                document.getElementById('newTeamDescription').value = '';
                document.getElementById('newTeamName').focus();
            }
        }

        function closeAddTeamModal() {
            const modal = document.getElementById('addTeamModal');
            if (modal) {
                modal.style.display = 'none';
                modal.classList.remove('active');
            }
        }

        async function addNewTeam() {
            const teamName = document.getElementById('newTeamName').value.trim();
            const teamDescription = document.getElementById('newTeamDescription').value.trim();
            
            if (!teamName) {
                showAlert('ÌåÄ Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'error');
                return;
            }
            
            try {
                // ÌåÄ Ï∂îÍ∞Ä API Ìò∏Ï∂ú (ÌïÑÏöîÏãú Íµ¨ÌòÑ)
                showAlert(`ÏÉà ÌåÄ "${teamName}"Ïù¥ Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§.`, 'success');
                
                // ÌåÄ ÎìúÎ°≠Îã§Ïö¥ ÏóÖÎç∞Ïù¥Ìä∏
                const teamSelect = document.getElementById('team');
                const deleteTeamSelect = document.getElementById('deleteTeamSelect');
                
                // ÏÉà ÏòµÏÖò Ï∂îÍ∞Ä
                const newOption = document.createElement('option');
                newOption.value = teamName;
                newOption.textContent = teamName;
                
                if (teamSelect) {
                    teamSelect.appendChild(newOption.cloneNode(true));
                }
                if (deleteTeamSelect) {
                    deleteTeamSelect.appendChild(newOption);
                }
                
                closeAddTeamModal();
            } catch (error) {
                console.error('ÌåÄ Ï∂îÍ∞Ä Ïò§Î•ò:', error);
                showAlert('ÌåÄ Ï∂îÍ∞ÄÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
            }
        }

        async function deleteSelectedTeam() {
            const teamSelect = document.getElementById('deleteTeamSelect');
            const selectedTeam = teamSelect ? teamSelect.value : '';
            
            if (!selectedTeam) {
                showAlert('ÏÇ≠Ï†úÌï† ÌåÄÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.', 'error');
                return;
            }
            
            if (!confirm(`Ï†ïÎßêÎ°ú "${selectedTeam}" ÌåÄÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) {
                return;
            }
            
            try {
                // ÌåÄ ÏÇ≠Ï†ú API Ìò∏Ï∂ú (ÌïÑÏöîÏãú Íµ¨ÌòÑ)
                showAlert(`"${selectedTeam}" ÌåÄÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.`, 'success');
                
                // ÎìúÎ°≠Îã§Ïö¥ÏóêÏÑú Ï†úÍ±∞
                const teamMainSelect = document.getElementById('team');
                if (teamMainSelect) {
                    const option = teamMainSelect.querySelector(`option[value="${selectedTeam}"]`);
                    if (option) option.remove();
                }
                
                if (teamSelect) {
                    const option = teamSelect.querySelector(`option[value="${selectedTeam}"]`);
                    if (option) option.remove();
                    teamSelect.value = '';
                }
            } catch (error) {
                console.error('ÌåÄ ÏÇ≠Ï†ú Ïò§Î•ò:', error);
                showAlert('ÌåÄ ÏÇ≠Ï†úÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
            }
        }

        // Ìèº Ï†úÏ∂ú Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï∂îÍ∞Ä
        document.addEventListener('DOMContentLoaded', function() {
            const employeeForm = document.getElementById('add-employee-form');
            if (employeeForm) {
                employeeForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const isEditMode = this.getAttribute('data-edit-mode') === 'true';
                    const employeeId = this.getAttribute('data-employee-id');
                    
                    const data = {
                        employee_id: document.getElementById('employee_id').value,
                        employee_name: document.getElementById('employee_name').value,
                        team: document.getElementById('team').value,
                        employee_role: document.getElementById('employee_role').value,
                        employee_status: document.getElementById('employee_status').value
                    };
                    
                    try {
                        let response;
                        if (isEditMode && employeeId) {
                            // ÏàòÏ†ï Î™®Îìú
                            response = await fetch(`/api/employees/${employeeId}/update`, {
                                method: 'PUT',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify(data)
                            });
                        } else {
                            // Ï∂îÍ∞Ä Î™®Îìú
                            response = await fetch('/api/employees', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify(data)
                            });
                        }
                        
                        const result = await response.json();
                        
                        if (result.success) {
                            showAlert(isEditMode ? 'ÏßÅÏõê Ï†ïÎ≥¥Í∞Ä ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§.' : 'ÏßÅÏõêÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§.', 'success');
                            resetEmployeeForm();
                            loadTeamLeaderEmployees();
                            closeAddEmployeeModal();
                        } else {
                            showAlert(result.message || (isEditMode ? 'ÏßÅÏõê ÏàòÏ†ïÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.' : 'ÏßÅÏõê Ï∂îÍ∞ÄÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.'), 'error');
                        }
                    } catch (error) {
                        console.error('ÏßÅÏõê Ï†ÄÏû• Ïò§Î•ò:', error);
                        showAlert('ÏÑúÎ≤Ñ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
                    }
                });
            }
        });
    </script>

    <!-- Î©îÎ™® Î™®Îã¨ -->
    <div id="property-memo-modal" class="modal-overlay" onclick="closePropertyMemoModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 class="modal-title">üìù Îß§Î¨º ÌäπÏù¥ÏÇ¨Ìï≠ Ìé∏Ïßë</h3>
                <button class="modal-close" onclick="closePropertyMemoModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="memo-info">
                    <div class="memo-property-info">
                        <span class="memo-label">Îß§Î¨º:</span>
                        <span id="property-memo-info" class="memo-value">Îèô-Ìò∏Ïàò</span>
                    </div>
                </div>
                <textarea id="property-memo-textarea" class="memo-textarea" placeholder="Îß§Î¨ºÏùò ÌäπÏù¥ÏÇ¨Ìï≠ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..." rows="8"></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closePropertyMemoModal()">Ï∑®ÏÜå</button>
                <button class="btn btn-primary" onclick="savePropertyMemo()">Ï†ÄÏû•</button>
            </div>
        </div>
    </div>

    <!-- Ï¢ãÏïÑÏöî/Ïã´Ïñ¥Ïöî Î™®Îã¨ -->
    <div id="likes-modal" class="modal-overlay" onclick="closeLikesModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 class="modal-title" id="likes-modal-title">‚ù§Ô∏è Ï¢ãÏïÑÏöî Ìé∏Ïßë</h3>
                <button class="modal-close" onclick="closeLikesModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="likes-info">
                    <div class="likes-property-info">
                        <span class="likes-label">Îß§Î¨º:</span>
                        <span id="likes-property-info" class="likes-value">Îèô-Ìò∏Ïàò</span>
                    </div>
                </div>
                <div class="likes-input-group">
                    <label class="likes-input-label" id="likes-input-label">Ï¢ãÏïÑÏöî Ïàò:</label>
                    <input type="number" id="likes-input" class="likes-input" min="0" value="0" placeholder="Ïà´Ïûê ÏûÖÎ†•">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeLikesModal()">Ï∑®ÏÜå</button>
                <button class="btn btn-primary" onclick="saveLikes()">Ï†ÄÏû•</button>
            </div>
        </div>
    </div>

    <style>
        /* Î©îÎ™® Î™®Îã¨ Ïä§ÌÉÄÏùº */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 1px solid #e2e8f0;
            background: #f8fafc;
        }
        
        .modal-title {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #6b7280;
            padding: 0;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-close:hover {
            background: #f3f4f6;
            color: #374151;
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .memo-info {
            margin-bottom: 16px;
        }
        
        .memo-property-info {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: #f1f5f9;
            border-radius: 6px;
            border-left: 4px solid #3b82f6;
        }
        
        .memo-label {
            font-weight: 600;
            color: #475569;
        }
        
        .memo-value {
            color: #1e40af;
            font-weight: 500;
        }
        
        .memo-textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            line-height: 1.5;
            resize: vertical;
            font-family: inherit;
        }
        
        .memo-textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 8px;
            padding: 16px 20px;
            border-top: 1px solid #e2e8f0;
            background: #f8fafc;
        }
        
        /* Ï¢ãÏïÑÏöî/Ïã´Ïñ¥Ïöî Î™®Îã¨ Ï†ÑÏö© Ïä§ÌÉÄÏùº */
        .likes-info {
            margin-bottom: 16px;
        }
        
        .likes-property-info {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: #f1f5f9;
            border-radius: 6px;
            border-left: 4px solid #ef4444;
        }
        
        .likes-label {
            font-weight: 600;
            color: #475569;
        }
        
        .likes-value {
            color: #dc2626;
            font-weight: 500;
        }
        
        .likes-input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .likes-input-label {
            font-weight: 600;
            color: #374151;
            font-size: 14px;
        }
        
        .likes-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 16px;
            text-align: center;
            font-weight: 600;
        }
        
        .likes-input:focus {
            outline: none;
            border-color: #ef4444;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }
    </style>
    <!-- ÏßÅÏõê Ï∂îÍ∞Ä Î™®Îã¨ -->
    <div id="addEmployeeModal" class="modal" style="display: none;">
        <div class="modal-overlay" onclick="closeAddEmployeeModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">
                    <span style="font-size: 20px;">üë§</span>
                    ÏÉà ÏßÅÏõê Ï∂îÍ∞Ä
                </h2>
                <button type="button" class="modal-close" onclick="closeAddEmployeeModal()">
                    <span>‚úï</span>
                </button>
            </div>
            <form id="add-employee-form" class="add-employee-form">
                <div class="modal-body">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px;">
                        <div class="form-group" style="margin: 0;">
                            <label class="form-label">ÏßÅÏõê ÏïÑÏù¥Îîî</label>
                            <input type="text" id="employee_id" class="form-input" placeholder="ÏßÅÏõê ÏïÑÏù¥Îîî ÏûÖÎ†•" required>
                        </div>
                        <div class="form-group" style="margin: 0;">
                            <label class="form-label">ÏßÅÏõê Ïù¥Î¶Ñ</label>
                            <input type="text" id="employee_name" class="form-input" placeholder="ÏßÅÏõê Ïù¥Î¶Ñ ÏûÖÎ†•" required>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px;">
                        <div class="form-group" style="margin: 0;">
                            <label class="form-label">ÌåÄ</label>
                            <div style="display: flex; gap: 8px; align-items: end;">
                                <select id="team" class="form-input" required style="flex: 1;">
                                    <option value="">ÌåÄ ÏÑ†ÌÉù</option>
                                    <option value="ÎπàÏãúÌä∏">ÎπàÏãúÌä∏</option>
                                    <option value="ÏúÑÌîåÎü¨Ïä§">ÏúÑÌîåÎü¨Ïä§</option>
                                    <option value="Î∞òÌÅ¥Î¶¨ÏÖ∞">Î∞òÌÅ¥Î¶¨ÏÖ∞</option>
                                    <option value="ÎåÄÌëú">ÎåÄÌëú</option>
                                </select>
                                <button type="button" class="btn btn-outline-primary btn-sm" onclick="showAddTeamModal()">
                                    <span>‚ûï</span>
                                </button>
                            </div>
                        </div>
                        <div class="form-group" style="margin: 0;">
                            <label class="form-label">Ïó≠Ìï†</label>
                            <select id="employee_role" class="form-input" required>
                                <option value="">Ïó≠Ìï† ÏÑ†ÌÉù</option>
                                <option value="ÌåÄÏû•">ÌåÄÏû•</option>
                                <option value="ÏßÅÏõê">ÏßÅÏõê</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 0;">
                        <label class="form-label">ÏÉÅÌÉú</label>
                        <select id="employee_status" class="form-input" required>
                            <option value="active">ÌôúÏÑ±</option>
                            <option value="inactive">ÎπÑÌôúÏÑ±</option>
                        </select>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeAddEmployeeModal()">
                        <span>‚ùå</span> Ï∑®ÏÜå
                    </button>
                    <button type="submit" class="btn btn-primary" id="add-btn">
                        <span>‚ûï</span> ÏßÅÏõê Ï∂îÍ∞Ä
                    </button>
                </div>
            </form>
        </div>
    </div>

</body>
</html>
