<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê´€ë¦¬ì íŒ¨ë„ - ì§‘ë…¸íŠ¸ CRM</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f8fafc;
            color: #1a202c;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .app-container {
            display: flex;
            height: 100vh;
        }
        
        /* ì‚¬ì´ë“œë°” */
        .sidebar {
            width: 260px;
            background: #ffffff;
            border-right: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            z-index: 1000;
        }
        
        .sidebar-header {
            padding: 24px 20px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .logo-text {
            font-size: 18px;
            font-weight: 700;
            color: #1a202c;
        }
        
        .sidebar-nav {
            flex: 1;
            padding: 20px 0;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            color: #64748b;
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }
        
        .nav-item:hover {
            background: #f1f5f9;
            color: #6366f1;
        }
        
        .nav-item.active {
            background: #f1f5f9;
            color: #6366f1;
            border-left-color: #6366f1;
        }
        
        .nav-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* ë©”ì´í”Œê´€ë¦¬ ìˆ˜ì •/ì™„ë£Œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .edit-controls {
            display: flex;
            gap: 4px;
            align-items: center;
        }
        
        .edit-controls .btn {
            font-size: 11px;
            padding: 4px 8px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        /* íƒ­ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .tab-btn {
            background: none;
            border: none;
            padding: 12px 16px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: #64748b;
            border-bottom: 2px solid transparent;
            transition: all 0.2s ease;
            margin-right: 8px;
        }
        
        .tab-btn:hover {
            color: #1e293b;
            background: rgba(59, 130, 246, 0.05);
        }
        
        .tab-btn.active {
            color: #3b82f6;
            border-bottom-color: #3b82f6;
            background: rgba(59, 130, 246, 0.05);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .edit-controls .edit-btn {
            background-color: #3b82f6;
            color: white;
        }
        
        .edit-controls .edit-btn:hover {
            background-color: #2563eb;
        }
        
        .edit-controls .save-btn {
            background-color: #10b981;
            color: white;
        }
        
        .edit-controls .save-btn:hover {
            background-color: #059669;
        }
        
        .edit-controls .cancel-btn {
            background-color: #6b7280;
            color: white;
        }
        
        .edit-controls .cancel-btn:hover {
            background-color: #4b5563;
        }
        
        /* í¸ì§‘ ì¤‘ì¸ ì…€ ìŠ¤íƒ€ì¼ */
        .editing {
            background-color: #fef3c7 !important;
            border: 2px solid #f59e0b !important;
            padding: 2px !important;
        }
        
        .editing input, .editing select, .editing textarea {
            border: 1px solid #d97706;
            background-color: #fffbeb;
            font-size: 12px;
        }
        
        .edit-input {
            width: 100%;
            padding: 4px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
        }
        
        .edit-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
        }
        
        /* í˜„í™© ì„ íƒ ë²„íŠ¼ ìŠ¤íƒ€ì¼ (ì§ì›í˜ì´ì§€ ë°©ì‹) */
        .status-selector {
            padding: 8px;
        }
        
        .status-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 6px;
        }
        
        .status-option {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            background: #ffffff;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 12px;
        }
        
        .status-option:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
        }
        
        .status-option.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        .status-icon {
            font-size: 14px;
        }
        
        .status-text {
            font-weight: 500;
        }
        
        /* í¸ì§‘ ì¤‘ì¸ ì…€ ìŠ¤íƒ€ì¼ */
        .editing-cell {
            background-color: #fef3c7 !important;
            border: 2px solid #f59e0b !important;
            padding: 2px !important;
        }
        
        /* ìˆ˜ì • ëª¨ë“œ í™œì„±í™”ëœ í–‰ ìŠ¤íƒ€ì¼ */
        .edit-mode {
            background-color: #f0f9ff !important;
        }
        
        .edit-mode .editable-cell {
            transition: all 0.2s ease;
        }
        
        .edit-mode .editable-cell:hover {
            background-color: #dbeafe !important;
            transform: scale(1.02);
        }
        
        /* ì‹¤ê±°ì£¼ ì—¬ë¶€ ì„ íƒ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .occupied-selector {
            padding: 8px;
        }
        
        .occupied-options {
            display: flex;
            gap: 8px;
        }
        
        .occupied-option {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            background: #ffffff;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 12px;
            flex: 1;
        }
        
        .occupied-option:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
        }
        
        .occupied-option.active {
            background: #10b981;
            color: white;
            border-color: #10b981;
        }
        
        /* ì¢‹ì•„ìš”/ì‹«ì–´ìš” ì„ íƒ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .likes-selector, .dislikes-selector {
            padding: 8px;
        }
        
        .likes-options, .dislikes-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 4px;
        }
        
        .likes-option, .dislikes-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 6px 4px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            background: #ffffff;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 11px;
        }
        
        .likes-option:hover, .dislikes-option:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
        }
        
        .likes-option.active {
            background: #ec4899;
            color: white;
            border-color: #ec4899;
        }
        
        .dislikes-option.active {
            background: #ef4444;
            color: white;
            border-color: #ef4444;
        }
        
        .likes-icon, .dislikes-icon {
            font-size: 14px;
        }
        
        .likes-text, .dislikes-text {
            font-weight: 500;
        }
        
        /* ë©”ëª¨ ì…€ ìŠ¤íƒ€ì¼ */
        .memo-cell:hover {
            background-color: #f8fafc !important;
            border: 1px solid #3b82f6 !important;
        }
        
        .memo-cell:hover .memo-icon {
            transform: scale(1.1);
        }
        
        /* ë§¤ë¬¼ ë©”ëª¨ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ (ì§ì›í˜ì´ì§€ì™€ ë™ì¼) */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-overlay .modal-content {
            background: #ffffff;
            border-radius: 16px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        
        .modal-overlay.active .modal-content {
            transform: scale(1);
        }
        
        .modal-overlay .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .modal-overlay .modal-title {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
        }
        
        .modal-overlay .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: #6b7280;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }
        
        .modal-overlay .modal-close:hover {
            background: #f1f5f9;
            color: #374151;
        }
        
        .modal-overlay .modal-body {
            padding: 24px;
        }
        
        .memo-textarea {
            width: 100%;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 12px 16px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            min-height: 120px;
            transition: all 0.2s ease;
            outline: none;
        }
        
        .memo-textarea:focus {
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .memo-info {
            margin-bottom: 16px;
            padding: 12px;
            background: #f8fafc;
            border-radius: 8px;
        }
        
        .memo-property-info {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .memo-label {
            font-weight: 500;
            color: #374151;
            font-size: 14px;
        }
        
        .memo-value {
            color: #6366f1;
            font-weight: 600;
            font-size: 14px;
        }
        
        .modal-overlay .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }
        
        .modal-overlay .btn {
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            border: none;
            transition: all 0.2s ease;
        }
        
        .modal-overlay .btn-secondary {
            background: #f8fafc;
            color: #64748b;
            border: 1px solid #e2e8f0;
        }
        
        .modal-overlay .btn-secondary:hover {
            background: #e2e8f0;
            color: #475569;
        }
        
        .modal-overlay .btn-primary {
            background: #6366f1;
            color: white;
        }
        
        .modal-overlay .btn-primary:hover {
            background: #5855eb;
        }
        
        /* ë©”ì¸ ì»¨í…ì¸  */
        .main-content {
            flex: 1;
            margin-left: 260px;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background: #ffffff;
            border-bottom: 1px solid #e2e8f0;
            padding: 16px 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .search-box {
            position: relative;
        }
        
        .search-input {
            width: 300px;
            padding: 10px 16px 10px 40px;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            background: #f8fafc;
            font-size: 14px;
            outline: none;
            transition: all 0.2s ease;
        }
        
        .search-input:focus {
            border-color: #6366f1;
            background: #ffffff;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        /* ì‚¬ì´íŠ¸ ì „í™˜ ë“œë¡­ë‹¤ìš´ */
        .site-switcher {
            position: relative;
        }
        
        .site-switcher-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(99, 102, 241, 0.3);
        }
        
        .site-switcher-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(99, 102, 241, 0.4);
        }
        
        .site-switcher-btn::after {
            content: 'â–¼';
            font-size: 10px;
            margin-left: 4px;
            transition: transform 0.2s ease;
        }
        
        .site-switcher.active .site-switcher-btn::after {
            transform: rotate(180deg);
        }

        /* ëŒ€ì‹œë³´ë“œ í†µê³„ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .stat-title {
            font-size: 16px;
            font-weight: 600;
            color: #64748b;
            margin: 0;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: #1a202c;
            margin-bottom: 8px;
        }

        .stat-change {
            font-size: 14px;
            color: #64748b;
        }

        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 0;
            border: 1px solid #888;
            width: 90%;
            max-width: 500px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        }
        
        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            margin: 0;
            color: #1a202c;
            font-size: 18px;
            font-weight: 600;
        }
        
        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }
        
        .close:hover,
        .close:focus {
            color: #000;
        }
        
        .modal-body {
            padding: 24px;
        }
        
        .modal-footer {
            padding: 20px 24px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }
        
        /* íŒ€ ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .team-section {
            margin-bottom: 16px;
        }
        
        .team-section h4 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        /* í•„í„° ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .filter-section {
            padding: 16px 24px;
            border-bottom: 1px solid #e2e8f0;
            background: #ffffff;
            display: flex;
            gap: 24px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .filter-label {
            font-size: 14px;
            font-weight: 600;
            color: #64748b;
            white-space: nowrap;
        }

        .filter-buttons {
            display: flex;
            gap: 8px;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 1px solid #e2e8f0;
            background: #ffffff;
            color: #64748b;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .filter-btn:hover {
            border-color: #6366f1;
            color: #6366f1;
        }

        .filter-btn.active {
            background: #6366f1;
            color: #ffffff;
            border-color: #6366f1;
        }

        /* í…Œì´ë¸” ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        .table-container {
            overflow-x: auto;
            padding: 0 24px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 0;
        }

        .data-table th {
            background: #f8fafc;
            padding: 16px 12px;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 1px solid #e2e8f0;
            font-size: 14px;
        }

        .data-table td {
            padding: 16px 12px;
            border-bottom: 1px solid #f1f5f9;
            color: #374151;
            font-size: 14px;
        }

        .data-table tbody tr:hover {
            background: #f8fafc;
        }

        /* ìƒíƒœ ë°°ì§€ ìŠ¤íƒ€ì¼ */
        .status-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            text-align: center;
            display: inline-block;
        }

        .status-badge.progress {
            background: #fef3c7;
            color: #f59e0b;
        }

        .status-badge.completed {
            background: #dcfce7;
            color: #16a34a;
        }

        .status-badge.pending {
            background: #f1f5f9;
            color: #64748b;
        }

        /* í˜ì´ì§€ë„¤ì´ì…˜ ìŠ¤íƒ€ì¼ */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 24px;
            padding: 20px;
        }

        .pagination .btn {
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            background: #ffffff;
            color: #64748b;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .pagination .btn:hover {
            border-color: #6366f1;
            color: #6366f1;
        }

        .pagination .btn.btn-primary {
            background: #6366f1;
            color: #ffffff;
            border-color: #6366f1;
        }
        
        .site-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            min-width: 220px;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.2s ease;
            z-index: 1000;
        }
        
        .site-switcher.active .site-dropdown {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .dropdown-header {
            padding: 16px;
            border-bottom: 1px solid #e2e8f0;
            font-weight: 600;
            color: #1a202c;
            font-size: 14px;
        }
        
        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            color: #374151;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }
        
        .dropdown-item:hover {
            background: #f9fafb;
            color: #6366f1;
            border-left-color: #6366f1;
        }
        
        .dropdown-item .item-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }
        
        .dropdown-item .item-info {
            flex: 1;
        }
        
        .dropdown-item .item-title {
            font-weight: 500;
            margin-bottom: 2px;
        }
        
        .dropdown-item .item-desc {
            font-size: 12px;
            color: #9ca3af;
        }
        
        .dropdown-item .item-badge {
            padding: 2px 8px;
            background: #fef3c7;
            color: #d97706;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
        }
        
        .dropdown-item.residential .item-badge {
            background: #dbeafe;
            color: #2563eb;
        }
        
        .dropdown-item.business .item-badge {
            background: #fef3c7;
            color: #d97706;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 12px;
            border-radius: 12px;
            background: #f8fafc;
        }
        
        .user-avatar {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 14px;
        }
        
        .user-info {
            display: flex;
            flex-direction: column;
        }
        
        .user-name {
            font-size: 14px;
            font-weight: 600;
            color: #1a202c;
        }
        
        .user-email {
            font-size: 12px;
            color: #64748b;
        }
        
        /* ì»¨í…ì¸  ì˜ì—­ */
        .content {
            flex: 1;
            padding: 32px;
            overflow-y: auto;
        }
        
        .page-header {
            margin-bottom: 32px;
        }
        
        .page-title {
            font-size: 28px;
            font-weight: 700;
            color: #1a202c;
            margin-bottom: 8px;
        }
        
        .page-subtitle {
            font-size: 16px;
            color: #64748b;
        }
        
        .card {
            background: #ffffff;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }
        
        .card-header {
            display: flex;
            align-items: center;
            justify-content: between;
            margin-bottom: 20px;
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: #1a202c;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .add-employee-form {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr auto;
            gap: 16px;
            align-items: end;
            margin-bottom: 24px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-label {
            font-size: 14px;
            font-weight: 500;
            color: #374151;
            margin-bottom: 6px;
        }
        
        .form-input, .form-select {
            padding: 14px 16px;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            font-size: 14px;
            background: #ffffff;
            transition: all 0.2s ease;
            outline: none;
        }
        
        .form-input:focus, .form-select:focus {
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .btn {
            padding: 14px 20px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }
        
        .btn-primary {
            background: #6366f1;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5855eb;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }
        
        .btn-secondary {
            background: #f1f5f9;
            color: #475569;
        }
        
        .btn-secondary:hover {
            background: #e2e8f0;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .btn-danger:hover {
            background: #dc2626;
        }
        
        .btn-success {
            background: #10b981;
            color: white;
        }
        
        .btn-success:hover {
            background: #059669;
        }
        
        .btn-sm {
            padding: 8px 12px;
            font-size: 12px;
        }
        
        .filter-section {
            display: flex;
            gap: 16px;
            align-items: center;
            margin-bottom: 20px;
            padding: 20px;
            background: #f8fafc;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .filter-label {
            font-size: 12px;
            font-weight: 500;
            color: #64748b;
        }
        
        .employees-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .employees-table th {
            background: #f8fafc;
            padding: 16px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            color: #374151;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .employees-table td {
            padding: 16px;
            border-bottom: 1px solid #f1f5f9;
            font-size: 14px;
        }
        
        .employees-table tr:hover {
            background: #f8fafc;
        }
        
        .status-badge {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-progress {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-complete {
            background: #dcfce7;
            color: #166534;
        }
        
        .status-hold {
            background: #fecaca;
            color: #991b1b;
        }
        
        .site-link {
            color: #3b82f6;
            text-decoration: none;
            font-size: 12px;
            padding: 2px 6px;
            border: 1px solid #3b82f6;
            border-radius: 4px;
            display: inline-block;
        }
        
        .site-link:hover {
            background: #3b82f6;
            color: white;
        }
        
        .status-active {
            background: #dcfce7;
            color: #166534;
        }
        
        .status-inactive {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        .alert {
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 24px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .alert-success {
            background: #dcfce7;
            color: #166534;
            border: 1px solid #bbf7d0;
        }
        
        .alert-error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
        }
        
        .loading {
            position: relative;
            color: transparent;
        }
        
        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #ffffff;
            animation: spin 1s ease-in-out infinite;
            transform: translate(-50%, -50%);
        }
        
        @keyframes spin {
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- ì‚¬ì´ë“œë°” -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">ğŸ </div>
                    <div class="logo-text">ì§‘ë…¸íŠ¸ CRM</div>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <a href="/admin" class="nav-item">
                    <div class="nav-icon">ğŸ“Š</div>
                    ê´€ë¦¬ì í™ˆ
                </a>
                <a href="#employee-section" class="nav-item active" onclick="activateEmployeeTab(event)">
                    <div class="nav-icon">ğŸ‘¥</div>
                    ì§ì› ê´€ë¦¬
                </a>
                <a href="#maeiple-section" class="nav-item" onclick="activateMaeipeTab(event)">
                    <div class="nav-icon">ğŸ¢</div>
                    ë©”ì´í”Œê´€ë¦¬
                </a>
                <!-- íŒ€ì¥ë©”ì´í”Œê´€ë¦¬ëŠ” ë©”ì´í”Œê´€ë¦¬ íƒ­ìœ¼ë¡œ í†µí•©ë¨ -->
                <a href="#team-leader-maeiple-section" class="nav-item" onclick="activateTeamLeaderMaeipleTab(event)" style="display:none;" id="team-leader-maeiple-nav">
                    <div class="nav-icon">ğŸ¢</div>
                    íŒ€ì¥ë©”ì´í”Œê´€ë¦¬
                </a>
                <a href="#dashboard-section" class="nav-item" onclick="activateDashboardTab(event)">
                    <div class="nav-icon">ğŸ‘¥</div>
                    ê³ ê° ê´€ë¦¬
                </a>
                <a href="#team-leader-customer-section" class="nav-item" onclick="activateTeamLeaderCustomerTab(event)" style="display:none;" id="team-leader-customer-nav">
                    <div class="nav-icon">ğŸ’¼</div>
                    íŒ€ì¥ê³ ê°ê´€ë¦¬
                </a>
                <a href="#guarantee-section" class="nav-item" onclick="activateGuaranteeTab(event)">
                    <div class="nav-icon">ğŸ›¡ï¸</div>
                    ë³´ì¦ë³´í—˜ ë§¤ë¬¼
                </a>
                <a href="/logout" class="nav-item">
                    <div class="nav-icon">ğŸšª</div>
                    ë¡œê·¸ì•„ì›ƒ
                </a>
            </nav>
        </div>
        
        <!-- ë©”ì¸ ì»¨í…ì¸  -->
        <div class="main-content">
            <!-- í—¤ë” -->
            <div class="header">
                <div class="header-left">
                    <div class="search-box">
                        <div class="search-icon">ğŸ”</div>
                        <input type="text" class="search-input" placeholder="ì§ì› ê²€ìƒ‰...">
                    </div>
                </div>
                
                <div class="header-right">
                    <!-- ì‚¬ì´íŠ¸ ì „í™˜ ë“œë¡­ë‹¤ìš´ -->
                    <div class="site-switcher" id="site-switcher">
                        <button class="site-switcher-btn" onclick="toggleSiteSwitcher()">
                            <span>ğŸ¢</span>
                            ì‚¬ì´íŠ¸ ê´€ë¦¬
                        </button>
                        <div class="site-dropdown">
                            <div class="dropdown-header">ë§¤ë¬¼ ì‚¬ì´íŠ¸ ì „í™˜</div>
                            <a href="{{ residence_site_url }}" target="_blank" class="dropdown-item residence">
                                <div class="item-icon">ğŸ </div>
                                <div class="item-info">
                                    <div class="item-title">ì£¼ê±° ì‚¬ì´íŠ¸</div>
                                    <div class="item-desc">ì•„íŒŒíŠ¸, ì›ë£¸, ì˜¤í”¼ìŠ¤í…” ë“± ì£¼ê±°ìš© ë§¤ë¬¼</div>
                                </div>
                                <div class="item-badge">ì£¼ê±°ìš©</div>
                            </a>
                            <a href="{{ business_site_url }}" target="_blank" class="dropdown-item business">
                                <div class="item-icon">ğŸ¢</div>
                                <div class="item-info">
                                    <div class="item-title">ì—…ë¬´ ì‚¬ì´íŠ¸</div>
                                    <div class="item-desc">ì˜¤í”¼ìŠ¤, ìƒê°€, ì—…ë¬´ê³µê°„ ë§¤ë¬¼</div>
                                </div>
                                <div class="item-badge">ì—…ë¬´ìš©</div>
                            </a>
                        </div>
                    </div>
                    
                    <div class="user-profile">
                        <div class="user-avatar" id="user-avatar">ê´€</div>
                        <div class="user-info">
                            <div class="user-name" id="user-name">ê´€ë¦¬ì</div>
                            <div class="user-role" id="user-role">ê´€ë¦¬ì</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ì»¨í…ì¸  -->
            <div class="content">
                <div class="page-header">
                    <h1 class="page-title">ê´€ë¦¬ì íŒ¨ë„</h1>
                    <p class="page-subtitle">ì§ì› ê´€ë¦¬, ë³´ì¦ë³´í—˜ ë§¤ë¬¼ ë° ì‹œìŠ¤í…œ ê´€ë¦¬</p>
                </div>
                
                <!-- Flask Flash ë©”ì‹œì§€ í‘œì‹œ -->
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}
                            {% if category == 'success' %}
                                <div class="alert alert-success" style="margin-bottom: 20px; padding: 16px; border-radius: 12px; background: #10b98126; border: 1px solid #10b981; color: #059669;">
                                    {{ message }}
                                </div>
                            {% else %}
                                <div class="alert alert-error" style="margin-bottom: 20px; padding: 16px; border-radius: 12px; background: #ef444426; border: 1px solid #ef4444; color: #dc2626;">
                                    {{ message }}
                                </div>
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                {% endwith %}
                
                <div id="alert-container"></div>

                <!-- ì‚¬ì´ë“œë°” ë©”ë‰´ë¡œ íƒ­ ê¸°ëŠ¥ ëŒ€ì²´ -->

                <!-- ì§ì›ê´€ë¦¬ ì¹´ë“œ (íƒ­) -->
                <div id="employee-section">
                    <!-- ìƒˆ ì§ì› ì¶”ê°€ í† ê¸€ ë²„íŠ¼ -->
                    <button class="btn btn-primary" style="margin-bottom:12px; border-radius:10px; font-size:15px; padding:10px 18px; font-weight:600;" onclick="toggleAddEmployee()">
                        <span style="font-size:18px;">â•</span> ìƒˆ ì§ì› ì¶”ê°€
                    </button>
                    <!-- ìƒˆ ì§ì› ì¶”ê°€ ì¹´ë“œ (ê¸°ë³¸ ìˆ¨ê¹€) -->
                    <div class="card" id="add-employee-card" style="display:none; transition: max-height 0.3s; overflow:hidden;">
                        <div class="card-header">
                            <h2 class="card-title">
                                <span>â•</span>
                                ìƒˆ ì§ì› ì¶”ê°€
                            </h2>
                        </div>
                        <form id="add-employee-form" class="add-employee-form">
                            <div class="form-group">
                                <label class="form-label">ì§ì› ì•„ì´ë””</label>
                                <input type="text" id="employee_id" class="form-input" placeholder="ì§ì› ì•„ì´ë””" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ì§ì› ì´ë¦„</label>
                                <input type="text" id="employee_name" class="form-input" placeholder="ì§ì› ì´ë¦„" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">íŒ€</label>
                                <div style="display: flex; gap: 10px; align-items: end;">
                                    <select id="team" class="form-input" required style="background: white; cursor: pointer; flex: 1;">
                                    <option value="">íŒ€ ì„ íƒ</option>
                                    <option value="ë¹ˆì‹œíŠ¸">ë¹ˆì‹œíŠ¸</option>
                                    <option value="ìœ„í”ŒëŸ¬ìŠ¤">ìœ„í”ŒëŸ¬ìŠ¤</option>
                                    <option value="ë°˜í´ë¦¬ì…°">ë°˜í´ë¦¬ì…°</option>
                                    <option value="ëŒ€í‘œ">ëŒ€í‘œ</option>
                                </select>
                                    <button type="button" class="btn btn-outline-primary btn-sm" onclick="showAddTeamModal()" style="white-space: nowrap;">
                                        <span>â•</span> íŒ€ ì¶”ê°€
                                    </button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ì—­í• </label>
                                <select id="employee_role" class="form-input" required style="background: white; cursor: pointer;">
                                    <option value="">ì—­í•  ì„ íƒ</option>
                                    <option value="íŒ€ì¥">íŒ€ì¥</option>
                                    <option value="ì§ì›">ì§ì›</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ìƒíƒœ</label>
                                <select id="employee_status" class="form-input" required style="background: white; cursor: pointer;">
                                    <option value="active">í™œì„±</option>
                                    <option value="inactive">ë¹„í™œì„±</option>
                                </select>
                            </div>
                            <div class="form-group" style="display: flex; gap: 10px;">
                                <button type="submit" class="btn btn-primary" id="add-btn">
                                    <span>â•</span>
                                    ì§ì› ì¶”ê°€
                                </button>
                                <button type="button" class="btn btn-secondary" id="cancel-btn" onclick="resetEmployeeForm()" style="display: none;">
                                    <span>âŒ</span>
                                    ì·¨ì†Œ
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- íŒ€ ì¶”ê°€/ì‚­ì œ ëª¨ë‹¬ -->
                    <div id="addTeamModal" class="modal" style="display: none;">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>íŒ€ ê´€ë¦¬</h3>
                                <span class="close" onclick="closeAddTeamModal()">&times;</span>
                            </div>
                            <div class="modal-body">
                                <!-- íŒ€ ì¶”ê°€ ì„¹ì…˜ -->
                                <div class="team-section">
                                    <h4 style="margin-bottom: 16px; color: #374151;">â• ìƒˆ íŒ€ ì¶”ê°€</h4>
                                    <div class="form-group">
                                        <label for="newTeamName">íŒ€ ì´ë¦„</label>
                                        <input type="text" id="newTeamName" class="form-input" placeholder="íŒ€ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="newTeamDescription">íŒ€ ì„¤ëª… (ì„ íƒì‚¬í•­)</label>
                                        <textarea id="newTeamDescription" class="form-input" placeholder="íŒ€ì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”" rows="3"></textarea>
                                    </div>
                                    <button type="button" class="btn btn-primary" onclick="addNewTeam()" style="margin-bottom: 24px;">íŒ€ ì¶”ê°€</button>
                                </div>
                                
                                <hr style="margin: 24px 0; border: 1px solid #e5e7eb;">
                                
                                <!-- íŒ€ ì‚­ì œ ì„¹ì…˜ -->
                                <div class="team-section">
                                    <h4 style="margin-bottom: 16px; color: #374151;">ğŸ—‘ï¸ ê¸°ì¡´ íŒ€ ì‚­ì œ</h4>
                                    <div class="form-group">
                                        <label for="deleteTeamSelect">ì‚­ì œí•  íŒ€ ì„ íƒ</label>
                                        <select id="deleteTeamSelect" class="form-input" style="background: white; cursor: pointer;">
                                            <option value="">íŒ€ì„ ì„ íƒí•˜ì„¸ìš”</option>
                                            <option value="ë¹ˆì‹œíŠ¸">ë¹ˆì‹œíŠ¸</option>
                                            <option value="ìœ„í”ŒëŸ¬ìŠ¤">ìœ„í”ŒëŸ¬ìŠ¤</option>
                                            <option value="ë°˜í´ë¦¬ì…°">ë°˜í´ë¦¬ì…°</option>
                                            <option value="ëŒ€í‘œ">ëŒ€í‘œ</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="deleteTeamReason">ì‚­ì œ ì‚¬ìœ  (ì„ íƒì‚¬í•­)</label>
                                        <textarea id="deleteTeamReason" class="form-input" placeholder="íŒ€ ì‚­ì œ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”" rows="3"></textarea>
                                    </div>
                                    <button type="button" class="btn btn-danger" onclick="deleteTeam()">íŒ€ ì‚­ì œ</button>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" onclick="closeAddTeamModal()">ë‹«ê¸°</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ì§ì› ëª©ë¡ ì¹´ë“œ -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">
                                <span>ğŸ‘¥</span>
                                ì§ì› ëª©ë¡
                            </h2>
                        </div>
                        <!-- í•„í„° ì„¹ì…˜ -->
                        <div class="filter-section" style="display: flex; align-items: flex-end; gap: 20px; background: #f4f6fb; border-radius: 16px; border: 1px solid #e0e7ef; margin-bottom: 18px; padding: 18px 24px; box-shadow: 0 2px 8px rgba(99,102,241,0.04);">
                            <div class="filter-group" style="min-width: 80px;">
                                <label class="filter-label" style="font-size:13px; font-weight:600; color:#6366f1; margin-bottom:6px; display:flex; align-items:center; gap:6px;">
                                    <span style="font-size:16px;">ğŸ”</span> ìƒíƒœ
                                </label>
                                <select id="status-filter" class="form-select" style="width:80px; border-radius: 10px; border: 1.5px solid #c7d2fe; background: #fff; font-size:14px; padding:10px 14px;">
                                    <option value="">ì „ì²´</option>
                                    <option value="1">í™œì„±</option>
                                    <option value="0">ë¹„í™œì„±</option>
                                </select>
                            </div>
                            <div class="filter-group" style="min-width: 80px;">
                                <label class="filter-label" style="font-size:13px; font-weight:600; color:#6366f1; margin-bottom:6px; display:flex; align-items:center; gap:6px;">
                                    <span style="font-size:16px;">ğŸ‘¥</span> íŒ€
                                </label>
                                <select id="team-filter" class="form-select" style="width:80px; border-radius: 10px; border: 1.5px solid #c7d2fe; background: #fff; font-size:14px; padding:10px 14px;">
                                    <option value="">ì „ì²´ íŒ€</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin-left:auto;">
                                <button type="button" class="btn btn-secondary" style="border-radius:10px; font-size:14px; padding:10px 18px; background:#e0e7ff; color:#3730a3; border:1.5px solid #c7d2fe; font-weight:600; display:flex; align-items:center; gap:6px;" onclick="loadEmployees()">
                                    <span style="font-size:16px;">ğŸ”„</span>
                                    ìƒˆë¡œê³ ì¹¨
                                </button>
                            </div>
                        </div>
                        <div class="table-container">
                            <table class="employees-table">
                                <thead>
                                    <tr>
                                        <th>ì§ì› ì•„ì´ë””</th>
                                        <th>ì´ë¦„</th>
                                        <th>íŒ€</th>
                                        <th>ì—­í• </th>
                                        <th>ë“±ë¡ì¼</th>
                                        <th>ìƒíƒœ</th>
                                        <th>ì‘ì—…</th>
                                    </tr>
                                </thead>
                                <tbody id="employees-list">
                                    <!-- ì§ì› ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                                </tbody>
                            </table>
                                                </div>
                        
                        <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
                        <div id="employee-pagination" style="display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 20px; padding: 20px;">
                            <!-- í˜ì´ì§€ë„¤ì´ì…˜ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                        </div>
                    </div>
                </div>
                
                <!-- ë³´ì¦ë³´í—˜ ë§¤ë¬¼ ì¹´ë“œ (íƒ­) -->
                <div id="guarantee-section" style="display:none;">
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <h2 class="card-title">
                                <span>ğŸ›¡ï¸</span>
                                ë³´ì¦ë³´í—˜ ë§¤ë¬¼ ë¦¬ìŠ¤íŠ¸
                            </h2>
                            <div style="display: flex; gap: 16px; align-items: center;">
                                <span style="font-size: 14px; color: #64748b;">
                                    ì´ <strong style="color: #6366f1;">{{ guarantee_list|length if guarantee_list else 0 }}</strong>ê°œì˜ ë³´ì¦ë³´í—˜ ê°€ëŠ¥ ë§¤ë¬¼
                                </span>
                                <button type="button" class="btn btn-secondary btn-sm" onclick="location.reload()">
                                    <span>ğŸ”„</span> ìƒˆë¡œê³ ì¹¨
                                </button>
                            </div>
                        </div>
                        <div class="table-container">
                            <table class="employees-table">
                                <thead>
                                    <tr>
                                        <th>ë²ˆí˜¸</th>
                                        <th>URL</th>
                                        <th>í”Œë«í¼</th>
                                        <th>ë“±ë¡ì</th>
                                        <th>ë“±ë¡ì¼</th>
                                        <th>ë³´ì¦ë³´í—˜</th>
                                        <th>ë©”ëª¨</th>
                                        <th>ì‘ì—…</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% if guarantee_list and guarantee_list|length > 0 %}
                                        {% for row in guarantee_list %}
                                        <tr>
                                            <td>{{ loop.revindex }}</td>
                                            <td><a href="{{ row['url'] }}" target="_blank">{{ row['url'][:50] }}{% if row['url']|length > 50 %}...{% endif %}</a></td>
                                            <td>
                                                {% if row['platform'] == 'zigbang' %}
                                                    <span class="badge" style="background:#ff6b6b; color:white;">ì§ë°©</span>
                                                {% elif row['platform'] == 'naver' %}
                                                    <span class="badge" style="background:#03c75a; color:white;">ë„¤ì´ë²„</span>
                                                {% else %}
                                                    <span class="badge" style="background:#868e96; color:white;">{{ row['platform'] }}</span>
                                                {% endif %}
                                            </td>
                                            <td>{{ row['added_by'] }}</td>
                                            <td>{{ row['date_added'] }}</td>
                                            <td>
                                                <span class="badge" style="background:#22c55e; color:white;">
                                                    ğŸ›¡ï¸ ë³´ì¦ë³´í—˜ ê°€ëŠ¥
                                                </span>
                                            </td>
                                            <td>
                                                <form method="POST" action="{{ url_for('guarantee_edit', id=row['id']) }}" style="display:flex; gap:8px; align-items:center;">
                                                    <input type="text" name="memo" value="{{ row['memo'] or '' }}" placeholder="ë©”ëª¨ ì…ë ¥..." style="width:200px; padding:6px 10px; border:1px solid #e2e8f0; border-radius:8px; font-size:13px;">
                                                    <button type="submit" class="btn btn-sm btn-primary" style="display: flex; align-items: center; gap: 4px;">
                                                        <span>âœï¸</span> ìˆ˜ì •
                                                    </button>
                                                </form>
                                            </td>
                                            <td>
                                                <div style="display: flex; gap: 8px; align-items: center;">
                                                    <form method="POST" action="{{ url_for('guarantee_delete', id=row['id']) }}" style="display:inline;">
                                                        <button type="submit" class="btn btn-sm btn-danger" style="display: flex; align-items: center; gap: 4px;" onclick="return confirm('ì •ë§ë¡œ ì´ ë³´ì¦ë³´í—˜ ë§¤ë¬¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">
                                                            <span>ğŸ—‘ï¸</span> ì‚­ì œ
                                                        </button>
                                                    </form>
                                                </div>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    {% else %}
                                        <tr>
                                            <td colspan="8" style="text-align:center; color:#64748b; padding:40px;">
                                                <div style="font-size:16px; margin-bottom:8px;">ğŸ“‹ ë“±ë¡ëœ ë³´ì¦ë³´í—˜ ë§¤ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤.</div>
                                                <div style="font-size:14px; color:#94a3b8;">ì£¼ê±°ìš© ì‚¬ì´íŠ¸ì—ì„œ ë³´ì¦ë³´í—˜ ê°€ëŠ¥ ë§¤ë¬¼ì„ ë“±ë¡í•˜ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>
                                            </td>
                                        </tr>
                                    {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- ë©”ì´í”Œê´€ë¦¬ ì„¹ì…˜ (íƒ­) -->
                <div id="maeiple-section" style="display:none;">
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center; border-bottom: none;">
                            <h2 class="card-title">
                                <span>ğŸ¢</span>
                                ë©”ì´í”Œê´€ë¦¬
                            </h2>
                            <button type="button" class="btn btn-secondary" onclick="loadMaeipeProperties(1)" style="font-size: 12px; padding: 6px 12px; background: #e0e7ff; color: #3730a3; border: 1.5px solid #c7d2fe; font-weight: 600;">
                                <span>ğŸ”„</span> ìƒˆë¡œê³ ì¹¨
                            </button>
                        </div>
                        
                        <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
                        <div class="tab-navigation" style="border-bottom: 1px solid #e2e8f0; background: #f8fafc;">
                            <div style="display: flex; align-items: center; padding: 0 24px;">
                                <button class="tab-btn active" onclick="switchMaeipleTab('list')" data-tab="list">
                                    ì•„íŒŒíŠ¸ëª©ë¡
                                </button>

                                <div style="margin-left: auto;">
                                    <button class="btn btn-primary" onclick="addNewPropertyRow()" style="font-size: 12px; padding: 6px 12px;">+ ìƒˆ ë§¤ë¬¼ ì¶”ê°€</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- íƒ­ ì½˜í…ì¸  -->
                        <div id="maeiple-tab-list" class="tab-content active">
                        
                        <!-- í•„í„° ì„¹ì…˜ -->
                        <div class="filter-section" style="padding: 12px 24px; border-bottom: 1px solid #e2e8f0; background: #ffffff; display: flex; gap: 24px; flex-wrap: wrap; align-items: center;">
                            <!-- í˜¸ìˆ˜ ê²€ìƒ‰ -->
                            <div class="filter-group">
                                <span class="filter-label" style="color: #64748b; font-size: 13px; font-weight: 600; margin-right: 4px;">í˜¸ìˆ˜ ê²€ìƒ‰:</span>
                                <input type="text" id="room-search-admin" placeholder="í˜¸ìˆ˜ ì…ë ¥ (ì˜ˆ: 101, 102)" 
                                       style="padding: 6px 12px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 12px; width: 120px;"
                                       oninput="filterByRoomAdmin(this.value)">
                            </div>
                            
                            <!-- ê±°ë˜ ìœ í˜• í•„í„° -->
                            <div class="filter-group" id="deal-type-filter-group-admin">
                                <span class="filter-label" style="color: #64748b; font-size: 13px; font-weight: 600; margin-right: 4px;">ê±°ë˜ìœ í˜•:</span>
                                <div class="filter-buttons" style="display: flex; gap: 6px;">
                                    <button class="filter-btn active" data-value="all" onclick="setDealTypeFilterAdmin('all', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #e0e7ff; color: #4338ca; border-radius: 20px; font-size: 12px; cursor: pointer; font-weight: 600;">ì „ì²´</button>
                                    <button class="filter-btn" data-value="ì „ì„¸" onclick="setDealTypeFilterAdmin('ì „ì„¸', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ì „ì„¸</button>
                                    <button class="filter-btn" data-value="ì›”ì„¸" onclick="setDealTypeFilterAdmin('ì›”ì„¸', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ì›”ì„¸</button>
                                    <button class="filter-btn" data-value="ë§¤ë§¤" onclick="setDealTypeFilterAdmin('ë§¤ë§¤', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ë§¤ë§¤</button>
                                </div>
                            </div>
                            
                            <div class="filter-group" id="status-filter-group">
                                <span class="filter-label" style="color: #64748b; font-size: 13px; font-weight: 600; margin-right: 4px;">í˜„í™©:</span>
                                <div class="filter-buttons" style="display: flex; gap: 6px;">
                                    <button class="filter-btn active" data-value="all" onclick="setStatusFilter('all', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #e0e7ff; color: #4338ca; border-radius: 20px; font-size: 12px; cursor: pointer; font-weight: 600;">ì „ì²´</button>
                                    <button class="filter-btn" data-value="ê±°ë˜ê°€ëŠ¥" onclick="setStatusFilter('ê±°ë˜ê°€ëŠ¥', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ê±°ë˜ê°€ëŠ¥</button>
                                    <button class="filter-btn" data-value="ê³„ì•½ì™„ë£Œ" onclick="setStatusFilter('ê³„ì•½ì™„ë£Œ', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ê³„ì•½ì™„ë£Œ</button>
                                    <button class="filter-btn" data-value="ë³´ë¥˜" onclick="setStatusFilter('ë³´ë¥˜', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ë³´ë¥˜</button>
                                    <button class="filter-btn" data-value="ë¶€ì¬" onclick="setStatusFilter('ë¶€ì¬', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ë¶€ì¬</button>
                                </div>
                            </div>
                            <div class="filter-group" id="occupied-filter-group">
                                <span class="filter-label" style="color: #64748b; font-size: 13px; font-weight: 600; margin-right: 4px;">ì‹¤ê±°ì£¼:</span>
                                <div class="filter-buttons" style="display: flex; gap: 6px;">
                                    <button class="filter-btn active" data-value="all" onclick="setOccupiedFilter('all', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #e0e7ff; color: #4338ca; border-radius: 20px; font-size: 12px; cursor: pointer; font-weight: 600;">ì „ì²´</button>
                                    <button class="filter-btn" data-value="O" onclick="setOccupiedFilter('O', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">O</button>
                                    <button class="filter-btn" data-value="X" onclick="setOccupiedFilter('X', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">X</button>
                                </div>
                            </div>
                            
                            <!-- ë‹´ë‹¹ì ê²€ìƒ‰ -->
                            <div class="filter-group">
                                <span class="filter-label" style="color: #64748b; font-size: 13px; font-weight: 600; margin-right: 4px;">ë‹´ë‹¹ì ê²€ìƒ‰:</span>
                                <input type="text" id="employee-search-admin" placeholder="ë‹´ë‹¹ì ì´ë¦„ ì…ë ¥" 
                                       style="padding: 6px 12px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 12px; width: 120px;"
                                       oninput="filterByEmployeeAdmin(this.value)">
                            </div>
                            
                            <!-- íŒ€ í•„í„° -->
                            <div class="filter-group" id="team-filter-group-admin">
                                <span class="filter-label" style="color: #64748b; font-size: 13px; font-weight: 600; margin-right: 4px;">íŒ€:</span>
                                <div class="filter-buttons" style="display: flex; gap: 6px;">
                                    <button class="filter-btn active" data-value="all" onclick="setTeamFilterAdmin('all', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #e0e7ff; color: #4338ca; border-radius: 20px; font-size: 12px; cursor: pointer; font-weight: 600;">ì „ì²´</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ì¼ê´„ ì²˜ë¦¬ ì»¨íŠ¸ë¡¤ -->
                        <div id="bulk-actions-panel" style="display: none; padding: 12px 24px; background: #f8fafc; border-bottom: 1px solid #e2e8f0;">
                            <div style="display: flex; align-items: center; gap: 16px; flex-wrap: wrap;">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span style="font-size: 14px; font-weight: 600; color: #374151;">ì„ íƒëœ ë§¤ë¬¼:</span>
                                    <span id="selected-count" style="font-size: 14px; font-weight: 700; color: #3b82f6;">0ê°œ</span>
                                </div>
                                
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span style="font-size: 14px; font-weight: 600; color: #374151;">ë‹´ë‹¹ì ë³€ê²½:</span>
                                    <select id="bulk-employee-select" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 12px; min-width: 150px;">
                                        <option value="">ë‹´ë‹¹ì ì„ íƒ</option>
                                    </select>
                                    <button onclick="bulkAssignEmployee()" style="padding: 6px 12px; background: #3b82f6; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer;">ì ìš©</button>
                                </div>
                                
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span style="font-size: 14px; font-weight: 600; color: #374151;">íŒ€ ë³€ê²½:</span>
                                    <select id="bulk-team-select" style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 12px; min-width: 120px;">
                                        <option value="">íŒ€ ì„ íƒ</option>
                                    </select>
                                    <button onclick="bulkAssignTeam()" style="padding: 6px 12px; background: #059669; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer;">ì ìš©</button>
                                </div>
                                
                                <button onclick="clearSelection()" style="padding: 6px 12px; background: #6b7280; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer;">ì„ íƒ í•´ì œ</button>
                                <button onclick="bulkDeleteProperties()" style="padding: 6px 12px; background: #dc2626; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer;">ğŸ—‘ï¸ ì‚­ì œ</button>
                            </div>
                        </div>
                        
                        <div id="maeiple-table-content">
                            <div class="loading" style="text-align: center; padding: 40px; color: #64748b;">ë¡œë”© ì¤‘...</div>
                            </div>
                            
                        <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
                        <div id="maeiple-pagination" style="display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 20px; padding: 20px;">
                            <!-- í˜ì´ì§€ë„¤ì´ì…˜ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                        </div>
                        </div>
                        

                    </div>
                </div>

                <!-- íŒ€ì¥ë©”ì´í”Œê´€ë¦¬ ì„¹ì…˜ (íƒ­) -->
                <div id="team-maeiple-section" style="display:none;">
                    <!-- ë©”ì´í”Œìì´ í˜„í™© ì„¹ì…˜ -->
                    <div class="maeiple-section" style="margin-top: 20px; padding: 16px; background: #ffffff; border-radius: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); margin-bottom: 24px;">
                        <h3 class="section-title" style="font-size: 16px; font-weight: 600; color: #1a202c; margin-bottom: 16px; display: flex; align-items: center; gap: 6px;">ë©”ì´í”Œìì´</h3>
                        
                        <!-- ë©”ì´í”Œìì´ í†µê³„ ì¹´ë“œ -->
                        <div class="dashboard-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;">
                            <div class="stat-card" style="background: #ffffff; border-radius: 10px; padding: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                                <div class="stat-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                    <h3 class="stat-title" style="font-size: 12px; font-weight: 500; color: #64748b;">ì´ ì•„íŒŒíŠ¸</h3>
                                    <div class="stat-icon" style="width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; background: #f0f9ff; color: #0ea5e9;">ğŸ¢</div>
                                </div>
                                <div id="total-maeiple-team" class="stat-value" style="font-size: 20px; font-weight: 700; color: #1a202c; margin-bottom: 4px;">0</div>
                                <div class="stat-change" style="font-size: 11px; font-weight: 500; color: #64748b;">ì „ì²´ ë“±ë¡</div>
                            </div>
                            <div class="stat-card" style="background: #ffffff; border-radius: 10px; padding: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                                <div class="stat-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                    <h3 class="stat-title" style="font-size: 12px; font-weight: 500; color: #64748b;">ê±°ë˜ì¤‘</h3>
                                    <div class="stat-icon" style="width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; background: #fefce8; color: #ca8a04;">ğŸ”„</div>
                                </div>
                                <div id="available-maeiple-team" class="stat-value" style="font-size: 20px; font-weight: 700; color: #1a202c; margin-bottom: 4px;">0</div>
                                <div class="stat-change" style="font-size: 11px; font-weight: 500; color: #64748b;">ì§„í–‰ì¤‘</div>
                            </div>
                            <div class="stat-card" style="background: #ffffff; border-radius: 10px; padding: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                                <div class="stat-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                    <h3 class="stat-title" style="font-size: 12px; font-weight: 500; color: #64748b;">ê±°ë˜ì™„ë£Œ</h3>
                                    <div class="stat-icon" style="width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; background: #dcfce7; color: #16a34a;">âœ…</div>
                                </div>
                                <div id="completed-maeiple-team" class="stat-value" style="font-size: 20px; font-weight: 700; color: #1a202c; margin-bottom: 4px;">0</div>
                                <div class="stat-change" style="font-size: 11px; font-weight: 500; color: #64748b;">ì™„ë£Œ</div>
                            </div>
                            <div class="stat-card" style="background: #ffffff; border-radius: 10px; padding: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                                <div class="stat-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                    <h3 class="stat-title" style="font-size: 12px; font-weight: 500; color: #64748b;">ì´ë²ˆ ì£¼ ì‹ ê·œ</h3>
                                    <div class="stat-icon" style="width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; background: #fce7f3; color: #ec4899;">ğŸ“ˆ</div>
                                </div>
                                <div id="new-maeiple-team" class="stat-value" style="font-size: 20px; font-weight: 700; color: #1a202c; margin-bottom: 4px;">0</div>
                                <div class="stat-change" style="font-size: 11px; font-weight: 500; color: #64748b;">ì‹ ê·œ ë“±ë¡</div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <h2 class="card-title">
                                <span>ğŸ‘¥ğŸ¢</span>
                                íŒ€ì¥ë©”ì´í”Œê´€ë¦¬ - ìš°ë¦¬íŒ€ ë§¤ë¬¼ëª©ë¡
                            </h2>
                            <button class="btn btn-primary" onclick="addNewTeamPropertyRow()">+ ìƒˆ ë§¤ë¬¼ ì¶”ê°€</button>
                        </div>
                        
                        <!-- í•„í„° ì„¹ì…˜ -->
                        <div class="filter-section" style="padding: 12px 24px; border-bottom: 1px solid #e2e8f0; background: #ffffff; display: flex; gap: 24px; flex-wrap: wrap; align-items: center;">
                            <!-- í˜¸ìˆ˜ ê²€ìƒ‰ -->
                            <div class="filter-group">
                                <span class="filter-label" style="color: #64748b; font-size: 13px; font-weight: 600; margin-right: 4px;">í˜¸ìˆ˜ ê²€ìƒ‰:</span>
                                <input type="text" id="room-search-team" placeholder="í˜¸ìˆ˜ ì…ë ¥ (ì˜ˆ: 101, 102)" 
                                       style="padding: 6px 12px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 12px; width: 120px;"
                                       oninput="filterByRoomTeam(this.value)">
                            </div>
                            
                            <!-- ë‹´ë‹¹ì ê²€ìƒ‰ -->
                            <div class="filter-group">
                                <span class="filter-label" style="color: #64748b; font-size: 13px; font-weight: 600; margin-right: 4px;">ë‹´ë‹¹ì ê²€ìƒ‰:</span>
                                <input type="text" id="employee-search-team" placeholder="ë‹´ë‹¹ì ì´ë¦„ ì…ë ¥" 
                                       style="padding: 6px 12px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 12px; width: 120px;"
                                       oninput="filterByEmployeeTeam(this.value)">
                            </div>
                            
                            <!-- ê±°ë˜ ìœ í˜• í•„í„° -->
                            <div class="filter-group" id="deal-type-filter-group-team">
                                <span class="filter-label" style="color: #64748b; font-size: 13px; font-weight: 600; margin-right: 4px;">ê±°ë˜ìœ í˜•:</span>
                                <div class="filter-buttons" style="display: flex; gap: 6px;">
                                    <button class="filter-btn active" data-value="all" onclick="setDealTypeFilterTeam('all', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #e0e7ff; color: #4338ca; border-radius: 20px; font-size: 12px; cursor: pointer; font-weight: 600;">ì „ì²´</button>
                                    <button class="filter-btn" data-value="ì „ì„¸" onclick="setDealTypeFilterTeam('ì „ì„¸', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ì „ì„¸</button>
                                    <button class="filter-btn" data-value="ì›”ì„¸" onclick="setDealTypeFilterTeam('ì›”ì„¸', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ì›”ì„¸</button>
                                    <button class="filter-btn" data-value="ë§¤ë§¤" onclick="setDealTypeFilterTeam('ë§¤ë§¤', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ë§¤ë§¤</button>
                                </div>
                            </div>
                            
                            <div class="filter-group" id="status-filter-group-team">
                                <span class="filter-label" style="color: #64748b; font-size: 13px; font-weight: 600; margin-right: 4px;">í˜„í™©:</span>
                                <div class="filter-buttons" style="display: flex; gap: 6px;">
                                    <button class="filter-btn active" data-value="all" onclick="setStatusFilterTeam('all', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #e0e7ff; color: #4338ca; border-radius: 20px; font-size: 12px; cursor: pointer; font-weight: 600;">ì „ì²´</button>
                                    <button class="filter-btn" data-value="ê±°ë˜ê°€ëŠ¥" onclick="setStatusFilterTeam('ê±°ë˜ê°€ëŠ¥', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ê±°ë˜ê°€ëŠ¥</button>
                                    <button class="filter-btn" data-value="ê³„ì•½ì™„ë£Œ" onclick="setStatusFilterTeam('ê³„ì•½ì™„ë£Œ', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ê³„ì•½ì™„ë£Œ</button>
                                    <button class="filter-btn" data-value="ë³´ë¥˜" onclick="setStatusFilterTeam('ë³´ë¥˜', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ë³´ë¥˜</button>
                                    <button class="filter-btn" data-value="ë¶€ì¬" onclick="setStatusFilterTeam('ë¶€ì¬', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ë¶€ì¬</button>
                                </div>
                            </div>
                            <div class="filter-group" id="occupied-filter-group-team">
                                <span class="filter-label" style="color: #64748b; font-size: 13px; font-weight: 600; margin-right: 4px;">ì‹¤ê±°ì£¼:</span>
                                <div class="filter-buttons" style="display: flex; gap: 6px;">
                                    <button class="filter-btn active" data-value="all" onclick="setOccupiedFilterTeam('all', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #e0e7ff; color: #4338ca; border-radius: 20px; font-size: 12px; cursor: pointer; font-weight: 600;">ì „ì²´</button>
                                    <button class="filter-btn" data-value="O" onclick="setOccupiedFilterTeam('O', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">O</button>
                                    <button class="filter-btn" data-value="X" onclick="setOccupiedFilterTeam('X', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">X</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- í…Œì´ë¸” ì»¨í…Œì´ë„ˆ -->
                        <div class="table-container" style="background: white; border-radius: 12px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); overflow: hidden;">
                            <table class="maeiple-table" style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">
                                            <div class="sort-header" onclick="sortTable('check_date', 'team')" style="display: flex; align-items: center; gap: 4px; cursor: pointer; user-select: none;">
                                                í™•ì¸ì¼
                                                <span class="sort-icon" style="font-size: 12px; color: #9ca3af; transition: color 0.2s ease;">â†•ï¸</span>
                                            </div>
                                        </th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">
                                            <div class="sort-header" onclick="sortTable('building_number', 'team')" style="display: flex; align-items: center; gap: 4px; cursor: pointer; user-select: none;">
                                                ë™
                                                <span class="sort-icon" style="font-size: 12px; color: #9ca3af; transition: color 0.2s ease;">â†•ï¸</span>
                                            </div>
                                        </th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">
                                            <div class="sort-header" onclick="sortTable('room_number', 'team')" style="display: flex; align-items: center; gap: 4px; cursor: pointer; user-select: none;">
                                                í˜¸ìˆ˜
                                                <span class="sort-icon" style="font-size: 12px; color: #9ca3af; transition: color 0.2s ease;">â†•ï¸</span>
                                            </div>
                                        </th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ìƒíƒœ</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì „ì„¸ê°€</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì›”ì„¸</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ë§¤ë§¤ê°€</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì…ì£¼ì—¬ë¶€</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì—°ë½ì²˜</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ë©”ëª¨</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì¢‹ì•„ìš”</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì‹«ì–´ìš”</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ë‹´ë‹¹ì</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì‘ì—…</th>
                                    </tr>
                                </thead>
                                <tbody id="team-maeiple-table-body">
                                    <!-- ë°ì´í„°ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
                        <div id="team-maeiple-pagination" style="display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 20px; padding: 20px;">
                            <!-- í˜ì´ì§€ë„¤ì´ì…˜ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                        </div>
                    </div>
                </div>

                <!-- ì§ì› ëŒ€ì‹œë³´ë“œ ì„¹ì…˜ (ê³ ê° ê´€ë¦¬) -->
                <div id="dashboard-section" style="display:none;">
                    <!-- í†µê³„ ì¹´ë“œ -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px; margin-bottom: 32px;">
                        <div class="card" style="padding: 24px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                <h3 style="font-size: 16px; font-weight: 600; color: #64748b;">ì´ê³ ê°</h3>
                                <div style="width: 40px; height: 40px; background: #eef2ff; color: #6366f1; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px;">ğŸ‘¥</div>
                            </div>
                            <div id="total-customers-admin" style="font-size: 32px; font-weight: 700; color: #1a202c; margin-bottom: 8px;">0</div>
                            <div style="font-size: 14px; color: #64748b;">ì „ì²´ ì§ì› ê³ ê°</div>
                        </div>
                        <div class="card" style="padding: 24px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                <h3 style="font-size: 16px; font-weight: 600; color: #64748b;">ì§„í–‰ì¤‘</h3>
                                <div style="width: 40px; height: 40px; background: #fef3c7; color: #f59e0b; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px;">â³</div>
                            </div>
                            <div id="progress-customers-admin" style="font-size: 32px; font-weight: 700; color: #1a202c; margin-bottom: 8px;">0</div>
                            <div style="font-size: 14px; color: #64748b;">ì§„í–‰ ì¤‘ì¸ ê³ ê°</div>
                        </div>
                        <div class="card" style="padding: 24px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                <h3 style="font-size: 16px; font-weight: 600; color: #64748b;">ê³„ì•½</h3>
                                <div style="width: 40px; height: 40px; background: #dcfce7; color: #16a34a; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px;">âœ…</div>
                            </div>
                            <div id="completed-customers-admin" style="font-size: 32px; font-weight: 700; color: #1a202c; margin-bottom: 8px;">0</div>
                            <div style="font-size: 14px; color: #64748b;">ê³„ì•½ ì™„ë£Œ ê³ ê°</div>
                        </div>
                        <div class="card" style="padding: 24px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                <h3 style="font-size: 16px; font-weight: 600; color: #64748b;">ì´ë²ˆ ì£¼ ì‹ ê·œ</h3>
                                <div style="width: 40px; height: 40px; background: #fce7f3; color: #ec4899; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px;">ğŸ“ˆ</div>
                            </div>
                            <div id="new-customers-admin" style="font-size: 32px; font-weight: 700; color: #1a202c; margin-bottom: 8px;">0</div>
                            <div style="font-size: 14px; color: #64748b;">ì‹ ê·œ ê³ ê°</div>
                        </div>
                    </div>

                    <!-- ê³ ê° ëª©ë¡ ì¹´ë“œ -->
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <h2 class="card-title">
                                <span>ğŸ‘¥</span>
                                ì „ì²´ ê³ ê° ëª©ë¡ (ëª¨ë“  ì§ì›)
                            </h2>
                            <div style="display: flex; gap: 8px; align-items: center;">
                                <button type="button" class="btn btn-secondary" onclick="loadAllCustomers(1)" style="font-size: 12px; padding: 6px 12px; background: #e0e7ff; color: #3730a3; border: 1.5px solid #c7d2fe; font-weight: 600;">
                                    <span>ğŸ”„</span> ìƒˆë¡œê³ ì¹¨
                                </button>
                                <button class="btn btn-primary" onclick="addNewCustomerRow()">+ ê³ ê° ì¶”ê°€</button>
                            </div>
                        </div>
                        
                        <!-- í•„í„° ì„¹ì…˜ -->
                        <div style="padding: 16px 24px; border-bottom: 1px solid #e2e8f0; display: flex; gap: 16px; flex-wrap: wrap; align-items: center;">
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span style="font-size: 14px; font-weight: 600; color: #64748b;">ìƒíƒœ:</span>
                                <div style="display: flex; gap: 6px;">
                                    <button class="customer-filter-btn active" data-status="all" onclick="setCustomerFilter('all', this)" style="padding: 6px 12px; border: 1px solid #e2e8f0; background: #6366f1; color: white; border-radius: 20px; font-size: 12px; cursor: pointer; font-weight: 500;">ì „ì²´</button>
                                    <button class="customer-filter-btn" data-status="ìƒë‹´ì¤‘" onclick="setCustomerFilter('ìƒë‹´ì¤‘', this)" style="padding: 6px 12px; border: 1px solid #e2e8f0; background: white; color: #64748b; border-radius: 20px; font-size: 12px; cursor: pointer;">ìƒë‹´ì¤‘</button>
                                    <button class="customer-filter-btn" data-status="ê³„ì•½" onclick="setCustomerFilter('ê³„ì•½', this)" style="padding: 6px 12px; border: 1px solid #e2e8f0; background: white; color: #64748b; border-radius: 20px; font-size: 12px; cursor: pointer;">ê³„ì•½</button>
                                    <button class="customer-filter-btn" data-status="ë³´ë¥˜" onclick="setCustomerFilter('ë³´ë¥˜', this)" style="padding: 6px 12px; border: 1px solid #e2e8f0; background: white; color: #64748b; border-radius: 20px; font-size: 12px; cursor: pointer;">ë³´ë¥˜</button>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span style="font-size: 14px; font-weight: 600; color: #64748b;">ë‹´ë‹¹ì:</span>
                                <select id="employee-filter" onchange="filterByEmployee()" style="padding: 6px 12px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 12px; background: white;">
                                    <option value="all">ì „ì²´ ì§ì›</option>
                                </select>
                            </div>
                        </div>
                        
                        <div id="customer-table-content">
                            <div class="loading" style="text-align: center; padding: 40px; color: #64748b;">ë¡œë”© ì¤‘...</div>
                        </div>
                        
                        <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
                        <div id="customer-pagination" style="display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 20px; padding: 20px;">
                            <!-- í˜ì´ì§€ë„¤ì´ì…˜ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                        </div>
                    </div>
                </div>

                <!-- íŒ€ì¥ ë³¸ì¸ ê³ ê°ê´€ë¦¬ ì„¹ì…˜ -->
                <div id="team-leader-customer-section" style="display:none;">
                    <!-- í†µê³„ ì¹´ë“œ -->
                    <div class="dashboard-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;">
                        <div class="stat-card" style="background: #ffffff; border-radius: 10px; padding: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                            <div class="stat-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                <h3 class="stat-title" style="font-size: 12px; font-weight: 500; color: #64748b;">ì´ ê³ ê°</h3>
                                <div class="stat-icon" style="width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; background: #eef2ff; color: #6366f1;">ğŸ‘¤</div>
                            </div>
                            <div id="total-customers-team-leader" class="stat-value" style="font-size: 20px; font-weight: 700; color: #1a202c; margin-bottom: 4px;">0</div>
                            <div class="stat-change" style="font-size: 11px; font-weight: 500; color: #64748b;">ë‚´ ë‹´ë‹¹ ê³ ê°</div>
                        </div>
                        <div class="stat-card" style="background: #ffffff; border-radius: 10px; padding: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                            <div class="stat-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                <h3 class="stat-title" style="font-size: 12px; font-weight: 500; color: #64748b;">ì§„í–‰ì¤‘</h3>
                                <div class="stat-icon" style="width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; background: #fef3c7; color: #f59e0b;">â³</div>
                            </div>
                            <div id="progress-customers-team-leader" class="stat-value" style="font-size: 20px; font-weight: 700; color: #1a202c; margin-bottom: 4px;">0</div>
                            <div class="stat-change" style="font-size: 11px; font-weight: 500; color: #64748b;">ì§„í–‰ ì¤‘ì¸ ê³ ê°</div>
                        </div>
                        <div class="stat-card" style="background: #ffffff; border-radius: 10px; padding: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                            <div class="stat-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                <h3 class="stat-title" style="font-size: 12px; font-weight: 500; color: #64748b;">ê³„ì•½</h3>
                                <div class="stat-icon" style="width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; background: #dcfce7; color: #16a34a;">âœ…</div>
                            </div>
                            <div id="completed-customers-team-leader" class="stat-value" style="font-size: 20px; font-weight: 700; color: #1a202c; margin-bottom: 4px;">0</div>
                            <div class="stat-change" style="font-size: 11px; font-weight: 500; color: #64748b;">ê³„ì•½ ì™„ë£Œ ê³ ê°</div>
                        </div>
                        <div class="stat-card" style="background: #ffffff; border-radius: 10px; padding: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                            <div class="stat-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                <h3 class="stat-title" style="font-size: 12px; font-weight: 500; color: #64748b;">ì´ë²ˆ ì£¼ ì‹ ê·œ</h3>
                                <div class="stat-icon" style="width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; background: #fce7f3; color: #ec4899;">ğŸ“ˆ</div>
                            </div>
                            <div id="new-customers-team-leader" class="stat-value" style="font-size: 20px; font-weight: 700; color: #1a202c; margin-bottom: 4px;">0</div>
                            <div class="stat-change" style="font-size: 11px; font-weight: 500; color: #64748b;">ì‹ ê·œ ê³ ê°</div>
                        </div>
                    </div>

                    <!-- íŒ€ì¥ ë³¸ì¸ ê³ ê° ëª©ë¡ ì¹´ë“œ -->
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <h2 class="card-title">
                                <span>ğŸ’¼</span>
                                íŒ€ì¥ ë³¸ì¸ ê³ ê° ëª©ë¡
                            </h2>
                            <button class="btn btn-primary" onclick="addNewTeamLeaderCustomerRow()">+ ê³ ê° ì¶”ê°€</button>
                        </div>
                        
                        <!-- í•„í„° ì„¹ì…˜ -->
                        <div class="filter-section" style="padding: 12px 24px; border-bottom: 1px solid #e2e8f0; background: #ffffff; display: flex; gap: 24px; flex-wrap: wrap; align-items: center;">
                            <div class="filter-group" style="display: flex; align-items: center; gap: 8px;">
                                <span class="filter-label" style="color: #64748b; font-size: 13px; font-weight: 600; margin-right: 4px;">ìƒíƒœ:</span>
                                <div class="filter-buttons" style="display: flex; gap: 6px;">
                                    <button class="filter-btn active" data-status="all" onclick="setTeamLeaderCustomerFilter('all', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #e0e7ff; color: #4338ca; border-radius: 20px; font-size: 12px; cursor: pointer; font-weight: 600;">ì „ì²´</button>
                                    <button class="filter-btn" data-status="ì§„í–‰ì¤‘" onclick="setTeamLeaderCustomerFilter('ì§„í–‰ì¤‘', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ì§„í–‰ì¤‘</button>
                                    <button class="filter-btn" data-status="ê³„ì•½" onclick="setTeamLeaderCustomerFilter('ê³„ì•½', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ê³„ì•½</button>
                                    <button class="filter-btn" data-status="ë³´ë¥˜" onclick="setTeamLeaderCustomerFilter('ë³´ë¥˜', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ë³´ë¥˜</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- í…Œì´ë¸” ì»¨í…Œì´ë„ˆ -->
                        <div class="table-container" style="background: white; border-radius: 12px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); overflow: hidden;">
                            <table class="data-table" style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ë¬¸ì˜ì¼</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ê³ ê°ëª…</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì—°ë½ì²˜</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì˜ˆì‚°</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ë°© ê°œìˆ˜</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ìœ„ì¹˜</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ëŒ€ì¶œ</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì£¼ì°¨</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">í«</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ë©”ëª¨</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì§„í–‰ìƒíƒœ</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ë‹´ë‹¹ì</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì‘ì—…</th>
                                    </tr>
                                </thead>
                                <tbody id="team-leader-customer-table-body">
                                    <!-- ë°ì´í„°ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
                        <div id="team-leader-customer-pagination" style="display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 20px; padding: 20px;">
                            <!-- í˜ì´ì§€ë„¤ì´ì…˜ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                        </div>
                    </div>
                </div>

                <!-- íŒ€ì¥ ë³¸ì¸ ë©”ì´í”Œê´€ë¦¬ ì„¹ì…˜ -->
                <div id="team-leader-maeiple-section" style="display:none;">
                    <!-- í†µê³„ ì¹´ë“œ -->
                    <div class="dashboard-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;">
                        <div class="stat-card" style="background: #ffffff; border-radius: 10px; padding: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                            <div class="stat-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                <h3 class="stat-title" style="font-size: 12px; font-weight: 500; color: #64748b;">ì´ ì•„íŒŒíŠ¸</h3>
                                <div class="stat-icon" style="width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; background: #f0f9ff; color: #0ea5e9;">ğŸ¢</div>
                            </div>
                            <div id="total-maeiple-team-leader" class="stat-value" style="font-size: 20px; font-weight: 700; color: #1a202c; margin-bottom: 4px;">0</div>
                            <div class="stat-change" style="font-size: 11px; font-weight: 500; color: #64748b;">ë‚´ ë‹´ë‹¹ ë§¤ë¬¼</div>
                        </div>
                        <div class="stat-card" style="background: #ffffff; border-radius: 10px; padding: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                            <div class="stat-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                <h3 class="stat-title" style="font-size: 12px; font-weight: 500; color: #64748b;">ê±°ë˜ì¤‘</h3>
                                <div class="stat-icon" style="width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; background: #fef3c7; color: #f59e0b;">â³</div>
                            </div>
                            <div id="available-maeiple-team-leader" class="stat-value" style="font-size: 20px; font-weight: 700; color: #1a202c; margin-bottom: 4px;">0</div>
                            <div class="stat-change" style="font-size: 11px; font-weight: 500; color: #64748b;">ì§„í–‰ ì¤‘ì¸ ê±°ë˜</div>
                        </div>
                        <div class="stat-card" style="background: #ffffff; border-radius: 10px; padding: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                            <div class="stat-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                <h3 class="stat-title" style="font-size: 12px; font-weight: 500; color: #64748b;">ê±°ë˜ì™„ë£Œ</h3>
                                <div class="stat-icon" style="width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; background: #dcfce7; color: #16a34a;">âœ…</div>
                            </div>
                            <div id="completed-maeiple-team-leader" class="stat-value" style="font-size: 20px; font-weight: 700; color: #1a202c; margin-bottom: 4px;">0</div>
                            <div class="stat-change" style="font-size: 11px; font-weight: 500; color: #64748b;">ì™„ë£Œëœ ê±°ë˜</div>
                        </div>
                        <div class="stat-card" style="background: #ffffff; border-radius: 10px; padding: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                            <div class="stat-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                <h3 class="stat-title" style="font-size: 12px; font-weight: 500; color: #64748b;">ì´ë²ˆ ì£¼ ì‹ ê·œ</h3>
                                <div class="stat-icon" style="width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; background: #fce7f3; color: #ec4899;">ğŸ“ˆ</div>
                            </div>
                            <div id="new-maeiple-team-leader" class="stat-value" style="font-size: 20px; font-weight: 700; color: #1a202c; margin-bottom: 4px;">0</div>
                            <div class="stat-change" style="font-size: 11px; font-weight: 500; color: #64748b;">ì‹ ê·œ ë“±ë¡</div>
                        </div>
                    </div>

                    <!-- íŒ€ì¥ ë³¸ì¸ ë§¤ë¬¼ ëª©ë¡ ì¹´ë“œ -->
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <h2 class="card-title">
                                <span>ğŸ¢</span>
                                íŒ€ì¥ ë³¸ì¸ ë§¤ë¬¼ ëª©ë¡
                            </h2>
                            <button class="btn btn-primary" onclick="addNewTeamLeaderMaeipleRow()">+ ë§¤ë¬¼ ì¶”ê°€</button>
                        </div>
                        
                        <!-- í•„í„° ì„¹ì…˜ -->
                        <div class="filter-section" style="padding: 12px 24px; border-bottom: 1px solid #e2e8f0; background: #ffffff; display: flex; gap: 24px; flex-wrap: wrap; align-items: center;">
                            <div class="filter-group" style="display: flex; align-items: center; gap: 8px;">
                                <span class="filter-label" style="color: #64748b; font-size: 13px; font-weight: 600; margin-right: 4px;">ìƒíƒœ:</span>
                                <div class="filter-buttons" style="display: flex; gap: 6px;">
                                    <button class="filter-btn active" data-status="all" onclick="setTeamLeaderMaeipleFilter('all', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #e0e7ff; color: #4338ca; border-radius: 20px; font-size: 12px; cursor: pointer; font-weight: 600;">ì „ì²´</button>
                                    <button class="filter-btn" data-status="ê±°ë˜ì¤‘" onclick="setTeamLeaderMaeipleFilter('ê±°ë˜ì¤‘', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ê±°ë˜ì¤‘</button>
                                    <button class="filter-btn" data-status="ê±°ë˜ì™„ë£Œ" onclick="setTeamLeaderMaeipleFilter('ê±°ë˜ì™„ë£Œ', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ê±°ë˜ì™„ë£Œ</button>
                                    <button class="filter-btn" data-status="ë³´ë¥˜" onclick="setTeamLeaderMaeipleFilter('ë³´ë¥˜', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ë³´ë¥˜</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- í…Œì´ë¸” ì»¨í…Œì´ë„ˆ -->
                        <div class="table-container" style="background: white; border-radius: 12px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); overflow: hidden;">
                            <table class="maeiple-table" style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">í™•ì¸ì¼</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ë™</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">í˜¸ìˆ˜</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ìƒíƒœ</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì „ì„¸ê°€</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì›”ì„¸</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ë§¤ë§¤ê°€</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì…ì£¼ì—¬ë¶€</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì—°ë½ì²˜</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ë©”ëª¨</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì¢‹ì•„ìš”</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì‹«ì–´ìš”</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ë‹´ë‹¹ì</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì‘ì—…</th>
                                    </tr>
                                </thead>
                                <tbody id="team-leader-maeiple-table-body">
                                    <!-- ë°ì´í„°ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
                        <div id="team-leader-maeiple-pagination" style="display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 20px; padding: 20px;">
                            <!-- í˜ì´ì§€ë„¤ì´ì…˜ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                        </div>
                    </div>
                </div>

                <!-- íŒ€ ì „ì²´ ê³ ê°ê´€ë¦¬ ì„¹ì…˜ -->
                <div id="team-customer-section" style="display:none;">
                    <!-- í†µê³„ ì¹´ë“œ -->
                    <div class="dashboard-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;">
                        <div class="stat-card" style="background: #ffffff; border-radius: 10px; padding: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                            <div class="stat-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                <h3 class="stat-title" style="font-size: 12px; font-weight: 500; color: #64748b;">ì´ ê³ ê°</h3>
                                <div class="stat-icon" style="width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; background: #eef2ff; color: #6366f1;">ğŸ‘¥</div>
                            </div>
                            <div id="total-customers-team" class="stat-value" style="font-size: 20px; font-weight: 700; color: #1a202c; margin-bottom: 4px;">0</div>
                            <div class="stat-change" style="font-size: 11px; font-weight: 500; color: #64748b;">íŒ€ ì „ì²´ ê³ ê°</div>
                        </div>
                        <div class="stat-card" style="background: #ffffff; border-radius: 10px; padding: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                            <div class="stat-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                <h3 class="stat-title" style="font-size: 12px; font-weight: 500; color: #64748b;">ì§„í–‰ì¤‘</h3>
                                <div class="stat-icon" style="width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; background: #fef3c7; color: #f59e0b;">â³</div>
                            </div>
                            <div id="progress-customers-team" class="stat-value" style="font-size: 20px; font-weight: 700; color: #1a202c; margin-bottom: 4px;">0</div>
                            <div class="stat-change" style="font-size: 11px; font-weight: 500; color: #64748b;">ì§„í–‰ ì¤‘ì¸ ê³ ê°</div>
                        </div>
                        <div class="stat-card" style="background: #ffffff; border-radius: 10px; padding: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                            <div class="stat-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                <h3 class="stat-title" style="font-size: 12px; font-weight: 500; color: #64748b;">ê³„ì•½</h3>
                                <div class="stat-icon" style="width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; background: #dcfce7; color: #16a34a;">âœ…</div>
                            </div>
                            <div id="completed-customers-team" class="stat-value" style="font-size: 20px; font-weight: 700; color: #1a202c; margin-bottom: 4px;">0</div>
                            <div class="stat-change" style="font-size: 11px; font-weight: 500; color: #64748b;">ê³„ì•½ ì™„ë£Œ ê³ ê°</div>
                        </div>
                        <div class="stat-card" style="background: #ffffff; border-radius: 10px; padding: 12px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);">
                            <div class="stat-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                                <h3 class="stat-title" style="font-size: 12px; font-weight: 500; color: #64748b;">ì´ë²ˆ ì£¼ ì‹ ê·œ</h3>
                                <div class="stat-icon" style="width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; background: #fce7f3; color: #ec4899;">ğŸ“ˆ</div>
                            </div>
                            <div id="new-customers-team" class="stat-value" style="font-size: 20px; font-weight: 700; color: #1a202c; margin-bottom: 4px;">0</div>
                            <div class="stat-change" style="font-size: 11px; font-weight: 500; color: #64748b;">ì‹ ê·œ ê³ ê°</div>
                        </div>
                    </div>

                    <!-- íŒ€ ì „ì²´ ê³ ê° ëª©ë¡ ì¹´ë“œ -->
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <h2 class="card-title">
                                <span>ğŸ‘¥</span>
                                íŒ€ ì „ì²´ ê³ ê° ëª©ë¡ (íŒ€ì¥ + íŒ€ì›)
                            </h2>
                            <button class="btn btn-primary" onclick="addNewTeamCustomerRow()">+ ê³ ê° ì¶”ê°€</button>
                        </div>
                        
                        <!-- í•„í„° ì„¹ì…˜ -->
                        <div class="filter-section" style="padding: 12px 24px; border-bottom: 1px solid #e2e8f0; background: #ffffff; display: flex; gap: 24px; flex-wrap: wrap; align-items: center;">
                            <div class="filter-group" style="display: flex; align-items: center; gap: 8px;">
                                <span class="filter-label" style="color: #64748b; font-size: 13px; font-weight: 600; margin-right: 4px;">ìƒíƒœ:</span>
                                <div class="filter-buttons" style="display: flex; gap: 6px;">
                                    <button class="filter-btn active" data-status="all" onclick="setTeamCustomerFilter('all', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #e0e7ff; color: #4338ca; border-radius: 20px; font-size: 12px; cursor: pointer; font-weight: 600;">ì „ì²´</button>
                                    <button class="filter-btn" data-status="ì§„í–‰ì¤‘" onclick="setTeamCustomerFilter('ì§„í–‰ì¤‘', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ì§„í–‰ì¤‘</button>
                                    <button class="filter-btn" data-status="ê³„ì•½" onclick="setTeamCustomerFilter('ê³„ì•½', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ê³„ì•½</button>
                                    <button class="filter-btn" data-status="ë³´ë¥˜" onclick="setTeamCustomerFilter('ë³´ë¥˜', this)" style="padding: 6px 10px; border: 1px solid #e2e8f0; background: #ffffff; color: #334155; border-radius: 20px; font-size: 12px; cursor: pointer;">ë³´ë¥˜</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- í…Œì´ë¸” ì»¨í…Œì´ë„ˆ -->
                        <div class="table-container" style="background: white; border-radius: 12px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); overflow: hidden;">
                            <table class="data-table" style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ë¬¸ì˜ì¼</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ê³ ê°ëª…</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì—°ë½ì²˜</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì˜ˆì‚°</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ë°© ê°œìˆ˜</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ìœ„ì¹˜</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ëŒ€ì¶œ</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì£¼ì°¨</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">í«</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ë©”ëª¨</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì§„í–‰ìƒíƒœ</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ë‹´ë‹¹ì</th>
                                        <th style="background: #f8fafc; padding: 16px 12px; text-align: left; font-weight: 600; color: #374151; border-bottom: 1px solid #e2e8f0; font-size: 14px;">ì‘ì—…</th>
                                    </tr>
                                </thead>
                                <tbody id="team-customer-table-body">
                                    <!-- ë°ì´í„°ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
                        <div id="team-customer-pagination" style="display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 20px; padding: 20px;">
                            <!-- í˜ì´ì§€ë„¤ì´ì…˜ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ë©”ëª¨ ëª¨ë‹¬ -->
    <div id="memoModal" class="modal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5);">
        <div class="modal-content" style="background-color: white; margin: 5% auto; padding: 24px; border-radius: 12px; width: 90%; max-width: 500px; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);">
            <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 class="modal-title" style="font-size: 20px; font-weight: 600; color: #1a202c;">íŠ¹ì´ì‚¬í•­ ë©”ëª¨</h3>
                <button class="close" onclick="closeMemoModal()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #64748b;">&times;</button>
            </div>
            <textarea id="memoTextarea" class="memo-textarea" placeholder="ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." style="width: 100%; height: 120px; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px; resize: vertical; font-family: inherit;"></textarea>
            <div class="modal-actions" style="display: flex; justify-content: flex-end; gap: 12px; margin-top: 20px;">
                <button class="btn btn-secondary" onclick="closeMemoModal()" style="padding: 10px 20px; background: #6b7280; color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer;">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="saveMemo()" style="padding: 10px 20px; background: #6366f1; color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer;">ì €ì¥</button>
            </div>
        </div>
    </div>

    <script>
        let employees = [];
        let currentEmployeePage = 1;
        let employeePerPage = 20;
        let employeeTotalPages = 0;
        
        // ë©”ì´í”Œê´€ë¦¬ ê´€ë ¨ ë³€ìˆ˜ë“¤
        let properties = [];
        let statusFilter = 'all';
        let occupiedFilter = 'all';
        let currentMaeiplePage = 1;
        let maeipePerPage = 20;
        let maeipleTotalPages = 0;
        let dealTypeFilterAdmin = 'all';
        let roomSearchFilterAdmin = '';
        let employeeSearchFilterAdmin = '';
        let teamFilterAdmin = 'all';
        let currentMemoId = null;
        let currentSortBy = 'check_date';
        let currentSortOrder = 'desc';
        let currentTeamSortBy = 'check_date';
        let currentTeamSortOrder = 'desc';
        
        // íŒ€ì¥ë©”ì´í”Œê´€ë¦¬ ê´€ë ¨ ë³€ìˆ˜ë“¤
        let teamProperties = [];
        let statusFilterTeam = 'all';
        let occupiedFilterTeam = 'all';
        let dealTypeFilterTeam = 'all';
        let roomSearchFilterTeam = '';
        let employeeSearchFilterTeam = '';
        let currentTeamMaeiplePage = 1;
        let teamMaeipePerPage = 20;
        let teamMaeipleTotalPages = 0;
        
        // íŒ€ì¥ê³ ê°ê´€ë¦¬ ê´€ë ¨ ë³€ìˆ˜ë“¤
        let teamCustomers = [];
        let currentTeamCustomerPage = 1;
        let teamCustomerPerPage = 20;
        let teamCustomerTotalPages = 0;
        let teamCustomerStatusFilter = 'all';
        
        // ì‚¬ì´íŠ¸ ì „í™˜ ë“œë¡­ë‹¤ìš´ í† ê¸€
        function toggleSiteSwitcher() {
            const switcher = document.getElementById('site-switcher');
            switcher.classList.toggle('active');
        }
        
        // ì™¸ë¶€ í´ë¦­ ì‹œ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
        document.addEventListener('click', function(event) {
            const switcher = document.getElementById('site-switcher');
            if (!switcher.contains(event.target)) {
                switcher.classList.remove('active');
            }
        });
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì§ì› ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
        document.addEventListener('DOMContentLoaded', function() {
            showTab('employee');
            updateUserInfo();
            loadTeams(); // íŒ€ ëª©ë¡ ë¨¼ì € ë¡œë“œ
            loadEmployees();
            
            // ì‚¬ìš©ì ì—­í•  í™•ì¸í•˜ì—¬ íŒ€ì¥ íƒ­ í‘œì‹œ
            checkUserRoleAndShowTabs();
            
            // ë©”ëª¨ í…ìŠ¤íŠ¸ ì˜ì—­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
            const memoTextarea = document.getElementById('memoTextarea');
            if (memoTextarea) {
                memoTextarea.addEventListener('input', updateMemoCharCount);
            }
        });
        
        // ì‚¬ìš©ì ì •ë³´ ì—…ë°ì´íŠ¸
        async function updateUserInfo() {
            try {
                const response = await fetch('/api/user-info');
                if (response.ok) {
                    const userInfo = await response.json();
                    
                    // ì‚¬ìš©ì ì´ë¦„ê³¼ ì—­í•  ì—…ë°ì´íŠ¸
                    const userNameElement = document.getElementById('user-name');
                    const userRoleElement = document.getElementById('user-role');
                    const userAvatarElement = document.getElementById('user-avatar');
                    
                    if (userNameElement) {
                        userNameElement.textContent = userInfo.name || 'ì‚¬ìš©ì';
                    }
                    
                    if (userRoleElement) {
                        userRoleElement.textContent = userInfo.role || 'ì§ì›';
                    }
                    
                    if (userAvatarElement) {
                        userAvatarElement.textContent = (userInfo.name || 'ì‚¬').charAt(0);
                    }
                }
            } catch (error) {
                console.error('ì‚¬ìš©ì ì •ë³´ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', error);
            }
        }
        
        // ì‚¬ìš©ì ì—­í•  í™•ì¸í•˜ì—¬ íƒ­ í‘œì‹œ
        async function checkUserRoleAndShowTabs() {
            try {
                // ì„¸ì…˜ ì •ë³´ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ API í˜¸ì¶œ
                const response = await fetch('/api/user-info');
                if (response.ok) {
                    const userInfo = await response.json();
                    console.log('ğŸ” ì‚¬ìš©ì ì •ë³´ í™•ì¸:', userInfo);
                    console.log('ğŸ” userInfo.role:', userInfo.role);
                    console.log('ğŸ” userInfo.employee_role:', userInfo.employee_role);
                    console.log('ğŸ” userInfo.role === "íŒ€ì¥":', userInfo.role === 'íŒ€ì¥');
                    console.log('ğŸ” userInfo.employee_role === "íŒ€ì¥":', userInfo.employee_role === 'íŒ€ì¥');
                    console.log('ğŸ” íŒ€ì¥ ê¶Œí•œ í™•ì¸ ê²°ê³¼:', userInfo.role === 'íŒ€ì¥' || userInfo.employee_role === 'íŒ€ì¥');
                    
                    // íŒ€ì¥ì¸ ê²½ìš°ì—ë§Œ íŒ€ì¥ë©”ì´í”Œê´€ë¦¬ì™€ íŒ€ì¥ê³ ê°ê´€ë¦¬ íƒ­ê³¼ ì„¹ì…˜ í‘œì‹œ
                    if (userInfo.role === 'íŒ€ì¥' || userInfo.employee_role === 'íŒ€ì¥') {
                        const teamLeaderMaeipleNav = document.getElementById('team-leader-maeiple-nav');
                        const teamLeaderCustomerNav = document.getElementById('team-leader-customer-nav');
                        
                        if (teamLeaderMaeipleNav) {
                            teamLeaderMaeipleNav.style.display = 'flex';
                        }
                        if (teamLeaderCustomerNav) {
                            teamLeaderCustomerNav.style.display = 'flex';
                        }
                    } else {
                        // ê´€ë¦¬ìë‚˜ ì¼ë°˜ ì§ì›ì¸ ê²½ìš° íŒ€ì¥ íƒ­ê³¼ ì„¹ì…˜ë“¤ ìˆ¨ê¹€
                        const teamLeaderMaeipleNav = document.getElementById('team-leader-maeiple-nav');
                        const teamLeaderCustomerNav = document.getElementById('team-leader-customer-nav');
                        
                        if (teamLeaderMaeipleNav) {
                            teamLeaderMaeipleNav.style.display = 'none';
                        }
                        if (teamLeaderCustomerNav) {
                            teamLeaderCustomerNav.style.display = 'none';
                        }
                    }
                }
            } catch (error) {
                console.error('ì‚¬ìš©ì ì •ë³´ í™•ì¸ ì˜¤ë¥˜:', error);
                // ì˜¤ë¥˜ ì‹œì—ë„ íŒ€ì¥ íƒ­ê³¼ ì„¹ì…˜ë“¤ì€ ìˆ¨ê¹€ ìƒíƒœ ìœ ì§€
                const teamLeaderMaeipleNav = document.getElementById('team-leader-maeiple-nav');
                const teamLeaderCustomerNav = document.getElementById('team-leader-customer-nav');
                
                if (teamLeaderMaeipleNav) {
                    teamLeaderMaeipleNav.style.display = 'none';
                }
                if (teamLeaderCustomerNav) {
                    teamLeaderCustomerNav.style.display = 'none';
                }
            }
        }
        
        // íŒ€ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadTeams() {
            try {
                const response = await fetch('/api/teams');
                if (response.ok) {
                    const result = await response.json();
                    const teams = result.teams || [];
                    
                    console.log('âœ… íŒ€ ëª©ë¡ ë¡œë“œ ì„±ê³µ:', teams);
                    
                    // ìƒˆì§ì›ì¶”ê°€ í¼ì˜ íŒ€ì„ íƒ ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸
                    updateTeamSelect('team', teams);
                    
                    // íŒ€ ê´€ë¦¬ ëª¨ë‹¬ì˜ ì‚­ì œ íŒ€ì„ íƒ ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸
                    updateTeamSelect('deleteTeamSelect', teams);
                    
                    // ì§ì› ìˆ˜ì • í¼ì˜ íŒ€ì„ íƒ ë“œë¡­ë‹¤ìš´ë„ ì—…ë°ì´íŠ¸ (ë™ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ê²½ìš°)
                    updateTeamSelect('edit-team', teams);
                    
                } else {
                    console.error('âŒ íŒ€ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', response.status);
                }
            } catch (error) {
                console.error('âŒ íŒ€ ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜:', error);
            }
        }
        
        // íŒ€ì„ íƒ ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateTeamSelect(selectId, teams) {
            const selectElement = document.getElementById(selectId);
            if (!selectElement) {
                console.warn(`âš ï¸ ID "${selectId}"ë¥¼ ê°€ì§„ select ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ`);
                return;
            }
            
            // ê¸°ì¡´ ì˜µì…˜ë“¤ ì œê±° (ì²« ë²ˆì§¸ "íŒ€ ì„ íƒ" ì˜µì…˜ì€ ìœ ì§€)
            const firstOption = selectElement.querySelector('option[value=""]');
            selectElement.innerHTML = '';
            
            // ì²« ë²ˆì§¸ ì˜µì…˜ ë³µì›
            if (firstOption) {
                selectElement.appendChild(firstOption);
            } else {
                // ê¸°ë³¸ "íŒ€ ì„ íƒ" ì˜µì…˜ ì¶”ê°€
                const defaultOption = document.createElement('option');
                defaultOption.value = '';
                defaultOption.textContent = 'íŒ€ ì„ íƒ';
                selectElement.appendChild(defaultOption);
            }
            
            // DBì—ì„œ ê°€ì ¸ì˜¨ íŒ€ë“¤ ì¶”ê°€
            teams.forEach(team => {
                const option = document.createElement('option');
                option.value = team.name;
                option.textContent = team.name;
                selectElement.appendChild(option);
            });
            
            console.log(`âœ… "${selectId}" íŒ€ì„ íƒ ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸ ì™„ë£Œ: ${teams.length}ê°œ íŒ€`);
        }
        
        // ì§ì› ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadEmployees(page = 1) {
            console.log(`ğŸ‘¥ ì§ì› ëª©ë¡ ë¡œë“œ ì‹œì‘ (í˜ì´ì§€ ${page})`);
            try {
                currentEmployeePage = page;
                const response = await fetch(`/api/employees?page=${page}&per_page=${employeePerPage}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error);
                }
                
                employees = Array.isArray(data.employees) ? data.employees : [];
                employeeTotalPages = data.total_pages || 0;
                console.log(`âœ… ì§ì› ëª©ë¡ ë¡œë“œ ì™„ë£Œ: ${employees.length}ê°œ (í˜ì´ì§€ ${page}/${employeeTotalPages})`);
                
                displayEmployees(employees);
                updateTeamFilter();
                renderEmployeePagination();
            } catch (error) {
                console.error('âŒ ì§ì› ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);
                showAlert(`ì§ì› ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${error.message}`, 'error');
                
                // ë¹ˆ í…Œì´ë¸” í‘œì‹œ
                const tbody = document.querySelector('#employee-table tbody');
                if (tbody) {
                    tbody.innerHTML = '<tr><td colspan="8" style="text-align: center; padding: 40px; color: #64748b;">ì§ì› ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ì„ í´ë¦­í•´ì£¼ì„¸ìš”.</td></tr>';
                }
            }
        }
        
        // ì—­í• ë³„ ë°°ì§€ ìƒ‰ìƒ ì„¤ì •
        function getRoleBadgeColor(role) {
            switch(role) {
                case 'íŒ€ì¥': return '#dcfce7';
                case 'ì§ì›': return '#f1f5f9';
                default: return '#f1f5f9';
            }
        }

        function getRoleTextColor(role) {
            switch(role) {
                case 'íŒ€ì¥': return '#166534';
                case 'ì§ì›': return '#475569';
                default: return '#475569';
            }
        }

        // íŒ€ë³„ ë°°ì§€ ìƒ‰ìƒ ì„¤ì •
        function getTeamBadgeColor(team) {
            switch(team) {
                case 'ë¹ˆì‹œíŠ¸': return '#e0f2fe';
                case 'ìœ„í”ŒëŸ¬ìŠ¤': return '#f0fdf4';
                case 'ë°˜í´ë¦¬ì…°': return '#fef7cd';
                case 'ëŒ€í‘œ': return '#fce7f3';
                default: return '#f1f5f9';
            }
        }

        function getTeamTextColor(team) {
            switch(team) {
                case 'ë¹ˆì‹œíŠ¸': return '#0c4a6e';
                case 'ìœ„í”ŒëŸ¬ìŠ¤': return '#166534';
                case 'ë°˜í´ë¦¬ì…°': return '#a16207';
                case 'ëŒ€í‘œ': return '#be185d';
                default: return '#475569';
            }
        }

        // ì§ì› ëª©ë¡ í‘œì‹œ
        function displayEmployees(employeeList) {
            const tbody = document.getElementById('employees-list');
            
            if (employeeList.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 40px; color: #64748b;">ë“±ë¡ëœ ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                return;
            }
            
            tbody.innerHTML = employeeList.map(emp => `
                <tr data-employee-id="${emp.id}">
                    <td><strong>${emp.employee_id}</strong></td>
                    <td>${emp.employee_name}</td>
                    <td>
                        <span class="status-badge" style="background: ${getTeamBadgeColor(emp.team)}; color: ${getTeamTextColor(emp.team)};">
                            ${emp.team || 'ë¯¸ì§€ì •'}
                        </span>
                    </td>
                    <td>
                        <span class="status-badge" style="background: ${getRoleBadgeColor(emp.role)}; color: ${getRoleTextColor(emp.role)};">
                            ${emp.role || 'ì§ì›'}
                        </span>
                    </td>
                    <td>${emp.created_date}</td>
                    <td>
                        <span class="status-badge ${emp.is_active ? 'status-active' : 'status-inactive'}">
                            ${emp.is_active ? 'í™œì„±' : 'ë¹„í™œì„±'}
                        </span>
                    </td>
                    <td>
                        <div class="action-buttons">
                            ${emp.is_active ? 
                                `<button class="btn btn-danger btn-sm" onclick="deactivateEmployee(${emp.id})">ë¹„í™œì„±í™”</button>` :
                                `<button class="btn btn-success btn-sm" onclick="activateEmployee(${emp.id})">í™œì„±í™”</button>`
                            }
                            <button class="btn btn-primary btn-sm" onclick="editEmployee(${emp.id})">ìˆ˜ì •</button>
                            <button class="btn btn-secondary btn-sm" onclick="resetPassword(${emp.id})">ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •</button>
                            ${!emp.is_active ? 
                                `<button class="btn btn-danger btn-sm" onclick="permanentDelete(${emp.id})">ì™„ì „ì‚­ì œ</button>` : ''
                            }
                        </div>
                    </td>
                </tr>
            `).join('');
        }
        
        // íŒ€ í•„í„° ì—…ë°ì´íŠ¸
        function updateTeamFilter() {
            const teamFilter = document.getElementById('team-filter');
            const teams = [...new Set(employees.map(emp => emp.team).filter(team => team))];
            
            teamFilter.innerHTML = '<option value="">ì „ì²´ íŒ€</option>' + 
                teams.map(team => `<option value="${team}">${team}</option>`).join('');
        }
        
        // í•„í„° ì ìš©
        document.getElementById('status-filter').addEventListener('change', applyFilters);
        document.getElementById('team-filter').addEventListener('change', applyFilters);
        
        function applyFilters() {
            const statusFilter = document.getElementById('status-filter').value;
            const teamFilter = document.getElementById('team-filter').value;
            
            let filteredEmployees = employees;
            
            if (statusFilter !== '') {
                filteredEmployees = filteredEmployees.filter(emp => emp.is_active == statusFilter);
            }
            
            if (teamFilter !== '') {
                filteredEmployees = filteredEmployees.filter(emp => emp.team === teamFilter);
            }
            
            displayEmployees(filteredEmployees);
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ í†µí•© ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • (í•œ ë²ˆë§Œ ë“±ë¡)
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('add-employee-form');
            if (form) {
                // í¼ ì œì¶œ ì´ë²¤íŠ¸ - ì¶”ê°€/ìˆ˜ì • ëª¨ë‘ ì²˜ë¦¬
                form.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const submitBtn = document.getElementById('add-btn');
                    const isEditMode = form.dataset.editMode === 'true';
                    const empId = form.dataset.employeeId;
                    
                    // ë²„íŠ¼ ë¡œë”© ìƒíƒœ
                    submitBtn.classList.add('loading');
                    submitBtn.disabled = true;
                    
                    const formData = {
                        employee_id: document.getElementById('employee_id').value,
                        employee_name: document.getElementById('employee_name').value,
                        team: document.getElementById('team').value,
                        employee_role: document.getElementById('employee_role').value,
                        employee_status: document.getElementById('employee_status').value
                    };
                    
                    try {
                        let response;
                        if (isEditMode && empId) {
                            // ìˆ˜ì • ëª¨ë“œ
                            response = await fetch(`/api/employees/${empId}/update`, {
                                method: 'PUT',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(formData)
                            });
                        } else {
                            // ì¶”ê°€ ëª¨ë“œ
                            response = await fetch('/api/employees', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(formData)
                            });
                        }
                        
                        const result = await response.json();
                        
                        if (result.success) {
                            showAlert(isEditMode ? 'ì§ì› ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.' : 'ì§ì›ì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                            resetEmployeeForm();
                            loadEmployees(currentEmployeePage);
                            
                            // í¼ ìˆ¨ê¸°ê¸°
                            const addCard = document.getElementById('add-employee-card');
                            addCard.style.display = 'none';
                        } else {
                            showAlert(result.message || (isEditMode ? 'ì§ì› ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.' : 'ì§ì› ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'), 'error');
                        }
                    } catch (error) {
                        console.error('ì§ì› ì €ì¥ ì˜¤ë¥˜:', error);
                        showAlert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                    } finally {
                        submitBtn.classList.remove('loading');
                        submitBtn.disabled = false;
                    }
                });
            }
        });
        
        // ì§ì› ë¹„í™œì„±í™”
        async function deactivateEmployee(empId) {
            if (!confirm('ì´ ì§ì›ì„ ë¹„í™œì„±í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nâš ï¸ ì£¼ì˜: ë¹„í™œì„±í™”ëœ ì§ì›ì€ ì¦‰ì‹œ ë¡œê·¸ì•„ì›ƒë˜ë©° ì¬ì ‘ì†ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.')) return;
            
            try {
                const response = await fetch(`/api/employees/${empId}`, {
                    method: 'DELETE'
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showAlert(`âœ… ${result.message}`, 'success');
                    
                    // ê°•ì œ ë¡œê·¸ì•„ì›ƒ ì•Œë¦¼
                    if (result.employee_name) {
                        setTimeout(() => {
                            showAlert(`ğŸš« ${result.employee_name} ì§ì›ì´ ê°•ì œ ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.`, 'warning');
                        }, 1000);
                    }
                    
                    loadEmployees();
                } else {
                    showAlert(result.message || 'ë¹„í™œì„±í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            } catch (error) {
                showAlert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }
        
        // ì§ì› í™œì„±í™”
        async function activateEmployee(empId) {
            try {
                const response = await fetch(`/api/employees/${empId}/activate`, {
                    method: 'PUT'
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showAlert('ì§ì›ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                    loadEmployees();
                } else {
                    showAlert('í™œì„±í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            } catch (error) {
                showAlert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }
        
        // ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •
        async function resetPassword(empId) {
            const newPassword = prompt('ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ê¸°ë³¸ê°’: 1234):', '1234');
            if (!newPassword) return;
            
            try {
                const response = await fetch(`/api/employees/${empId}/reset-password`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ new_password: newPassword })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showAlert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¬ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                } else {
                    showAlert(result.message || 'ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            } catch (error) {
                showAlert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }
        
        // ì§ì› ìˆ˜ì • - ì§ì›ì¶”ê°€ í˜•ì‹ìœ¼ë¡œ í‘œì‹œ
        async function editEmployee(empId) {
            const employee = employees.find(emp => emp.id === empId);
            if (!employee) {
                showAlert('ì§ì›ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            
            // ì§ì›ì¶”ê°€ í¼ì„ ìˆ˜ì • ëª¨ë“œë¡œ ë³€ê²½
            const addForm = document.getElementById('add-employee-form');
            const formTitle = document.querySelector('#employee-section h2');
            const submitBtn = document.getElementById('add-btn');
            
            // í¼ í•„ë“œì— ê¸°ì¡´ ê°’ ì„¤ì •
            document.getElementById('employee_id').value = employee.employee_id || '';
            document.getElementById('employee_id').readOnly = true; // IDëŠ” ìˆ˜ì • ë¶ˆê°€
            document.getElementById('employee_name').value = employee.employee_name || '';
            document.getElementById('team').value = employee.team || '';
            document.getElementById('employee_role').value = employee.role || '';
            document.getElementById('employee_status').value = employee.status || 'active';
            
            // ì œëª©ê³¼ ë²„íŠ¼ í…ìŠ¤íŠ¸ ë³€ê²½
            formTitle.textContent = 'ì§ì› ì •ë³´ ìˆ˜ì •';
            submitBtn.textContent = 'ìˆ˜ì • ì™„ë£Œ';
            submitBtn.classList.remove('btn-primary');
            submitBtn.classList.add('btn-warning');
            
            // ì·¨ì†Œ ë²„íŠ¼ í‘œì‹œ
            const cancelBtn = document.getElementById('cancel-btn');
            if (cancelBtn) {
                cancelBtn.style.display = 'inline-flex';
            }
            
            // í¼ì„ ìˆ˜ì • ëª¨ë“œë¡œ ì„¤ì •
            addForm.dataset.editMode = 'true';
            addForm.dataset.employeeId = empId;  // employeeIdë¡œ í†µì¼
            
            // ì§ì›ì¶”ê°€ í¼ í‘œì‹œ
            const addCard = document.getElementById('add-employee-card');
            addCard.style.display = 'block';
            
            // ì§ì›ì¶”ê°€ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
            document.getElementById('employee-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆëŠ” ì´ë¯¸ DOMContentLoadedì—ì„œ í•œ ë²ˆë§Œ ë“±ë¡ë˜ë¯€ë¡œ ì¬ë“±ë¡ ë¶ˆí•„ìš”
        }
        
        // [ì‚­ì œë¨] setupEditFormEventListeners - í†µí•© ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¡œ ëŒ€ì²´ë¨
        
        // ì§ì› í¼ ì´ˆê¸°í™”
        function resetEmployeeForm() {
            const form = document.getElementById('add-employee-form');
            const formTitle = document.querySelector('#employee-section h2');
            const submitBtn = document.getElementById('add-btn');
            
            // í¼ ì´ˆê¸°í™”
            form.reset();
            document.getElementById('employee_id').readOnly = false;
            document.getElementById('employee_status').value = 'active'; // ìƒíƒœ í•„ë“œ ì´ˆê¸°í™”
            
            // ì œëª©ê³¼ ë²„íŠ¼ ì›ë˜ëŒ€ë¡œ ë³µì›
            formTitle.textContent = 'ì§ì› ì¶”ê°€';
            submitBtn.textContent = 'ì§ì› ì¶”ê°€';
            submitBtn.classList.remove('btn-warning');
            submitBtn.classList.add('btn-primary');
            
            // ì·¨ì†Œ ë²„íŠ¼ ìˆ¨ê¸°ê¸°
            const cancelBtn = document.getElementById('cancel-btn');
            if (cancelBtn) {
                cancelBtn.style.display = 'none';
            }
            
            // ìˆ˜ì • ëª¨ë“œ í•´ì œ
            delete form.dataset.editMode;
            delete form.dataset.employeeId;
            
            // í¼ ìˆ¨ê¸°ê¸° (í•„ìš”ì‹œ)
            // const addCard = document.getElementById('add-employee-card');
            // addCard.style.display = 'none';
        }
        
        // [ì‚­ì œë¨] setupAddEmployeeEventListeners - í†µí•© ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¡œ ëŒ€ì²´ë¨
        
        // ì§ì› ìˆ˜ì • ëª¨ë‹¬ ë‹«ê¸° (ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)
        function closeEditEmployeeModal() {
            // ì´ í•¨ìˆ˜ëŠ” ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
            // resetEmployeeForm() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.
        }
        
        // íŒ€ ì¶”ê°€ ëª¨ë‹¬ í‘œì‹œ
        function showAddTeamModal() {
            document.getElementById('addTeamModal').style.display = 'block';
            document.getElementById('newTeamName').value = '';
            document.getElementById('newTeamDescription').value = '';
            document.getElementById('newTeamName').focus();
        }
        
        // íŒ€ ì¶”ê°€ ëª¨ë‹¬ ë‹«ê¸°
        function closeAddTeamModal() {
            document.getElementById('addTeamModal').style.display = 'none';
        }
        
        // ìƒˆ íŒ€ ì¶”ê°€
        async function addNewTeam() {
            const teamName = document.getElementById('newTeamName').value.trim();
            const teamDescription = document.getElementById('newTeamDescription').value.trim();
            
            if (!teamName) {
                showAlert('íŒ€ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            try {
                const response = await fetch('/api/teams', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        name: teamName,
                        description: teamDescription
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // íŒ€ ì„ íƒ ë“œë¡­ë‹¤ìš´ì— ìƒˆ íŒ€ ì¶”ê°€
                    const teamSelect = document.getElementById('team');
                    if (teamSelect) {
                        const newOption = document.createElement('option');
                        newOption.value = teamName;
                        newOption.textContent = teamName;
                        teamSelect.appendChild(newOption);
                        console.log(`âœ… íŒ€ ì„ íƒ ë“œë¡­ë‹¤ìš´ì— "${teamName}" ì¶”ê°€ë¨`);
                } else {
                        console.warn('âš ï¸ team IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                    }
                    
                    // ì‚­ì œ íŒ€ ì„ íƒ ë“œë¡­ë‹¤ìš´ì—ë„ ì¶”ê°€
                    const deleteTeamSelect = document.getElementById('deleteTeamSelect');
                    if (deleteTeamSelect) {
                        const deleteOption = document.createElement('option');
                        deleteOption.value = teamName;
                        deleteOption.textContent = teamName;
                        deleteTeamSelect.appendChild(deleteOption);
                        console.log(`âœ… ì‚­ì œ íŒ€ ì„ íƒ ë“œë¡­ë‹¤ìš´ì— "${teamName}" ì¶”ê°€ë¨`);
                    } else {
                        console.warn('âš ï¸ deleteTeamSelect IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                    }
                    
                    // ìƒˆë¡œ ì¶”ê°€ëœ íŒ€ ì„ íƒ
                    if (teamSelect) {
                        teamSelect.value = teamName;
                    }
                    
                    // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                    document.getElementById('newTeamName').value = '';
                    document.getElementById('newTeamDescription').value = '';
                    
                    // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
                    showAlert(`"${teamName}" íŒ€ì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!`, 'success');
                    
                    // íŒ€ ëª©ë¡ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ëª¨ë“  íŒ€ì„ íƒ ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸
                    try {
                        await loadTeams();
                        console.log('âœ… íŒ€ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ');
                    } catch (error) {
                        console.warn('âš ï¸ íŒ€ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨:', error);
                    }
                    
                    // ì§ì› ëª©ë¡ë„ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ìƒˆ íŒ€ ë°˜ì˜
                    try {
                        await loadEmployees();
                        console.log('âœ… ì§ì› ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ');
                    } catch (error) {
                        console.warn('âš ï¸ ì§ì› ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨:', error);
                    }
                    
                    // 2ì´ˆ í›„ ëª¨ë‹¬ ìë™ ë‹«ê¸° (ì„ íƒì‚¬í•­)
                    setTimeout(() => {
                        if (confirm('íŒ€ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. íŒ€ ê´€ë¦¬ ëª¨ë‹¬ì„ ë‹«ìœ¼ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                            closeAddTeamModal();
                        }
                    }, 2000);
                } else {
                    showAlert(result.message || 'íŒ€ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            } catch (error) {
                showAlert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }
        
        // íŒ€ ì‚­ì œ
        async function deleteTeam() {
            const teamName = document.getElementById('deleteTeamSelect').value;
            const deleteReason = document.getElementById('deleteTeamReason').value.trim();
            
            if (!teamName) {
                showAlert('ì‚­ì œí•  íŒ€ì„ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            if (!confirm(`ì •ë§ë¡œ "${teamName}" íŒ€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nâš ï¸ ì£¼ì˜: ì´ íŒ€ì— ì†í•œ ì§ì›ë“¤ì€ íŒ€ì´ "ë¯¸ì§€ì •"ìœ¼ë¡œ ë³€ê²½ë©ë‹ˆë‹¤.\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) {
                return;
            }
            
            try {
                const response = await fetch(`/api/teams/${encodeURIComponent(teamName)}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        reason: deleteReason
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showAlert(`"${teamName}" íŒ€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
                    
                    // íŒ€ ëª©ë¡ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ëª¨ë“  íŒ€ì„ íƒ ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸
                    try {
                        await loadTeams();
                        console.log('âœ… íŒ€ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ');
                    } catch (error) {
                        console.warn('âš ï¸ íŒ€ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨:', error);
                    }
                    
                    // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                    document.getElementById('deleteTeamSelect').value = '';
                    document.getElementById('deleteTeamReason').value = '';
                    
                    // ì§ì› ëª©ë¡ ìƒˆë¡œê³ ì¹¨ (íŒ€ì´ ë³€ê²½ëœ ì§ì›ë“¤ ë°˜ì˜)
                    loadEmployees();
                    
                    // íŒ€ ê´€ë¦¬ ëª¨ë‹¬ ë‹«ê¸° (ì„ íƒì‚¬í•­)
                    setTimeout(() => {
                        if (confirm('íŒ€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤. íŒ€ ê´€ë¦¬ ëª¨ë‹¬ì„ ë‹«ìœ¼ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                            closeAddTeamModal();
                        }
                    }, 1500);
                } else {
                    showAlert(result.message || 'íŒ€ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            } catch (error) {
                showAlert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }
        
        // ì™„ì „ ì‚­ì œ
        async function permanentDelete(empId) {
            if (!confirm('ì´ ì§ì›ì„ ì™„ì „íˆ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nâš ï¸ ì£¼ì˜: ì‚­ì œëœ ì§ì›ì€ ì¦‰ì‹œ ë¡œê·¸ì•„ì›ƒë˜ë©° ì¬ì ‘ì†ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) return;
            
            try {
                const response = await fetch(`/api/employees/${empId}/permanent-delete`, {
                    method: 'DELETE'
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showAlert(`âœ… ${result.message}`, 'success');
                    
                    // ê°•ì œ ë¡œê·¸ì•„ì›ƒ ì•Œë¦¼
                    if (result.employee_name) {
                        setTimeout(() => {
                            showAlert(`ğŸš« ${result.employee_name} ì§ì›ì´ ê°•ì œ ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.`, 'warning');
                        }, 1000);
                    }
                    
                    // ì§ì› ëª©ë¡ì—ì„œ ì¦‰ì‹œ ì œê±°
                    const employeesList = document.getElementById('employees-list');
                    const rowToRemove = employeesList.querySelector(`tr[data-employee-id="${empId}"]`);
                    if (rowToRemove) {
                        rowToRemove.remove();
                    }
                    
                    // ì§ì› ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                    loadEmployees();
                } else {
                    showAlert(result.message || 'ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            } catch (error) {
                showAlert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }
        
        // ì•Œë¦¼ í‘œì‹œ
        function showAlert(message, type) {
            const alertContainer = document.getElementById('alert-container');
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.textContent = message;
            
            alertContainer.innerHTML = '';
            alertContainer.appendChild(alertDiv);
            
            setTimeout(() => {
                alertDiv.remove();
            }, 5000);
        }

        function activateEmployeeTab(e) {
            e.preventDefault();
            showTab('employee');
            
            // ì‚¬ì´ë“œë°” active ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            e.target.closest('.nav-item').classList.add('active');
            
            const section = document.getElementById('employee-section');
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function activateMaeipeTab(e) {
            e.preventDefault();
            showTab('maeiple');
            
            // ì‚¬ì´ë“œë°” active ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            e.target.closest('.nav-item').classList.add('active');
            
            const section = document.getElementById('maeiple-section');
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            
            // ë©”ì´í”Œê´€ë¦¬ ë°ì´í„° ë¡œë“œ (ì˜¤ë¥˜ ì²˜ë¦¬ ê°•í™”)
            console.log('ğŸ¢ ë©”ì´í”Œê´€ë¦¬ íƒ­ í™œì„±í™”');
            try {
                loadMaeipeProperties();
            } catch (error) {
                console.error('âŒ ë©”ì´í”Œ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                showAlert('ë©”ì´í”Œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ì„ í´ë¦­í•´ì£¼ì„¸ìš”.', 'error');
            }
            
            // ê¸°ë³¸ì ìœ¼ë¡œ ì•„íŒŒíŠ¸ëª©ë¡ íƒ­ í™œì„±í™”
            switchMaeipleTab('list');
        }
        
        function switchMaeipleTab(tabName) {
            // ëª¨ë“  íƒ­ ë²„íŠ¼ì—ì„œ active í´ë˜ìŠ¤ ì œê±°
            document.querySelectorAll('#maeiple-section .tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // ëª¨ë“  íƒ­ ì½˜í…ì¸  ìˆ¨ê¸°ê¸°
            document.querySelectorAll('#maeiple-section .tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ì„ íƒëœ íƒ­ ë²„íŠ¼ í™œì„±í™”
            const activeBtn = document.querySelector(`#maeiple-section .tab-btn[data-tab="${tabName}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            // ì„ íƒëœ íƒ­ ì½˜í…ì¸  í‘œì‹œ
            const activeContent = document.getElementById(`maeiple-tab-${tabName}`);
            if (activeContent) {
                activeContent.classList.add('active');
            }
            
            // íƒ­ì— ë”°ë¼ ë°ì´í„° ë¡œë“œ
            if (tabName === 'list') {
                loadMaeipeProperties();
            }
        }
        


        function activateTeamMaeipeTab(e) {
            e.preventDefault();
            showTab('team-maeiple');
            
            // ì‚¬ì´ë“œë°” active ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            e.target.closest('.nav-item').classList.add('active');
            
            const section = document.getElementById('team-maeiple-section');
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            
            // íŒ€ì¥ë©”ì´í”Œê´€ë¦¬ ë°ì´í„° ë¡œë“œ
            loadTeamMaeipeProperties();
        }

        function activateDashboardTab(e) {
            e.preventDefault();
            showTab('dashboard');
            
            // ì‚¬ì´ë“œë°” active ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            e.target.closest('.nav-item').classList.add('active');
            
            const section = document.getElementById('dashboard-section');
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            
            // ê³ ê° ë°ì´í„° ë¡œë“œ (ì˜¤ë¥˜ ì²˜ë¦¬ ê°•í™”)
            console.log('ğŸ‘¥ ê³ ê°ê´€ë¦¬ íƒ­ í™œì„±í™”');
            try {
                loadAllCustomers();
            } catch (error) {
                console.error('âŒ ê³ ê° ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                showAlert('ê³ ê° ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', 'error');
            }
        }

        function activateTeamLeaderCustomerTab(e) {
            e.preventDefault();
            showTab('team-leader-customer');
            
            // ì‚¬ì´ë“œë°” active ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            e.target.closest('.nav-item').classList.add('active');
            
            const section = document.getElementById('team-leader-customer-section');
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            
            // íŒ€ì¥ ë³¸ì¸ ê³ ê° ë°ì´í„° ë¡œë“œ
            loadTeamLeaderCustomers();
        }

        function activateTeamLeaderMaeipleTab(e) {
            e.preventDefault();
            showTab('team-leader-maeiple');
            
            // ì‚¬ì´ë“œë°” active ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            e.target.closest('.nav-item').classList.add('active');
            
            const section = document.getElementById('team-leader-maeiple-section');
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            
            // íŒ€ì¥ ë³¸ì¸ ë§¤ë¬¼ ë°ì´í„° ë¡œë“œ
            loadTeamLeaderMaeiple();
        }

        function activateTeamCustomerTab(e) {
            e.preventDefault();
            showTab('team-customer');
            
            // ì‚¬ì´ë“œë°” active ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            e.target.closest('.nav-item').classList.add('active');
            
            const section = document.getElementById('team-customer-section');
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            
            // íŒ€ ì „ì²´ ê³ ê° ë°ì´í„° ë¡œë“œ
            loadTeamCustomers();
        }

        function activateGuaranteeTab(e) {
            e.preventDefault();
            showTab('guarantee');
            
            // ì‚¬ì´ë“œë°” active ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            e.target.closest('.nav-item').classList.add('active');
            
            const section = document.getElementById('guarantee-section');
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            
            // ë³´ì¦ë³´í—˜ ë§¤ë¬¼ ë°ì´í„°ëŠ” ì„œë²„ ë Œë”ë§ìœ¼ë¡œ ì´ë¯¸ ë¡œë“œë˜ì–´ ìˆìŒ
            console.log('ğŸ›¡ï¸ ë³´ì¦ë³´í—˜ë§¤ë¬¼ íƒ­ í™œì„±í™”');
        }

        function showTab(tab) {
            console.log(`ğŸ¯ íƒ­ ì „í™˜: ${tab}`);
            
            const emp = document.getElementById('employee-section');
            const guar = document.getElementById('guarantee-section');
            const maeiple = document.getElementById('maeiple-section');
            const teamMaeiple = document.getElementById('team-maeiple-section');
            const dashboard = document.getElementById('dashboard-section');
            const teamCustomer = document.getElementById('team-customer-section');
            const teamLeaderCustomer = document.getElementById('team-leader-customer-section');
            const teamLeaderMaeiple = document.getElementById('team-leader-maeiple-section');
            
            // ì„¹ì…˜ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
            const sections = {
                'employee': emp,
                'guarantee': guar,
                'maeiple': maeiple,
                'team-maeiple': teamMaeiple,
                'dashboard': dashboard,
                'team-customer': teamCustomer,
                'team-leader-customer': teamLeaderCustomer,
                'team-leader-maeiple': teamLeaderMaeiple
            };
            
            // ëˆ„ë½ëœ ì„¹ì…˜ í™•ì¸
            Object.entries(sections).forEach(([key, element]) => {
                if (!element) {
                    console.error(`âŒ ì„¹ì…˜ ëˆ„ë½: ${key}-section`);
                }
            });
            
            // ëª¨ë“  ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            Object.values(sections).forEach(section => {
                if (section) section.style.display = 'none';
            });
            
            // ì„ íƒëœ íƒ­ë§Œ í‘œì‹œ
            const targetSection = sections[tab];
            if (targetSection) {
                targetSection.style.display = '';
                console.log(`âœ… íƒ­ í‘œì‹œ ì™„ë£Œ: ${tab}`);
            } else {
                console.error(`âŒ ì•Œ ìˆ˜ ì—†ëŠ” íƒ­: ${tab}`);
                // ê¸°ë³¸ì ìœ¼ë¡œ ì§ì› íƒ­ í‘œì‹œ
                if (emp) emp.style.display = '';
            }
        }

        function toggleAddEmployee() {
            const card = document.getElementById('add-employee-card');
            const form = document.getElementById('add-employee-form');
            
            // ìˆ˜ì • ëª¨ë“œì¼ ë•ŒëŠ” í¼ì„ ìˆ¨ê¸°ì§€ ì•ŠìŒ
            if (form.dataset.editMode === 'true') {
                return;
            }
            
            if (card.style.display === 'none' || card.style.display === '') {
                card.style.display = 'block';
            } else {
                card.style.display = 'none';
            }
        }

        // ==================== ë©”ì´í”Œê´€ë¦¬ ê´€ë ¨ í•¨ìˆ˜ë“¤ ====================
        
        // ë§¤ë¬¼ ëª©ë¡ ì¡°íšŒ
        async function loadMaeipeProperties(page = 1) {
            try {
                currentMaeiplePage = page;
                const url = `/api/maeiple?sort_by=${currentSortBy}&sort_order=${currentSortOrder}&page=${page}&per_page=${maeipePerPage}`;
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.success) {
                    properties = data.properties;
                    maeipleTotalPages = data.total_pages || 0;
                    console.log(`ë©”ì´í”Œê´€ë¦¬ ë§¤ë¬¼ ë¡œë“œ: ${properties.length}ê°œ (í˜ì´ì§€ ${page}/${maeipleTotalPages})`);
                    await updateAdminFilters(); // ë‹´ë‹¹ì ë° íŒ€ í•„í„° ì—…ë°ì´íŠ¸ (DBì—ì„œ ì „ì²´ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°)
                    renderMaeipeProperties();
                    renderMaeipePagination();
                } else {
                    showMaeipeError('ë§¤ë¬¼ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('Error:', error);
                showMaeipeError('ë§¤ë¬¼ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ë§¤ë¬¼ ëª©ë¡ ë Œë”ë§
        function renderMaeipeProperties() {
            const tableContent = document.getElementById('maeiple-table-content');
            
            // í•„í„° ì ìš©
            let list = Array.isArray(properties) ? properties.slice() : [];
            
            // í˜„í™© í•„í„°
            if (statusFilter !== 'all') {
                list = list.filter(p => (p.status || '') === statusFilter);
            }
            
            // ì‹¤ê±°ì£¼ í•„í„°
            if (occupiedFilter !== 'all') {
                const want = occupiedFilter === 'O';
                list = list.filter(p => !!p.is_occupied === want);
            }
            
            // ê±°ë˜ìœ í˜• í•„í„° (ê´€ë¦¬ììš©)
            if (dealTypeFilterAdmin !== 'all') {
                list = list.filter(p => {
                    if (dealTypeFilterAdmin === 'ì „ì„¸') {
                        const jeonsePrice = parseInt(String(p.jeonse_price || '0').replace(/[^\d]/g, '')) || 0;
                        return jeonsePrice > 0;
                    } else if (dealTypeFilterAdmin === 'ì›”ì„¸') {
                        const monthlyRent = parseInt(String(p.monthly_rent || '0').replace(/[^\d]/g, '')) || 0;
                        return monthlyRent > 0;
                    } else if (dealTypeFilterAdmin === 'ë§¤ë§¤') {
                        const salePrice = parseInt(String(p.sale_price || '0').replace(/[^\d]/g, '')) || 0;
                        return salePrice > 0;
                    }
                    return true;
                });
            }
            
            // í˜¸ìˆ˜ ê²€ìƒ‰ í•„í„° (ê´€ë¦¬ììš©)
            if (roomSearchFilterAdmin.trim()) {
                const searchTerm = roomSearchFilterAdmin.trim().toLowerCase();
                list = list.filter(p => {
                    const roomNumber = String(p.room_number || '').toLowerCase();
                    return roomNumber.includes(searchTerm);
                });
            }
            
            // ë‹´ë‹¹ì ê²€ìƒ‰ í•„í„° (ê´€ë¦¬ììš©)
            if (employeeSearchFilterAdmin.trim()) {
                const searchTerm = employeeSearchFilterAdmin.trim().toLowerCase();
                list = list.filter(p => {
                    const employeeName = String(p.employee_name || '').toLowerCase();
                    return employeeName.includes(searchTerm);
                });
            }
            
            // íŒ€ í•„í„° (ê´€ë¦¬ììš©)
            if (teamFilterAdmin !== 'all') {
                list = list.filter(p => (p.employee_team || '') === teamFilterAdmin);
            }
            
            if (list.length === 0) {
                tableContent.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #64748b;">
                        <div style="font-size: 48px; margin-bottom: 16px; opacity: 0.5;">ğŸ¢</div>
                        <p>ì¡°ê±´ì— ë§ëŠ” ë§¤ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                        <p>í•„í„°ë¥¼ ë³€ê²½í•˜ê±°ë‚˜ ìƒˆ ë§¤ë¬¼ì„ ì¶”ê°€í•´ë³´ì„¸ìš”.</p>
                    </div>
                `;
                return;
            }
            
            let tableHTML = `
                <table class="employees-table">
                    <thead>
                        <tr>
                            <th style="width: 50px;">
                                <input type="checkbox" id="select-all-properties" onchange="toggleSelectAll(this)" 
                                       style="width: 16px; height: 16px; cursor: pointer;">
                            </th>
                            <th>
                                <div style="display: flex; align-items: center; gap: 4px; cursor: pointer; user-select: none;" onclick="toggleSort('check_date')">
                                    í™•ì¸ë‚ ì§œ
                                    <span style="font-size: 12px; color: #9ca3af;">${currentSortBy === 'check_date' ? (currentSortOrder === 'desc' ? 'â–¼' : 'â–²') : 'â†•ï¸'}</span>
                                </div>
                            </th>
                            <th>ë™</th>
                            <th>í˜¸ìˆ˜</th>
                            <th>í˜„í™©</th>
                            <th>ì „ì„¸ (ë§Œì›)</th>
                            <th>ì›”ì„¸ë³´ì¦ê¸ˆ (ë§Œì›)</th>
                            <th>ì›”ì„¸ (ë§Œì›)</th>
                            <th>ë§¤ë§¤ (ë§Œì›)</th>
                            <th>ì‹¤ê±°ì£¼ ì—¬ë¶€</th>
                            <th>ì „í™”ë²ˆí˜¸</th>
                            <th>íŠ¹ì´ì‚¬í•­</th>
                            <th>ë‹´ë‹¹ì</th>
                            <th>íŒ€</th>
                            <th>ì¢‹ì•„ìš”</th>
                            <th>ì‹«ì–´ìš”</th>
                            <th>ìˆ˜ì •</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            list.forEach(property => {
                const memoPreview = property.memo ? (property.memo.length > 20 ? property.memo.substring(0, 20) + '...' : property.memo) : '';
                
                tableHTML += `
                    <tr data-property-id="${property.id}">
                        <td style="text-align: center;">
                            <input type="checkbox" class="property-checkbox" value="${property.id}" 
                                   onchange="updateSelectionCount()" style="width: 16px; height: 16px; cursor: pointer;">
                        </td>
                        <td class="editable-cell" data-field="check_date" data-type="date" onclick="editPropertyCell(this)" style="cursor: pointer;">${property.check_date || ''}</td>
                        <td class="editable-cell" data-field="building_number" data-type="text" onclick="editPropertyCell(this)" style="cursor: pointer;">${property.building_number || ''}</td>
                        <td class="editable-cell" data-field="room_number" data-type="text" onclick="editPropertyCell(this)" style="cursor: pointer;">${property.room_number || ''}</td>
                        <td class="editable-cell" data-field="status" data-type="select" onclick="editPropertyCell(this)" style="cursor: pointer;">
                            <span class="badge" style="${property.status === 'ê³„ì•½ì™„ë£Œ' ? 'background: #d1fae5; color: #065f46;' : property.status === 'ë³´ë¥˜' ? 'background: #fef3c7; color: #92400e;' : property.status === 'ë¶€ì¬' ? 'background: #ede9fe; color: #5b21b6;' : 'background: #e0f2fe; color: #0369a1;'}; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 500;">
                                ${property.status || 'ê±°ë˜ê°€ëŠ¥'}
                            </span>
                        </td>
                        <td class="editable-cell" data-field="jeonse_price" data-type="number" onclick="editPropertyCell(this)" style="cursor: pointer; color: #2563eb; font-weight: 500;">
                            ${property.jeonse_price ? formatNumber(property.jeonse_price) + ' ë§Œì›' : '-'}
                        </td>
                        <td class="editable-cell" data-field="deposit" data-type="number" onclick="editPropertyCell(this)" style="cursor: pointer; color: #2563eb; font-weight: 500;">
                            ${property.deposit ? formatNumber(property.deposit) + ' ë§Œì›' : '-'}
                        </td>
                        <td class="editable-cell" data-field="monthly_rent" data-type="number" onclick="editPropertyCell(this)" style="cursor: pointer; color: #2563eb; font-weight: 500;">
                            ${property.monthly_rent ? formatNumber(property.monthly_rent) + ' ë§Œì›' : '-'}
                        </td>
                        <td class="editable-cell" data-field="sale_price" data-type="number" onclick="editPropertyCell(this)" style="cursor: pointer; color: #2563eb; font-weight: 500;">
                            ${property.sale_price ? formatNumber(property.sale_price) + ' ë§Œì›' : '-'}
                        </td>
                        <td class="editable-cell" data-field="is_occupied" data-type="select" onclick="editPropertyCell(this)" style="cursor: pointer;">
                            <span class="badge" style="${property.is_occupied ? 'background: #d1fae5; color: #065f46;' : 'background: #fecaca; color: #dc2626;'}; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 500;">
                                ${property.is_occupied ? 'O' : 'X'}
                            </span>
                        </td>
                        <td class="editable-cell" data-field="phone" data-type="text" onclick="editPropertyCell(this)" style="cursor: pointer; font-family: monospace; letter-spacing: 0.5px; max-width: 120px; overflow: hidden; text-overflow: ellipsis;">
                            ${property.phone || '-'}
                        </td>
                        <td class="memo-cell" onclick="openPropertyMemoModal(${property.id}, '${(property.memo || '').replace(/'/g, "\\'")}', '${property.building_number || ''}', '${property.room_number || ''}')" style="color: #64748b; font-style: italic; max-width: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; cursor: pointer;">
                            ${property.memo ? (property.memo.length > 20 ? property.memo.substring(0, 20) + '...' : property.memo) : '-'}
                        </td>
                        <td class="editable-cell" data-field="employee_id" data-type="select" onclick="editPropertyCell(this)" style="cursor: pointer;">
                            <span style="color: #4f46e5; font-weight: 500;">
                                ${property.employee_name || 'ë¯¸ì§€ì •'}
                            </span>
                        </td>
                        <td class="editable-cell" data-field="employee_team" data-type="select" onclick="editPropertyCell(this)" style="cursor: pointer;">
                            <span class="status-badge" style="background: ${getTeamBadgeColor(property.employee_team)}; color: ${getTeamTextColor(property.employee_team)};">
                                ${property.employee_team || 'ë¯¸ì§€ì •'}
                            </span>
                        </td>
                        <td class="editable-cell" data-field="likes" data-type="number" onclick="editPropertyCell(this)" style="cursor: pointer;">
                            <div>
                                ${'â¤ï¸'.repeat(property.likes)}${property.likes === 0 ? 'ğŸ¤' : ''}
                            </div>
                        </td>
                        <td class="editable-cell" data-field="dislikes" data-type="number" onclick="editPropertyCell(this)" style="cursor: pointer;">
                            <div>
                                ${'ğŸ‘'.repeat(property.dislikes)}${property.dislikes === 0 ? 'ğŸ¤' : ''}
                            </div>
                        </td>
                        <td>
                            <div class="edit-controls" data-property-id="${property.id}">
                                <button class="btn btn-outline-primary btn-sm edit-btn" onclick="enableRowEdit(${property.id})" style="font-size: 11px; padding: 4px 8px;">
                                    âœï¸ ìˆ˜ì •
                                </button>
                                <button class="btn btn-success btn-sm complete-btn" onclick="completeRowEdit(${property.id})" style="display: none; font-size: 11px; padding: 4px 8px;">
                                    âœ… ì™„ë£Œ
                                </button>
                            </div>
                        </td>

                    </tr>
                `;
            });
            
            tableHTML += `
                    </tbody>
                </table>
            `;
            
            tableContent.innerHTML = tableHTML;
        }

        // ==================== ë©”ì´í”Œê´€ë¦¬ ì§ì›í˜ì´ì§€ ë°©ì‹ ìˆ˜ì • ê¸°ëŠ¥ ====================
        
        // í–‰ ìˆ˜ì • í™œì„±í™” (ìˆ˜ì • ë²„íŠ¼ í´ë¦­ ì‹œ)
        function enableRowEdit(propertyId) {
            const row = document.querySelector(`tr[data-property-id="${propertyId}"]`);
            if (!row) return;
            
            // í–‰ì— ìˆ˜ì • ëª¨ë“œ í‘œì‹œ
            row.classList.add('edit-mode');
            
            // ëª¨ë“  ì…€ì— ìˆ˜ì • ê°€ëŠ¥ í‘œì‹œ ì¶”ê°€
            const editableCells = row.querySelectorAll('.editable-cell');
            editableCells.forEach(cell => {
                cell.style.border = '2px dashed #3b82f6';
                cell.style.backgroundColor = '#eff6ff';
            });
            
            // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
            const editControls = row.querySelector('.edit-controls');
            if (editControls) {
                editControls.querySelector('.edit-btn').style.display = 'none';
                editControls.querySelector('.complete-btn').style.display = 'inline-block';
            }
            
            showAlert(`ë§¤ë¬¼ ${propertyId}ë²ˆ ìˆ˜ì • ëª¨ë“œê°€ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤. ì›í•˜ëŠ” ì…€ì„ í´ë¦­í•˜ì—¬ ìˆ˜ì •í•˜ì„¸ìš”.`, 'info');
        }
        
        // í–‰ ìˆ˜ì • ì™„ë£Œ (ì™„ë£Œ ë²„íŠ¼ í´ë¦­ ì‹œ)
        function completeRowEdit(propertyId) {
            const row = document.querySelector(`tr[data-property-id="${propertyId}"]`);
            if (!row) return;
            
            // ìˆ˜ì • ëª¨ë“œ í•´ì œ
            row.classList.remove('edit-mode');
            
            // ëª¨ë“  ì…€ì˜ ìˆ˜ì • ê°€ëŠ¥ í‘œì‹œ ì œê±°
            const editableCells = row.querySelectorAll('.editable-cell');
            editableCells.forEach(cell => {
                cell.style.border = '';
                cell.style.backgroundColor = '';
            });
            
            // ë²„íŠ¼ ìƒíƒœ ë³µì›
            const editControls = row.querySelector('.edit-controls');
            if (editControls) {
                editControls.querySelector('.edit-btn').style.display = 'inline-block';
                editControls.querySelector('.complete-btn').style.display = 'none';
            }
            
            showAlert(`ë§¤ë¬¼ ${propertyId}ë²ˆ ìˆ˜ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
        }
        
        // ë§¤ë¬¼ ì…€ í¸ì§‘ (ì§ì›í˜ì´ì§€ ë°©ì‹)
        async function editPropertyCell(cell) {
            // ì´ë¯¸ í¸ì§‘ ì¤‘ì´ë©´ í¸ì§‘ ëª¨ë“œ ì¢…ë£Œ
            if (cell.classList.contains('editing-cell')) {
                const existingSelector = cell.querySelector('.status-selector');
                if (existingSelector) {
                    existingSelector.remove();
                }
                cell.classList.remove('editing-cell');
                return;
            }
            
            const field = cell.dataset.field;
            const type = cell.dataset.type;
            let currentValue = cell.textContent.trim();
            
            // ë°°ì§€ì—ì„œ ì‹¤ì œ ê°’ ì¶”ì¶œ
            if (field === 'status') {
                const badge = cell.querySelector('.badge');
                currentValue = badge ? badge.textContent.trim() : currentValue;
            } else if (field === 'is_occupied') {
                const badge = cell.querySelector('.badge');
                currentValue = badge ? badge.textContent.trim() : currentValue;
            }
            
            console.log(`ë§¤ë¬¼ ì…€ í¸ì§‘ ì‹œì‘: ${field}, íƒ€ì…: ${type}, í˜„ì¬ê°’: "${currentValue}"`);
            
            cell.classList.add('editing-cell');
            
            let inputElement;
            
            // í˜„í™© ì„ íƒ (ë²„íŠ¼ í˜•íƒœ)
            if (type === 'select' && field === 'status') {
                const statusContainer = document.createElement('div');
                statusContainer.className = 'status-selector';
                statusContainer.innerHTML = `
                    <div class="status-options">
                        <button type="button" class="status-option ${currentValue === 'ê±°ë˜ê°€ëŠ¥' ? 'active' : ''}" data-value="ê±°ë˜ê°€ëŠ¥">
                            <span class="status-icon">ğŸ”„</span>
                            <span class="status-text">ê±°ë˜ê°€ëŠ¥</span>
                        </button>
                        <button type="button" class="status-option ${currentValue === 'ê³„ì•½ì™„ë£Œ' ? 'active' : ''}" data-value="ê³„ì•½ì™„ë£Œ">
                            <span class="status-icon">âœ…</span>
                            <span class="status-text">ê³„ì•½ì™„ë£Œ</span>
                        </button>
                        <button type="button" class="status-option ${currentValue === 'ë³´ë¥˜' ? 'active' : ''}" data-value="ë³´ë¥˜">
                            <span class="status-icon">â¸ï¸</span>
                            <span class="status-text">ë³´ë¥˜</span>
                        </button>
                        <button type="button" class="status-option ${currentValue === 'ë¶€ì¬' ? 'active' : ''}" data-value="ë¶€ì¬">
                            <span class="status-icon">âŒ</span>
                            <span class="status-text">ë¶€ì¬</span>
                        </button>
                    </div>
                `;
                
                cell.innerHTML = '';
                cell.appendChild(statusContainer);
                
                // ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
                const buttons = statusContainer.querySelectorAll('.status-option');
                buttons.forEach(btn => {
                    btn.addEventListener('click', async (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        
                        const selectedValue = btn.dataset.value;
                        
                        // í¸ì§‘ ëª¨ë“œ ì¢…ë£Œ ë° UI ì •ë¦¬
                        cell.classList.remove('editing-cell');
                        
                        // UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                        const statusStyle = selectedValue === 'ê³„ì•½ì™„ë£Œ' ? 'background: #d1fae5; color: #065f46;' : 
                                          selectedValue === 'ë³´ë¥˜' ? 'background: #fef3c7; color: #92400e;' : 
                                          selectedValue === 'ë¶€ì¬' ? 'background: #ede9fe; color: #5b21b6;' : 
                                          'background: #e0f2fe; color: #0369a1;';
                        cell.innerHTML = `<span class="badge" style="${statusStyle}; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">${selectedValue}</span>`;
                        
                        // ì„œë²„ì— ì €ì¥
                        const row = cell.closest('tr');
                        const propertyId = row.dataset.propertyId;
                        if (propertyId) {
                            await savePropertyFieldQuiet(propertyId, field, selectedValue);
                        }
                    });
                });
                
                return;
                
            // ì‹¤ê±°ì£¼ ì—¬ë¶€ ì„ íƒ (í† ê¸€ ë°©ì‹)
            } else if (type === 'select' && field === 'is_occupied') {
                const occupiedContainer = document.createElement('div');
                occupiedContainer.className = 'occupied-selector';
                occupiedContainer.innerHTML = `
                    <div class="occupied-options">
                        <button type="button" class="occupied-option ${currentValue === 'X' ? 'active' : ''}" data-value="false">
                            <span class="occupied-icon">ğŸ </span>
                            <span class="occupied-text">X (ë¹ˆì§‘)</span>
                        </button>
                        <button type="button" class="occupied-option ${currentValue === 'O' ? 'active' : ''}" data-value="true">
                            <span class="occupied-icon">ğŸ‘¥</span>
                            <span class="occupied-text">O (ì…ì£¼ì¤‘)</span>
                        </button>
                    </div>
                `;
                
                cell.innerHTML = '';
                cell.appendChild(occupiedContainer);
                
                // ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
                const buttons = occupiedContainer.querySelectorAll('.occupied-option');
                buttons.forEach(btn => {
                    btn.addEventListener('click', async (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        
                        const selectedValue = btn.dataset.value === 'true';
                        const displayValue = selectedValue ? 'O' : 'X';
                        
                        // í¸ì§‘ ëª¨ë“œ ì¢…ë£Œ ë° UI ì •ë¦¬
                        cell.classList.remove('editing-cell');
                        
                        // UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                        const occupiedStyle = selectedValue ? 'background: #d1fae5; color: #065f46;' : 'background: #fecaca; color: #dc2626;';
                        cell.innerHTML = `<span class="badge" style="${occupiedStyle}; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">${displayValue}</span>`;
                        
                        // ì„œë²„ì— ì €ì¥
                        const row = cell.closest('tr');
                        const propertyId = row.dataset.propertyId;
                        if (propertyId) {
                            await savePropertyFieldQuiet(propertyId, field, selectedValue);
                        }
                    });
                });
                
                return;
                
            // ë‹´ë‹¹ì ì„ íƒ
            } else if (type === 'select' && field === 'employee_id') {
                // í˜„ì¬ ë‹´ë‹¹ì ì´ë¦„ ì¶”ì¶œ
                const employeeSpan = cell.querySelector('span');
                const currentEmployeeName = employeeSpan ? employeeSpan.textContent.trim() : currentValue;
                await loadEmployeeSelectForCell(cell, currentEmployeeName);
                return;
                
            // íŒ€ ì„ íƒ
            } else if (type === 'select' && field === 'employee_team') {
                await loadTeamSelectForCell(cell, currentValue);
                return;
                
            // ë©”ëª¨ (textarea) - ë³„ë„ ëª¨ë‹¬ ì²˜ë¦¬ë¡œ ì œì™¸
            } else if (type === 'textarea') {
                // ë©”ëª¨ëŠ” ì§ì ‘ ì…€ í´ë¦­ìœ¼ë¡œ ì²˜ë¦¬í•˜ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠìŒ
                return;
                
            // ì¼ë°˜ ì…ë ¥
            } else {
                inputElement = document.createElement('input');
                inputElement.type = type;
                
                // ìˆ«ì í•„ë“œì¸ ê²½ìš° 'ë§Œì›' ì œê±°
                if (type === 'number' && currentValue.includes('ë§Œì›')) {
                    inputElement.value = currentValue.replace(/[^0-9]/g, '') || '';
                } else if (type === 'number' && field === 'likes') {
                    // ì¢‹ì•„ìš” ì„ íƒ (ë²„íŠ¼ ë°©ì‹)
                    const likesContainer = document.createElement('div');
                    likesContainer.className = 'likes-selector';
                    const currentCount = parseInt(currentValue.match(/\d+/)?.[0]) || 0;
                    
                    let likesHTML = '<div class="likes-options">';
                    for (let i = 0; i <= 5; i++) {
                        likesHTML += `
                            <button type="button" class="likes-option ${currentCount === i ? 'active' : ''}" data-value="${i}">
                                <span class="likes-icon">${'â¤ï¸'.repeat(i)}${i === 0 ? 'ğŸ¤' : ''}</span>
                                <span class="likes-text">${i}</span>
                            </button>
                        `;
                    }
                    likesHTML += '</div>';
                    likesContainer.innerHTML = likesHTML;
                    
                    cell.innerHTML = '';
                    cell.appendChild(likesContainer);
                    
                    // ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
                    const buttons = likesContainer.querySelectorAll('.likes-option');
                    buttons.forEach(btn => {
                        btn.addEventListener('click', async (e) => {
                            e.preventDefault();
                            e.stopPropagation();
                            
                            const selectedValue = parseInt(btn.dataset.value);
                            
                            // í¸ì§‘ ëª¨ë“œ ì¢…ë£Œ ë° UI ì •ë¦¬
                            cell.classList.remove('editing-cell');
                            
                            // UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                            cell.innerHTML = `<div>${'â¤ï¸'.repeat(selectedValue)}${selectedValue === 0 ? 'ğŸ¤' : ''}</div>`;
                            
                            // ì„œë²„ì— ì €ì¥
                            const row = cell.closest('tr');
                            const propertyId = row.dataset.propertyId;
                            if (propertyId) {
                                await savePropertyFieldQuiet(propertyId, field, selectedValue);
                            }
                        });
                    });
                    
                    return;
                    
                } else if (type === 'number' && field === 'dislikes') {
                    // ì‹«ì–´ìš” ì„ íƒ (ë²„íŠ¼ ë°©ì‹)
                    const dislikesContainer = document.createElement('div');
                    dislikesContainer.className = 'dislikes-selector';
                    const currentCount = parseInt(currentValue.match(/\d+/)?.[0]) || 0;
                    
                    let dislikesHTML = '<div class="dislikes-options">';
                    for (let i = 0; i <= 5; i++) {
                        dislikesHTML += `
                            <button type="button" class="dislikes-option ${currentCount === i ? 'active' : ''}" data-value="${i}">
                                <span class="dislikes-icon">${'ğŸ‘'.repeat(i)}${i === 0 ? 'ğŸ¤' : ''}</span>
                                <span class="dislikes-text">${i}</span>
                            </button>
                        `;
                    }
                    dislikesHTML += '</div>';
                    dislikesContainer.innerHTML = dislikesHTML;
                    
                    cell.innerHTML = '';
                    cell.appendChild(dislikesContainer);
                    
                    // ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
                    const buttons = dislikesContainer.querySelectorAll('.dislikes-option');
                    buttons.forEach(btn => {
                        btn.addEventListener('click', async (e) => {
                            e.preventDefault();
                            e.stopPropagation();
                            
                            const selectedValue = parseInt(btn.dataset.value);
                            
                            // í¸ì§‘ ëª¨ë“œ ì¢…ë£Œ ë° UI ì •ë¦¬
                            cell.classList.remove('editing-cell');
                            
                            // UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                            cell.innerHTML = `<div>${'ğŸ‘'.repeat(selectedValue)}${selectedValue === 0 ? 'ğŸ¤' : ''}</div>`;
                            
                            // ì„œë²„ì— ì €ì¥
                            const row = cell.closest('tr');
                            const propertyId = row.dataset.propertyId;
                            if (propertyId) {
                                await savePropertyFieldQuiet(propertyId, field, selectedValue);
                            }
                        });
                    });
                    
                    return;
                    
                } else {
                    inputElement.value = currentValue === '-' ? '' : currentValue;
                }
                
                // ë‚ ì§œ í•„ë“œì´ê³  ê°’ì´ ë¹„ì–´ìˆìœ¼ë©´ ì˜¤ëŠ˜ ë‚ ì§œë¡œ ìë™ ì…ë ¥
                if (type === 'date' && !inputElement.value) {
                    const now = new Date();
                    now.setHours(now.getHours() + 9);
                    inputElement.value = now.toISOString().slice(0, 10);
                }
            }
            
            // ê³µí†µ ìŠ¤íƒ€ì¼ ì ìš©
            inputElement.style.cssText = 'width: 100%; padding: 4px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 12px;';
            
            cell.innerHTML = '';
            cell.appendChild(inputElement);
            inputElement.focus();
            
            // ì €ì¥ í•¨ìˆ˜
            const saveCell = async (moveNext = false) => {
                const newValue = inputElement.value.trim();
                
                // í¸ì§‘ ëª¨ë“œ ì¢…ë£Œ
                cell.classList.remove('editing-cell');
                
                // UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                if (field === 'is_occupied') {
                    const occupiedDisplay = newValue === 'true' ? 'O' : 'X';
                    const occupiedStyle = newValue === 'true' ? 'background: #d1fae5; color: #065f46;' : 'background: #fecaca; color: #dc2626;';
                    cell.innerHTML = `<span class="badge" style="${occupiedStyle}; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">${occupiedDisplay}</span>`;
                } else if (type === 'number' && ['jeonse_price', 'deposit', 'monthly_rent', 'sale_price'].includes(field)) {
                    // ê°€ê²© í•„ë“œëŠ” 'ë§Œì›' ì¶”ê°€
                    cell.textContent = newValue ? parseInt(newValue).toLocaleString() + ' ë§Œì›' : '-';
                } else if (type === 'number' && ['likes', 'dislikes'].includes(field)) {
                    // ì¢‹ì•„ìš”/ì‹«ì–´ìš”ëŠ” ì´ëª¨ì§€ë¡œ í‘œì‹œ
                    const count = parseInt(newValue) || 0;
                    if (field === 'likes') {
                        cell.innerHTML = `<div>${'â¤ï¸'.repeat(count)}${count === 0 ? 'ğŸ¤' : ''}</div>`;
                    } else {
                        cell.innerHTML = `<div>${'ğŸ‘'.repeat(count)}${count === 0 ? 'ğŸ¤' : ''}</div>`;
                    }
                } else if (field === 'memo') {
                    const preview = newValue.length > 20 ? newValue.substring(0, 20) + '...' : newValue;
                    cell.textContent = preview || 'ë©”ëª¨ ì¶”ê°€...';
                } else {
                    cell.textContent = newValue || '-';
                }
                
                // ì„œë²„ì— ì €ì¥
                const row = cell.closest('tr');
                const propertyId = row.dataset.propertyId;
                if (propertyId) {
                    let saveValue = newValue;
                    if (field === 'is_occupied') {
                        saveValue = newValue === 'true';
                    } else if (['likes', 'dislikes'].includes(field)) {
                        saveValue = parseInt(newValue) || 0;
                    } else if (['jeonse_price', 'deposit', 'monthly_rent', 'sale_price'].includes(field)) {
                        saveValue = newValue ? parseInt(newValue) : null;
                    }
                    
                    await savePropertyFieldQuiet(propertyId, field, saveValue);
                }
                
                // ì—”í„°ë¡œ ì €ì¥ í›„ ì˜† ì…€ë¡œ ì´ë™
                if (moveNext) {
                    const editableCells = Array.from(cell.parentElement.querySelectorAll('.editable-cell'));
                    const idx = editableCells.indexOf(cell);
                    if (idx !== -1 && idx < editableCells.length - 1) {
                        setTimeout(() => editPropertyCell(editableCells[idx + 1]), 50);
                    }
                }
            };
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            inputElement.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    saveCell(true); // ì—”í„°í‚¤ë¡œ ë‹¤ìŒ ì…€ë¡œ ì´ë™
                } else if (e.key === 'Escape') {
                    e.preventDefault();
                    cancelPropertyCellEdit(cell, currentValue);
                } else if (e.key === 'Tab') {
                    e.preventDefault();
                    saveCell(true); // íƒ­í‚¤ë¡œ ë‹¤ìŒ ì…€ë¡œ ì´ë™
                }
            });
            
            inputElement.addEventListener('blur', () => {
                saveCell();
            });
        }
        
        // ë‹´ë‹¹ì ì„ íƒì„ ìœ„í•œ ì…€ ì²˜ë¦¬
        async function loadEmployeeSelectForCell(cell, currentEmployeeName) {
            try {
                const response = await fetch('/api/employees?per_page=1000');
                if (response.ok) {
                    const data = await response.json();
                    const employees = data.employees || [];
                    
                    const selectElement = document.createElement('select');
                    selectElement.style.cssText = 'width: 100%; padding: 4px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 12px;';
                    selectElement.innerHTML = '<option value="">ë‹´ë‹¹ì ì„ íƒ</option>';
                    
                    employees.forEach(emp => {
                        const selected = emp.employee_name === currentEmployeeName ? 'selected' : '';
                        selectElement.innerHTML += `<option value="${emp.id}" ${selected}>${emp.employee_name} (${emp.team || 'ë¯¸ì§€ì •'})</option>`;
                    });
                    
                    cell.innerHTML = '';
                    cell.appendChild(selectElement);
                    selectElement.focus();
                    
                    // ì €ì¥ í•¨ìˆ˜
                    const saveCell = async () => {
                        const selectedOption = selectElement.options[selectElement.selectedIndex];
                        const employeeId = selectElement.value;
                        const employeeName = selectedOption ? selectedOption.text.split(' (')[0] : '';
                        
                        console.log('ë‹´ë‹¹ì ë³€ê²½:', { employeeId, employeeName });
                        
                        cell.classList.remove('editing-cell');
                        cell.innerHTML = `<span style="color: #4f46e5; font-weight: 500;">${employeeName || 'ë¯¸ì§€ì •'}</span>`;
                        
                        // ì„œë²„ì— ì €ì¥
                        const row = cell.closest('tr');
                        const propertyId = row.dataset.propertyId;
                        if (propertyId) {
                            try {
                                // ë‹´ë‹¹ì IDì™€ ì´ë¦„ì„ ë™ì‹œì— ì €ì¥
                                const updateData = {
                                    employee_id: employeeId || null,
                                    employee_name: employeeName || null
                                };
                                
                                const response = await fetch(`/api/maeiple/${propertyId}/update`, {
                                    method: 'PUT',
                                    headers: {
                                        'Content-Type': 'application/json'
                                    },
                                    body: JSON.stringify(updateData)
                                });
                                
                                if (response.ok) {
                                    console.log('ë‹´ë‹¹ì ì €ì¥ ì™„ë£Œ:', { employeeId, employeeName });
                                    
                                    // ë¡œì»¬ ë°ì´í„°ë„ ì—…ë°ì´íŠ¸ (ìˆœì„œ ìœ ì§€)
                                    const property = properties.find(p => p.id == propertyId);
                                    if (property) {
                                        property.employee_id = employeeId;
                                        property.employee_name = employeeName;
                                    }
                                } else {
                                    throw new Error('ë‹´ë‹¹ì ì €ì¥ ì‹¤íŒ¨');
                                }
                            } catch (error) {
                                console.error('ë‹´ë‹¹ì ì €ì¥ ì˜¤ë¥˜:', error);
                                showAlert('ë‹´ë‹¹ì ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                            }
                        }
                    };
                    
                    selectElement.addEventListener('change', saveCell);
                    selectElement.addEventListener('blur', saveCell);
                    selectElement.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' || e.key === 'Tab') {
                            e.preventDefault();
                            saveCell();
                        } else if (e.key === 'Escape') {
                            e.preventDefault();
                            cancelPropertyCellEdit(cell, currentEmployeeName);
                        }
                    });
                }
            } catch (error) {
                console.error('ì§ì› ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜:', error);
            }
        }
        
        // íŒ€ ì„ íƒì„ ìœ„í•œ ì…€ ì²˜ë¦¬
        async function loadTeamSelectForCell(cell, currentTeam) {
            try {
                const response = await fetch('/api/teams');
                if (response.ok) {
                    const data = await response.json();
                    const teams = data.teams || [];
                    
                    const selectElement = document.createElement('select');
                    selectElement.style.cssText = 'width: 100%; padding: 4px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 12px;';
                    selectElement.innerHTML = '<option value="">íŒ€ ì„ íƒ</option>';
                    
                    teams.forEach(team => {
                        const selected = team.name === currentTeam ? 'selected' : '';
                        selectElement.innerHTML += `<option value="${team.name}" ${selected}>${team.name}</option>`;
                    });
                    
                    cell.innerHTML = '';
                    cell.appendChild(selectElement);
                    selectElement.focus();
                    
                    // ì €ì¥ í•¨ìˆ˜
                    const saveCell = async () => {
                        const teamName = selectElement.value;
                        
                        cell.classList.remove('editing-cell');
                        cell.innerHTML = `<span class="status-badge" style="background: ${getTeamBadgeColor(teamName)}; color: ${getTeamTextColor(teamName)};">${teamName || 'ë¯¸ì§€ì •'}</span>`;
                        
                        // ì„œë²„ì— ì €ì¥
                        const row = cell.closest('tr');
                        const propertyId = row.dataset.propertyId;
                        if (propertyId) {
                            await savePropertyFieldQuiet(propertyId, 'employee_team', teamName);
                            
                            // ë¡œì»¬ ë°ì´í„°ë„ ì—…ë°ì´íŠ¸ (ìˆœì„œ ìœ ì§€)
                            const property = properties.find(p => p.id == propertyId);
                            if (property) {
                                property.employee_team = teamName;
                            }
                        }
                    };
                    
                    selectElement.addEventListener('change', saveCell);
                    selectElement.addEventListener('blur', saveCell);
                    selectElement.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' || e.key === 'Tab') {
                            e.preventDefault();
                            saveCell();
                        } else if (e.key === 'Escape') {
                            e.preventDefault();
                            cancelPropertyCellEdit(cell, currentTeam);
                        }
                    });
                }
            } catch (error) {
                console.error('íŒ€ ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜:', error);
            }
        }
        
        // ì…€ í¸ì§‘ ì·¨ì†Œ
        function cancelPropertyCellEdit(cell, originalValue) {
            cell.classList.remove('editing-cell');
            
            const field = cell.dataset.field;
            
            if (field === 'status') {
                const statusStyle = originalValue === 'ê³„ì•½ì™„ë£Œ' ? 'background: #d1fae5; color: #065f46;' : 
                                   originalValue === 'ë³´ë¥˜' ? 'background: #fef3c7; color: #92400e;' : 
                                   originalValue === 'ë¶€ì¬' ? 'background: #ede9fe; color: #5b21b6;' : 
                                   'background: #e0f2fe; color: #0369a1;';
                cell.innerHTML = `<span class="badge" style="${statusStyle}; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">${originalValue}</span>`;
            } else if (field === 'is_occupied') {
                const occupiedDisplay = originalValue === 'O' ? 'O' : 'X';
                const occupiedStyle = originalValue === 'O' ? 'background: #d1fae5; color: #065f46;' : 'background: #fecaca; color: #dc2626;';
                cell.innerHTML = `<span class="badge" style="${occupiedStyle}; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">${occupiedDisplay}</span>`;
            } else {
                cell.textContent = originalValue;
            }
        }
        
        // ìˆ˜ì • ëª¨ë“œ ì‹œì‘ (ìˆ˜ì • ë²„íŠ¼ í´ë¦­ ì‹œ)
        function startEditProperty(propertyId) {
            const row = document.querySelector(`tr[data-property-id="${propertyId}"]`);
            if (!row) return;
            
            // í˜„ì¬ ë§¤ë¬¼ ë°ì´í„° ì°¾ê¸°
            const property = properties.find(p => p.id === propertyId);
            if (!property) {
                showAlert('ë§¤ë¬¼ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            
            // ëª¨ë“  ì…€ì„ ìˆ˜ì • ê°€ëŠ¥í•œ inputìœ¼ë¡œ ë³€ê²½
            const cells = row.querySelectorAll('td');
            
            // ê° í•„ë“œë³„ë¡œ ì ì ˆí•œ input ìƒì„±
            cells[0].innerHTML = `<input type="date" value="${property.check_date || ''}" class="edit-input" data-field="check_date" style="width: 100%; padding: 4px;">`;
            cells[1].innerHTML = `<input type="text" value="${property.building_number || ''}" class="edit-input" data-field="building_number" placeholder="ë™" style="width: 100%; padding: 4px;">`;
            cells[2].innerHTML = `<input type="text" value="${property.room_number || ''}" class="edit-input" data-field="room_number" placeholder="í˜¸ìˆ˜" style="width: 100%; padding: 4px;">`;
            
            // í˜„í™© ì„ íƒ
            cells[3].innerHTML = `
                <select class="edit-input" data-field="status" style="width: 100%; padding: 4px;">
                    <option value="ê±°ë˜ê°€ëŠ¥" ${(property.status || 'ê±°ë˜ê°€ëŠ¥') === 'ê±°ë˜ê°€ëŠ¥' ? 'selected' : ''}>ê±°ë˜ê°€ëŠ¥</option>
                    <option value="ê³„ì•½ì™„ë£Œ" ${property.status === 'ê³„ì•½ì™„ë£Œ' ? 'selected' : ''}>ê³„ì•½ì™„ë£Œ</option>
                    <option value="ë³´ë¥˜" ${property.status === 'ë³´ë¥˜' ? 'selected' : ''}>ë³´ë¥˜</option>
                    <option value="ë¶€ì¬" ${property.status === 'ë¶€ì¬' ? 'selected' : ''}>ë¶€ì¬</option>
                </select>
            `;
            
            // ê°€ê²© í•„ë“œë“¤
            cells[4].innerHTML = `<input type="number" value="${property.jeonse_price || ''}" class="edit-input" data-field="jeonse_price" placeholder="ì „ì„¸ê°€" style="width: 100%; padding: 4px;">`;
            cells[5].innerHTML = `<input type="number" value="${property.deposit || ''}" class="edit-input" data-field="deposit" placeholder="ë³´ì¦ê¸ˆ" style="width: 100%; padding: 4px;">`;
            cells[6].innerHTML = `<input type="number" value="${property.monthly_rent || ''}" class="edit-input" data-field="monthly_rent" placeholder="ì›”ì„¸" style="width: 100%; padding: 4px;">`;
            cells[7].innerHTML = `<input type="number" value="${property.sale_price || ''}" class="edit-input" data-field="sale_price" placeholder="ë§¤ë§¤ê°€" style="width: 100%; padding: 4px;">`;
            
            // ì‹¤ê±°ì£¼ ì—¬ë¶€
            cells[8].innerHTML = `
                <select class="edit-input" data-field="is_occupied" style="width: 100%; padding: 4px;">
                    <option value="true" ${property.is_occupied ? 'selected' : ''}>O</option>
                    <option value="false" ${!property.is_occupied ? 'selected' : ''}>X</option>
                </select>
            `;
            
            // ì „í™”ë²ˆí˜¸, ë©”ëª¨
            cells[9].innerHTML = `<input type="tel" value="${property.phone || ''}" class="edit-input" data-field="phone" placeholder="ì „í™”ë²ˆí˜¸" style="width: 100%; padding: 4px;">`;
            cells[10].innerHTML = `<textarea class="edit-input" data-field="memo" placeholder="íŠ¹ì´ì‚¬í•­" style="width: 100%; padding: 4px; min-height: 60px;">${property.memo || ''}</textarea>`;
            
            // ë‹´ë‹¹ì ì„ íƒ (ë¹„ë™ê¸°)
            loadEmployeeSelectForEdit(cells[11], property.employee_id, property.employee_name);
            
            // íŒ€ ì„ íƒ (ë¹„ë™ê¸°)
            loadTeamSelectForEdit(cells[12], property.employee_team);
            
            // ì¢‹ì•„ìš”, ì‹«ì–´ìš”
            cells[13].innerHTML = `<input type="number" value="${property.likes || 0}" class="edit-input" data-field="likes" min="0" style="width: 100%; padding: 4px;">`;
            cells[14].innerHTML = `<input type="number" value="${property.dislikes || 0}" class="edit-input" data-field="dislikes" min="0" style="width: 100%; padding: 4px;">`;
            
            // í¸ì§‘ ì¤‘ì¸ ì…€ë“¤ì— ìŠ¤íƒ€ì¼ ì¶”ê°€
            for (let i = 0; i <= 14; i++) {
                if (cells[i]) {
                    cells[i].classList.add('editing');
                }
            }
            
            // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
            const editControls = row.querySelector('.edit-controls');
            if (editControls) {
                editControls.querySelector('.edit-btn').style.display = 'none';
                editControls.querySelector('.save-btn').style.display = 'inline-block';
                editControls.querySelector('.cancel-btn').style.display = 'inline-block';
            }
            
            console.log(`âœ… ë§¤ë¬¼ ${propertyId} ìˆ˜ì • ëª¨ë“œ ì‹œì‘`);
        }
        
        // ë‹´ë‹¹ì ì„ íƒì„ ìœ„í•œ input ìƒì„±
        async function loadEmployeeSelectForEdit(cell, currentEmployeeId, currentEmployeeName) {
            try {
                const response = await fetch('/api/employees?per_page=1000');
                if (response.ok) {
                    const data = await response.json();
                    const employees = data.employees || [];
                    
                    let selectHTML = '<select class="edit-input" data-field="employee_id" style="width: 100%; padding: 4px;">';
                    selectHTML += '<option value="">ë‹´ë‹¹ì ì„ íƒ</option>';
                    
                    employees.forEach(emp => {
                        const selected = emp.id === currentEmployeeId ? 'selected' : '';
                        selectHTML += `<option value="${emp.id}" ${selected}>${emp.employee_name} (${emp.team || 'ë¯¸ì§€ì •'})</option>`;
                    });
                    
                    selectHTML += '</select>';
                    cell.innerHTML = selectHTML;
                    cell.classList.add('editing');
                }
            } catch (error) {
                console.error('ì§ì› ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜:', error);
                cell.innerHTML = `<input type="text" value="${currentEmployeeName || ''}" class="edit-input" data-field="employee_name" placeholder="ë‹´ë‹¹ìëª…" style="width: 100%; padding: 4px;">`;
                cell.classList.add('editing');
            }
        }
        
        // íŒ€ ì„ íƒì„ ìœ„í•œ input ìƒì„±
        async function loadTeamSelectForEdit(cell, currentTeam) {
            try {
                const response = await fetch('/api/teams');
                if (response.ok) {
                    const data = await response.json();
                    const teams = data.teams || [];
                    
                    let selectHTML = '<select class="edit-input" data-field="employee_team" style="width: 100%; padding: 4px;">';
                    selectHTML += '<option value="">íŒ€ ì„ íƒ</option>';
                    
                    teams.forEach(team => {
                        const selected = team.name === currentTeam ? 'selected' : '';
                        selectHTML += `<option value="${team.name}" ${selected}>${team.name}</option>`;
                    });
                    
                    selectHTML += '</select>';
                    cell.innerHTML = selectHTML;
                    cell.classList.add('editing');
                }
            } catch (error) {
                console.error('íŒ€ ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜:', error);
                cell.innerHTML = `<input type="text" value="${currentTeam || ''}" class="edit-input" data-field="employee_team" placeholder="íŒ€ëª…" style="width: 100%; padding: 4px;">`;
                cell.classList.add('editing');
            }
        }
        
        // ìˆ˜ì • ë‚´ìš© ì €ì¥ (ì™„ë£Œ ë²„íŠ¼ í´ë¦­ ì‹œ)
        async function savePropertyChanges(propertyId) {
            const row = document.querySelector(`tr[data-property-id="${propertyId}"]`);
            if (!row) return;
            
            try {
                // ìˆ˜ì •ëœ ë°ì´í„° ìˆ˜ì§‘
                const updatedData = {};
                const editInputs = row.querySelectorAll('.edit-input');
                
                editInputs.forEach(input => {
                    const fieldName = input.dataset.field;
                    let value = input.value.trim();
                    
                    // íŠ¹ë³„í•œ ì²˜ë¦¬ê°€ í•„ìš”í•œ í•„ë“œë“¤
                    if (fieldName === 'is_occupied') {
                        value = value === 'true';
                    } else if (['likes', 'dislikes'].includes(fieldName)) {
                        value = parseInt(value) || 0;
                    } else if (['jeonse_price', 'deposit', 'monthly_rent', 'sale_price'].includes(fieldName)) {
                        value = value ? parseInt(value) : null;
                    }
                    
                    updatedData[fieldName] = value;
                });
                
                console.log('ìˆ˜ì •ë  ë°ì´í„°:', updatedData);
                
                // API í˜¸ì¶œí•˜ì—¬ ë°ì´í„° ì—…ë°ì´íŠ¸
                const response = await fetch(`/api/maeiple/${propertyId}/update`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(updatedData)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showAlert('ë§¤ë¬¼ ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                    
                    // ìˆ˜ì • ëª¨ë“œ ì¢…ë£Œ
                    finishEditProperty(propertyId);
                    
                    // ë§¤ë¬¼ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                    loadMaeipleProperties();
                } else {
                    showAlert(result.message || 'ë§¤ë¬¼ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                }
                
            } catch (error) {
                console.error('ë§¤ë¬¼ ìˆ˜ì • ì˜¤ë¥˜:', error);
                showAlert('ë§¤ë¬¼ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }
        
        // ìˆ˜ì • ì·¨ì†Œ
        function cancelPropertyEdit(propertyId) {
            const row = document.querySelector(`tr[data-property-id="${propertyId}"]`);
            if (!row) return;
            
            // ìˆ˜ì • ëª¨ë“œ ì¢…ë£Œ
            finishEditProperty(propertyId);
            
            // ë§¤ë¬¼ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ (ì›ë˜ ë°ì´í„°ë¡œ ë³µì›)
            loadMaeipleProperties();
            
            showAlert('ìˆ˜ì •ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
        }
        
        // ìˆ˜ì • ëª¨ë“œ ì¢…ë£Œ
        function finishEditProperty(propertyId) {
            const row = document.querySelector(`tr[data-property-id="${propertyId}"]`);
            if (!row) return;
            
            // í¸ì§‘ ì¤‘ì¸ ì…€ë“¤ ì •ë¦¬
            const editingCells = row.querySelectorAll('td.editing');
            editingCells.forEach(cell => {
                cell.classList.remove('editing');
            });
            
            // ë²„íŠ¼ ìƒíƒœ ë³µì›
            const editControls = row.querySelector('.edit-controls');
            if (editControls) {
                editControls.querySelector('.edit-btn').style.display = 'inline-block';
                editControls.querySelector('.save-btn').style.display = 'none';
                editControls.querySelector('.cancel-btn').style.display = 'none';
            }
        }
        
        // ê°œë³„ í•„ë“œ ì €ì¥ (ì¡°ìš©íˆ, ë©”ì‹œì§€ ì—†ìŒ)
        async function savePropertyFieldQuiet(propertyId, field, value) {
            try {
                const response = await fetch('/api/maeiple/update', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        id: propertyId,
                        field: field,
                        value: value
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    console.log(`âœ… ë§¤ë¬¼ ${propertyId} ${field} ì—…ë°ì´íŠ¸ ì„±ê³µ:`, value);
                    
                    // ë¡œì»¬ ë°ì´í„°ë„ ì—…ë°ì´íŠ¸ (ìˆœì„œ ìœ ì§€)
                    const property = properties.find(p => p.id == propertyId);
                    if (property) {
                        property[field] = value;
                    }
                } else {
                    console.error(`âŒ ë§¤ë¬¼ ${propertyId} ${field} ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:`, result.message);
                }
            } catch (error) {
                console.error(`âŒ ë§¤ë¬¼ ${propertyId} ${field} ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:`, error);
            }
        }
        

        
        // ==================== ì •ë ¬ ê¸°ëŠ¥ ====================

        // ì •ë ¬ ê¸°ëŠ¥
        async function toggleSort(field) {
            if (currentSortBy === field) {
                currentSortOrder = currentSortOrder === 'desc' ? 'asc' : 'desc';
            } else {
                currentSortBy = field;
                currentSortOrder = 'desc';
            }
            await loadMaeipeProperties();
        }
        
        // íŒ€ì¥ìš© ì •ë ¬ ê¸°ëŠ¥
        async function toggleTeamSort(field) {
            if (currentTeamSortBy === field) {
                currentTeamSortOrder = currentTeamSortOrder === 'desc' ? 'asc' : 'desc';
            } else {
                currentTeamSortBy = field;
                currentTeamSortOrder = 'desc';
            }
            await loadTeamMaeipeProperties();
        }

        // ìˆ«ì 3ìë¦¬ ì½¤ë§ˆ
        function formatNumber(val) {
            const n = typeof val === 'number' ? val : parseInt(String(val).replace(/[^\d-]/g, ''), 10);
            if (isNaN(n)) return '';
            return n.toLocaleString('ko-KR');
        }

        // ==================== ì²´í¬ë°•ìŠ¤ ë° ì¼ê´„ ì²˜ë¦¬ ê¸°ëŠ¥ ====================
        
        // ì „ì²´ ì„ íƒ/í•´ì œ
        function toggleSelectAll(selectAllCheckbox) {
            const propertyCheckboxes = document.querySelectorAll('.property-checkbox');
            propertyCheckboxes.forEach(checkbox => {
                checkbox.checked = selectAllCheckbox.checked;
            });
            updateSelectionCount();
        }
        
        // ì„ íƒ ê°œìˆ˜ ì—…ë°ì´íŠ¸ ë° ì¼ê´„ ì²˜ë¦¬ íŒ¨ë„ í‘œì‹œ/ìˆ¨ê¹€
        function updateSelectionCount() {
            const selectedCheckboxes = document.querySelectorAll('.property-checkbox:checked');
            const count = selectedCheckboxes.length;
            
            // ì„ íƒ ê°œìˆ˜ í‘œì‹œ
            const countElement = document.getElementById('selected-count');
            if (countElement) {
                countElement.textContent = `${count}ê°œ`;
            }
            
            // ì¼ê´„ ì²˜ë¦¬ íŒ¨ë„ í‘œì‹œ/ìˆ¨ê¹€
            const bulkPanel = document.getElementById('bulk-actions-panel');
            if (bulkPanel) {
                bulkPanel.style.display = count > 0 ? 'block' : 'none';
            }
            
            // ì „ì²´ ì„ íƒ ì²´í¬ë°•ìŠ¤ ìƒíƒœ ì—…ë°ì´íŠ¸
            const selectAllCheckbox = document.getElementById('select-all-properties');
            const totalCheckboxes = document.querySelectorAll('.property-checkbox');
            if (selectAllCheckbox && totalCheckboxes.length > 0) {
                selectAllCheckbox.checked = count === totalCheckboxes.length;
                selectAllCheckbox.indeterminate = count > 0 && count < totalCheckboxes.length;
            }
        }
        
        // ì„ íƒ í•´ì œ
        function clearSelection() {
            const allCheckboxes = document.querySelectorAll('.property-checkbox, #select-all-properties');
            allCheckboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            updateSelectionCount();
        }
        
        // ì¼ê´„ ë‹´ë‹¹ì ë³€ê²½
        async function bulkAssignEmployee() {
            const selectedCheckboxes = document.querySelectorAll('.property-checkbox:checked');
            const employeeSelect = document.getElementById('bulk-employee-select');
            
            if (selectedCheckboxes.length === 0) {
                showAlert('ì„ íƒëœ ë§¤ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤.', 'warning');
                return;
            }
            
            if (!employeeSelect.value) {
                showAlert('ë‹´ë‹¹ìë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.', 'warning');
                return;
            }
            
            const selectedIds = Array.from(selectedCheckboxes).map(cb => cb.value);
            const employeeId = employeeSelect.value;
            const employeeName = employeeSelect.options[employeeSelect.selectedIndex].text.split(' (')[0];
            
            if (!confirm(`ì„ íƒëœ ${selectedIds.length}ê°œ ë§¤ë¬¼ì˜ ë‹´ë‹¹ìë¥¼ "${employeeName}"ìœ¼ë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                return;
            }
            
            try {
                const response = await fetch('/api/maeiple/bulk-assign', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        property_ids: selectedIds,
                        employee_id: employeeId,
                        employee_name: employeeName
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showAlert(`${selectedIds.length}ê°œ ë§¤ë¬¼ì˜ ë‹´ë‹¹ìê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
                    console.log('âœ… ì„œë²„ì—ì„œ ì¼ê´„ ë‹´ë‹¹ì ë³€ê²½ ì„±ê³µ ì‘ë‹µ ë°›ìŒ');
                    
                    // ë¡œì»¬ ë°ì´í„° ì—…ë°ì´íŠ¸ (ìˆœì„œ ìœ ì§€ë¥¼ ìœ„í•´ ì „ì²´ ìƒˆë¡œê³ ì¹¨ ëŒ€ì‹ )
                    selectedIds.forEach(propertyId => {
                        const property = properties.find(p => p.id == propertyId);
                        if (property) {
                            console.log(`ğŸ”„ ë¡œì»¬ ë°ì´í„° ì—…ë°ì´íŠ¸: ë§¤ë¬¼ ${propertyId} ë‹´ë‹¹ì ${property.employee_name} â†’ ${employeeName}`);
                            property.employee_id = employeeId;
                            property.employee_name = employeeName;
                        }
                    });
                    
                    // UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                    renderMaeipeProperties();
                    clearSelection();
                    
                    // 5ì´ˆ í›„ ì„œë²„ì—ì„œ ë‹¤ì‹œ í™•ì¸ (ë””ë²„ê¹…ìš©)
                    setTimeout(async () => {
                        console.log('ğŸ” 5ì´ˆ í›„ ì„œë²„ ë°ì´í„° í™•ì¸ ì¤‘...');
                        const checkResponse = await fetch(`/api/maeiple?sort_by=${currentSortBy}&sort_order=${currentSortOrder}&page=${currentMaeiplePage}&per_page=${maeipePerPage}`);
                        const checkData = await checkResponse.json();
                        if (checkData.success && checkData.properties) {
                            const updatedProperties = checkData.properties.filter(p => selectedIds.includes(String(p.id)));
                            updatedProperties.forEach(prop => {
                                console.log(`ğŸ“Š ì„œë²„ í™•ì¸: ë§¤ë¬¼ ${prop.id} ë‹´ë‹¹ì = ${prop.employee_name} (${prop.employee_id})`);
                            });
                        }
                    }, 5000);
                } else {
                    showAlert('ë‹´ë‹¹ì ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + (result.message || result.error), 'error');
                }
            } catch (error) {
                console.error('ì¼ê´„ ë‹´ë‹¹ì ë³€ê²½ ì˜¤ë¥˜:', error);
                showAlert('ë‹´ë‹¹ì ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }
        
        // ì¼ê´„ íŒ€ ë³€ê²½
        async function bulkAssignTeam() {
            const selectedCheckboxes = document.querySelectorAll('.property-checkbox:checked');
            const teamSelect = document.getElementById('bulk-team-select');
            
            if (selectedCheckboxes.length === 0) {
                showAlert('ì„ íƒëœ ë§¤ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤.', 'warning');
                return;
            }
            
            if (!teamSelect.value) {
                showAlert('íŒ€ì„ ì„ íƒí•´ì£¼ì„¸ìš”.', 'warning');
                return;
            }
            
            const selectedIds = Array.from(selectedCheckboxes).map(cb => cb.value);
            const teamName = teamSelect.value;
            
            if (!confirm(`ì„ íƒëœ ${selectedIds.length}ê°œ ë§¤ë¬¼ì˜ íŒ€ì„ "${teamName}"ìœ¼ë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                return;
            }
            
            try {
                const response = await fetch('/api/maeiple/bulk-assign-team', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        property_ids: selectedIds,
                        team_name: teamName
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showAlert(`${selectedIds.length}ê°œ ë§¤ë¬¼ì˜ íŒ€ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
                    console.log('âœ… ì„œë²„ì—ì„œ ì¼ê´„ íŒ€ ë³€ê²½ ì„±ê³µ ì‘ë‹µ ë°›ìŒ');
                    
                    // ë¡œì»¬ ë°ì´í„° ì—…ë°ì´íŠ¸ (ìˆœì„œ ìœ ì§€ë¥¼ ìœ„í•´ ì „ì²´ ìƒˆë¡œê³ ì¹¨ ëŒ€ì‹ )
                    selectedIds.forEach(propertyId => {
                        const property = properties.find(p => p.id == propertyId);
                        if (property) {
                            console.log(`ğŸ”„ ë¡œì»¬ ë°ì´í„° ì—…ë°ì´íŠ¸: ë§¤ë¬¼ ${propertyId} íŒ€ ${property.employee_team} â†’ ${teamName}`);
                            property.employee_team = teamName;
                        }
                    });
                    
                    // UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                    renderMaeipeProperties();
                    clearSelection();
                    
                    // 5ì´ˆ í›„ ì„œë²„ì—ì„œ ë‹¤ì‹œ í™•ì¸ (ë””ë²„ê¹…ìš©)
                    setTimeout(async () => {
                        console.log('ğŸ” 5ì´ˆ í›„ ì„œë²„ ë°ì´í„° í™•ì¸ ì¤‘...');
                        const checkResponse = await fetch(`/api/maeiple?sort_by=${currentSortBy}&sort_order=${currentSortOrder}&page=${currentMaeiplePage}&per_page=${maeipePerPage}`);
                        const checkData = await checkResponse.json();
                        if (checkData.success && checkData.properties) {
                            const updatedProperties = checkData.properties.filter(p => selectedIds.includes(String(p.id)));
                            updatedProperties.forEach(prop => {
                                console.log(`ğŸ“Š ì„œë²„ í™•ì¸: ë§¤ë¬¼ ${prop.id} íŒ€ = ${prop.employee_team}`);
                            });
                        }
                    }, 5000);
                } else {
                    showAlert('íŒ€ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + (result.message || result.error), 'error');
                }
            } catch (error) {
                console.error('ì¼ê´„ íŒ€ ë³€ê²½ ì˜¤ë¥˜:', error);
                showAlert('íŒ€ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        // ì¼ê´„ ì‚­ì œ
        async function bulkDeleteProperties() {
            const selectedCheckboxes = document.querySelectorAll('.property-checkbox:checked');
            
            if (selectedCheckboxes.length === 0) {
                showAlert('ì„ íƒëœ ë§¤ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤.', 'warning');
                return;
            }
            
            const selectedIds = Array.from(selectedCheckboxes).map(cb => cb.value);
            
            if (!confirm(`ì„ íƒëœ ${selectedIds.length}ê°œ ë§¤ë¬¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nâš ï¸ ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) {
                return;
            }
            
            try {
                const response = await fetch('/api/maeiple/bulk-delete', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        property_ids: selectedIds
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showAlert(`${selectedIds.length}ê°œ ë§¤ë¬¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
                    console.log('âœ… ì„œë²„ì—ì„œ ì¼ê´„ ì‚­ì œ ì„±ê³µ ì‘ë‹µ ë°›ìŒ');
                    
                    // ë¡œì»¬ ë°ì´í„°ì—ì„œ ì‚­ì œëœ ë§¤ë¬¼ ì œê±°
                    selectedIds.forEach(propertyId => {
                        const index = properties.findIndex(p => p.id == propertyId);
                        if (index !== -1) {
                            properties.splice(index, 1);
                        }
                    });
                    
                    // UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                    renderMaeipeProperties();
                    clearSelection();
                    
                    // ì„ íƒëœ ë§¤ë¬¼ ìˆ˜ ì—…ë°ì´íŠ¸
                    updateSelectionCount();
                } else {
                    showAlert('ë§¤ë¬¼ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + (result.message || result.error), 'error');
                }
            } catch (error) {
                console.error('ì¼ê´„ ì‚­ì œ ì˜¤ë¥˜:', error);
                showAlert('ë§¤ë¬¼ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        // í•„í„° í•¸ë“¤ëŸ¬
        function setStatusFilter(value, btn) {
            statusFilter = value;
            document.querySelectorAll('#status-filter-group .filter-btn').forEach(b => {
                b.classList.remove('active');
                b.style.background = '#ffffff';
                b.style.color = '#334155';
                b.style.fontWeight = 'normal';
            });
            btn.classList.add('active');
            btn.style.background = '#e0e7ff';
            btn.style.color = '#4338ca';
            btn.style.fontWeight = '600';
            renderMaeipeProperties();
        }

        function setOccupiedFilter(value, btn) {
            occupiedFilter = value;
            document.querySelectorAll('#occupied-filter-group .filter-btn').forEach(b => {
                b.classList.remove('active');
                b.style.background = '#ffffff';
                b.style.color = '#334155';
                b.style.fontWeight = 'normal';
            });
            btn.classList.add('active');
            btn.style.background = '#e0e7ff';
            btn.style.color = '#4338ca';
            btn.style.fontWeight = '600';
            renderMaeipeProperties();
        }
        
        // ê´€ë¦¬ììš© ê±°ë˜ìœ í˜• í•„í„°
        function setDealTypeFilterAdmin(value, btn) {
            dealTypeFilterAdmin = value;
            document.querySelectorAll('#deal-type-filter-group-admin .filter-btn').forEach(b => {
                b.classList.remove('active');
                b.style.background = '#ffffff';
                b.style.color = '#334155';
                b.style.fontWeight = 'normal';
            });
            btn.classList.add('active');
            btn.style.background = '#e0e7ff';
            btn.style.color = '#4338ca';
            btn.style.fontWeight = '600';
            renderMaeipeProperties();
        }
        
        // ê´€ë¦¬ììš© í˜¸ìˆ˜ ê²€ìƒ‰ í•„í„°
        function filterByRoomAdmin(searchValue) {
            roomSearchFilterAdmin = searchValue;
            renderMaeipeProperties();
        }
        
        // ê´€ë¦¬ììš© ë‹´ë‹¹ì ê²€ìƒ‰ í•„í„°
        function filterByEmployeeAdmin(searchValue) {
            employeeSearchFilterAdmin = searchValue;
            renderMaeipeProperties();
        }
        
        // ê´€ë¦¬ììš© íŒ€ í•„í„°
        function setTeamFilterAdmin(value, btn) {
            teamFilterAdmin = value;
            document.querySelectorAll('#team-filter-group-admin .filter-btn').forEach(b => {
                b.classList.remove('active');
                b.style.background = '#ffffff';
                b.style.color = '#334155';
                b.style.fontWeight = 'normal';
            });
            btn.classList.add('active');
            btn.style.background = '#e0e7ff';
            btn.style.color = '#4338ca';
            btn.style.fontWeight = '600';
            renderMaeipeProperties();
        }
        
        // ê´€ë¦¬ììš© íŒ€ í•„í„° ì—…ë°ì´íŠ¸
        async function updateAdminFilters() {
            // íŒ€ í•„í„° ì—…ë°ì´íŠ¸
            const teamFilterGroup = document.getElementById('team-filter-group-admin');
            const teamFilterButtons = teamFilterGroup.querySelector('.filter-buttons');
            
            // í˜„ì¬ ë§¤ë¬¼ ëª©ë¡ì—ì„œ íŒ€ë“¤ ì¶”ì¶œ
            const teams = [...new Set(properties.map(p => p.employee_team).filter(team => team))];
            
            // ì „ì²´ ë²„íŠ¼ + ê°œë³„ íŒ€ ë²„íŠ¼ë“¤
            let teamButtonsHTML = `
                <button class="filter-btn ${teamFilterAdmin === 'all' ? 'active' : ''}" data-value="all" onclick="setTeamFilterAdmin('all', this)" 
                        style="padding: 6px 10px; border: 1px solid #e2e8f0; background: ${teamFilterAdmin === 'all' ? '#e0e7ff' : '#ffffff'}; color: ${teamFilterAdmin === 'all' ? '#4338ca' : '#334155'}; border-radius: 20px; font-size: 12px; cursor: pointer; font-weight: ${teamFilterAdmin === 'all' ? '600' : 'normal'};">ì „ì²´</button>
            `;
            
            teams.forEach(team => {
                const isActive = teamFilterAdmin === team;
                teamButtonsHTML += `
                    <button class="filter-btn ${isActive ? 'active' : ''}" data-value="${team}" onclick="setTeamFilterAdmin('${team}', this)"
                            style="padding: 6px 10px; border: 1px solid #e2e8f0; background: ${isActive ? '#e0e7ff' : '#ffffff'}; color: ${isActive ? '#4338ca' : '#334155'}; border-radius: 20px; font-size: 12px; cursor: pointer; font-weight: ${isActive ? '600' : 'normal'};">${team}</button>
                `;
            });
            
            teamFilterButtons.innerHTML = teamButtonsHTML;
            
            // ì¼ê´„ ì²˜ë¦¬ ì»¨íŠ¸ë¡¤ ì—…ë°ì´íŠ¸ (DBì—ì„œ ì „ì²´ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°)
            await updateBulkActionControls();
        }
        
        // ì¼ê´„ ì²˜ë¦¬ ì»¨íŠ¸ë¡¤ì˜ ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸
        async function updateBulkActionControls() {
            // ì§ì› ëª©ë¡ì„ DBì—ì„œ ê°€ì ¸ì™€ì„œ ì—…ë°ì´íŠ¸
            const employeeSelect = document.getElementById('bulk-employee-select');
            if (employeeSelect) {
                await loadEmployeesForBulkSelect(employeeSelect);
            }
            
            // íŒ€ ëª©ë¡ì„ DBì—ì„œ ê°€ì ¸ì™€ì„œ ì—…ë°ì´íŠ¸
            const teamSelect = document.getElementById('bulk-team-select');
            if (teamSelect) {
                await loadTeamsForBulkSelect(teamSelect);
            }
        }
        
        // DBì—ì„œ ì „ì²´ ì§ì› ëª©ë¡ì„ ê°€ì ¸ì™€ì„œ ì¼ê´„ ì²˜ë¦¬ ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸
        async function loadEmployeesForBulkSelect(selectElement) {
            try {
                const response = await fetch('/api/employees?per_page=1000');
                if (response.ok) {
                    const data = await response.json();
                    const employees = data.employees || [];
                    
                    let employeeOptionsHTML = '<option value="">ë‹´ë‹¹ì ì„ íƒ</option>';
                    employees.forEach(emp => {
                        employeeOptionsHTML += `<option value="${emp.id}">${emp.employee_name} (${emp.team || 'ë¯¸ì§€ì •'})</option>`;
                    });
                    selectElement.innerHTML = employeeOptionsHTML;
                    
                    console.log(`âœ… DBì—ì„œ ${employees.length}ëª…ì˜ ì§ì› ëª©ë¡ì„ ì¼ê´„ ì²˜ë¦¬ ë“œë¡­ë‹¤ìš´ì— ë¡œë“œí–ˆìŠµë‹ˆë‹¤.`);
                } else {
                    console.error('ì§ì› ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', response.status);
                    selectElement.innerHTML = '<option value="">ì§ì› ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨</option>';
                }
            } catch (error) {
                console.error('ì§ì› ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜:', error);
                selectElement.innerHTML = '<option value="">ì§ì› ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜</option>';
            }
        }
        
        // DBì—ì„œ ì „ì²´ íŒ€ ëª©ë¡ì„ ê°€ì ¸ì™€ì„œ ì¼ê´„ ì²˜ë¦¬ ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸
        async function loadTeamsForBulkSelect(selectElement) {
            try {
                const response = await fetch('/api/teams');
                if (response.ok) {
                    const data = await response.json();
                    const teams = data.teams || [];
                    
                    let teamOptionsHTML = '<option value="">íŒ€ ì„ íƒ</option>';
                    teams.forEach(team => {
                        teamOptionsHTML += `<option value="${team.name}">${team.name}</option>`;
                    });
                    selectElement.innerHTML = teamOptionsHTML;
                    
                    console.log(`âœ… DBì—ì„œ ${teams.length}ê°œì˜ íŒ€ ëª©ë¡ì„ ì¼ê´„ ì²˜ë¦¬ ë“œë¡­ë‹¤ìš´ì— ë¡œë“œí–ˆìŠµë‹ˆë‹¤.`);
                } else {
                    console.error('íŒ€ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', response.status);
                    selectElement.innerHTML = '<option value="">íŒ€ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨</option>';
                }
            } catch (error) {
                console.error('íŒ€ ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜:', error);
                selectElement.innerHTML = '<option value="">íŒ€ ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜</option>';
            }
        }
        
        // íŒ€ì¥ìš© ë§¤ë¬¼ ë¡œë“œ
        async function loadTeamMaeipeProperties(page = 1) {
            try {
                currentTeamMaeiplePage = page;
                const url = `/api/maeiple/team?sort_by=${currentTeamSortBy}&sort_order=${currentTeamSortOrder}&page=${page}&per_page=${teamMaeipePerPage}`;
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.success) {
                    teamProperties = data.properties;
                    teamMaeipleTotalPages = data.total_pages || 0;
                    console.log(`íŒ€ì¥ìš© ë§¤ë¬¼ ë¡œë“œ: ${teamProperties.length}ê°œ (í˜ì´ì§€ ${page}/${teamMaeipleTotalPages})`);
                    
                    // íŒ€ì¥ìš© ë©”ì´í”Œê´€ë¦¬ í†µê³„ ì—…ë°ì´íŠ¸
                    updateTeamMaeipleStats(data);
                    
                    renderTeamMaeipeProperties();
                    updateTeamEmployeeFilter(); // ë‹´ë‹¹ì í•„í„° ì—…ë°ì´íŠ¸
                    renderTeamMaeipePagination();
                } else {
                    showTeamMaeipeError('íŒ€ ë§¤ë¬¼ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('Error:', error);
                showTeamMaeipeError('íŒ€ ë§¤ë¬¼ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // íŒ€ì¥ìš© ë§¤ë¬¼ ë Œë”ë§
        function renderTeamMaeipeProperties() {
            const tableContent = document.getElementById('team-maeiple-table-content');
            
            // í•„í„° ì ìš©
            let list = Array.isArray(teamProperties) ? teamProperties.slice() : [];
            
            // í˜„í™© í•„í„°
            if (statusFilterTeam !== 'all') {
                list = list.filter(p => (p.status || '') === statusFilterTeam);
            }
            
            // ì‹¤ê±°ì£¼ í•„í„°
            if (occupiedFilterTeam !== 'all') {
                const want = occupiedFilterTeam === 'O';
                list = list.filter(p => !!p.is_occupied === want);
            }
            
            // ê±°ë˜ìœ í˜• í•„í„°
            if (dealTypeFilterTeam !== 'all') {
                list = list.filter(p => {
                    if (dealTypeFilterTeam === 'ì „ì„¸') {
                        const jeonsePrice = parseInt(String(p.jeonse_price || '0').replace(/[^\d]/g, '')) || 0;
                        return jeonsePrice > 0;
                    } else if (dealTypeFilterTeam === 'ì›”ì„¸') {
                        const monthlyRent = parseInt(String(p.monthly_rent || '0').replace(/[^\d]/g, '')) || 0;
                        return monthlyRent > 0;
                    } else if (dealTypeFilterTeam === 'ë§¤ë§¤') {
                        const salePrice = parseInt(String(p.sale_price || '0').replace(/[^\d]/g, '')) || 0;
                        return salePrice > 0;
                    }
                    return true;
                });
            }
            
            // í˜¸ìˆ˜ ê²€ìƒ‰ í•„í„°
            if (roomSearchFilterTeam.trim()) {
                const searchTerm = roomSearchFilterTeam.trim().toLowerCase();
                list = list.filter(p => {
                    const roomNumber = String(p.room_number || '').toLowerCase();
                    return roomNumber.includes(searchTerm);
                });
            }
            
            // ë‹´ë‹¹ì ê²€ìƒ‰ í•„í„°
            if (employeeSearchFilterTeam.trim()) {
                const searchTerm = employeeSearchFilterTeam.trim().toLowerCase();
                list = list.filter(p => {
                    const employeeName = String(p.employee_name || '').toLowerCase();
                    return employeeName.includes(searchTerm);
                });
            }
            
            if (list.length === 0) {
                tableContent.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #64748b;">
                        <div style="font-size: 48px; margin-bottom: 16px; opacity: 0.5;">ğŸ‘¥ğŸ¢</div>
                        <div style="font-size: 18px; font-weight: 600; margin-bottom: 8px;">ìš°ë¦¬íŒ€ ë§¤ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤</div>
                        <div style="font-size: 14px; opacity: 0.7;">ìƒˆ ë§¤ë¬¼ì„ ì¶”ê°€í•´ë³´ì„¸ìš”.</div>
                    </div>
                `;
                return;
            }
            
            let tableHTML = `
                <table class="employees-table">
                    <thead>
                        <tr>
                            <th>
                                <div style="display: flex; align-items: center; gap: 4px; cursor: pointer; user-select: none;" onclick="toggleTeamSort('check_date')">
                                    í™•ì¸ë‚ ì§œ
                                    <span style="font-size: 12px; color: #9ca3af;">${currentTeamSortBy === 'check_date' ? (currentTeamSortOrder === 'desc' ? 'â–¼' : 'â–²') : 'â†•ï¸'}</span>
                                </div>
                            </th>
                            <th>ë™</th>
                            <th>í˜¸ìˆ˜</th>
                            <th>í˜„í™©</th>
                            <th>ì „ì„¸ (ë§Œì›)</th>
                            <th>ì›”ì„¸ë³´ì¦ê¸ˆ (ë§Œì›)</th>
                            <th>ì›”ì„¸ (ë§Œì›)</th>
                            <th>ë§¤ë§¤ (ë§Œì›)</th>
                            <th>ì‹¤ê±°ì£¼ ì—¬ë¶€</th>
                            <th>ì „í™”ë²ˆí˜¸</th>
                            <th>íŠ¹ì´ì‚¬í•­</th>
                            <th>ë‹´ë‹¹ì</th>
                            <th>íŒ€</th>
                            <th>ì¢‹ì•„ìš”</th>
                            <th>ì‹«ì–´ìš”</th>
                            <th>ìˆ˜ì •</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            list.forEach(property => {
                const memoPreview = property.memo ? (property.memo.length > 20 ? property.memo.substring(0, 20) + '...' : property.memo) : '';
                
                tableHTML += `
                    <tr data-property-id="${property.id}">
                        <td style="cursor: pointer;" onclick="editTeamDate(${property.id}, '${property.check_date || ''}', this)">${property.check_date || ''}</td>
                        <td style="cursor: pointer;" onclick="editTeamNumber(${property.id}, 'building_number', '${property.building_number || ''}', this)">${property.building_number || ''}</td>
                        <td style="cursor: pointer;" onclick="editTeamNumber(${property.id}, 'room_number', '${property.room_number || ''}', this)">${property.room_number || ''}</td>
                        <td>
                            <button style="padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; ${property.status === 'ê³„ì•½ì™„ë£Œ' ? 'background: #d1fae5; color: #065f46;' : property.status === 'ë³´ë¥˜' ? 'background: #fef3c7; color: #92400e;' : property.status === 'ë¶€ì¬' ? 'background: #ede9fe; color: #5b21b6;' : 'background: #e0f2fe; color: #0369a1;'}" 
                                    onclick="showTeamStatusOptions(${property.id}, '${property.status || 'ê±°ë˜ê°€ëŠ¥'}', this)">
                                ${property.status || 'ê±°ë˜ê°€ëŠ¥'}
                            </button>
                        </td>
                        <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editTeamPrice(${property.id}, 'jeonse_price', '${property.jeonse_price || ''}', this)">
                            ${property.jeonse_price ? formatNumber(property.jeonse_price) + ' ë§Œì›' : '-'}
                        </td>
                        <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editTeamPrice(${property.id}, 'deposit', '${property.deposit || ''}', this)">
                            ${property.deposit ? formatNumber(property.deposit) + ' ë§Œì›' : '-'}
                        </td>
                        <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editTeamPrice(${property.id}, 'monthly_rent', '${property.monthly_rent || ''}', this)">
                            ${property.monthly_rent ? formatNumber(property.monthly_rent) + ' ë§Œì›' : '-'}
                        </td>
                        <td style="cursor: pointer; color: #2563eb; font-weight: 500;" onclick="editTeamPrice(${property.id}, 'sale_price', '${property.sale_price || ''}', this)">
                            ${property.sale_price ? formatNumber(property.sale_price) + ' ë§Œì›' : '-'}
                        </td>
                        <td>
                            <button style="background: none; border: none; cursor: pointer; font-size: 18px; padding: 4px; border-radius: 4px; color: ${property.is_occupied ? '#059669' : '#dc2626'};" 
                                    onclick="toggleTeamOccupied(${property.id}, ${property.is_occupied})">
                                ${property.is_occupied ? 'O' : 'X'}
                            </button>
                        </td>
                        <td style="cursor: pointer; font-family: monospace; letter-spacing: 0.5px; max-width: 120px; overflow: hidden; text-overflow: ellipsis;" onclick="editTeamPhone(${property.id}, '${property.phone || ''}', this)">
                            ${property.phone || '-'}
                        </td>
                        <td style="cursor: pointer; color: #64748b; font-style: italic; max-width: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" onclick="showMemoModal(${property.id}, '${property.memo || ''}')">
                            ${memoPreview || 'ë©”ëª¨ ì¶”ê°€...'}
                        </td>
                        <td>
                            <span style="color: #4f46e5; font-weight: 500;">
                                ${property.employee_name || 'ë¯¸ì§€ì •'}
                            </span>
                        </td>
                        <td>
                            <span class="status-badge" style="background: ${getTeamBadgeColor(property.employee_team)}; color: ${getTeamTextColor(property.employee_team)};">
                                ${property.employee_team || 'ë¯¸ì§€ì •'}
                            </span>
                        </td>
                        <td>
                            <div style="cursor: pointer;" onclick="showLikeOptions(${property.id}, ${property.likes}, this)">
                                ${'â¤ï¸'.repeat(property.likes)}${property.likes === 0 ? 'ğŸ¤' : ''}
                            </div>
                        </td>
                        <td>
                            <div style="cursor: pointer;" onclick="showDislikeOptions(${property.id}, ${property.dislikes}, this)">
                                ${'ğŸ‘'.repeat(property.dislikes)}${property.dislikes === 0 ? 'ğŸ¤' : ''}
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            tableHTML += `
                    </tbody>
                </table>
            `;
            
            tableContent.innerHTML = tableHTML;
        }
        

        
        // íŒ€ì¥ìš© í•„í„° í•¨ìˆ˜ë“¤
        function setStatusFilterTeam(value, btn) {
            statusFilterTeam = value;
            document.querySelectorAll('#status-filter-group-team .filter-btn').forEach(b => {
                b.classList.remove('active');
                b.style.background = '#ffffff';
                b.style.color = '#334155';
                b.style.fontWeight = 'normal';
            });
            btn.classList.add('active');
            btn.style.background = '#e0e7ff';
            btn.style.color = '#4338ca';
            btn.style.fontWeight = '600';
            renderTeamMaeipeProperties();
        }
        
        function setOccupiedFilterTeam(value, btn) {
            occupiedFilterTeam = value;
            document.querySelectorAll('#occupied-filter-group-team .filter-btn').forEach(b => {
                b.classList.remove('active');
                b.style.background = '#ffffff';
                b.style.color = '#334155';
                b.style.fontWeight = 'normal';
            });
            btn.classList.add('active');
            btn.style.background = '#e0e7ff';
            btn.style.color = '#4338ca';
            btn.style.fontWeight = '600';
            renderTeamMaeipeProperties();
        }
        
        function setDealTypeFilterTeam(value, btn) {
            dealTypeFilterTeam = value;
            document.querySelectorAll('#deal-type-filter-group-team .filter-btn').forEach(b => {
                b.classList.remove('active');
                b.style.background = '#ffffff';
                b.style.color = '#334155';
                b.style.fontWeight = 'normal';
            });
            btn.classList.add('active');
            btn.style.background = '#e0e7ff';
            btn.style.color = '#4338ca';
            btn.style.fontWeight = '600';
            renderTeamMaeipeProperties();
        }
        
        function filterByRoomTeam(searchValue) {
            roomSearchFilterTeam = searchValue;
            renderTeamMaeipeProperties();
        }
        
        // íŒ€ì¥ìš© ë‹´ë‹¹ì ê²€ìƒ‰ í•„í„°
        function filterByEmployeeTeam(searchValue) {
            employeeSearchFilterTeam = searchValue;
            renderTeamMaeipeProperties();
        }
        
        function showTeamMaeipeError(message) {
            const tableContent = document.getElementById('team-maeiple-table-content');
            tableContent.innerHTML = `
                <div style="text-align: center; padding: 40px; color: #ef4444;">
                    <div style="font-size: 48px; margin-bottom: 16px;">âš ï¸</div>
                    <div style="font-size: 16px; font-weight: 600;">${message}</div>
                </div>
            `;
        }
        
        // ê³ ê°ê´€ë¦¬ í˜ì´ì§€ë„¤ì´ì…˜ ë Œë”ë§
        function renderCustomerPagination() {
            const paginationDiv = document.getElementById('customer-pagination');
            if (!paginationDiv || customerTotalPages <= 1) {
                if (paginationDiv) paginationDiv.style.display = 'none';
                return;
            }
            
            paginationDiv.style.display = 'flex';
            let paginationHTML = '';
            
            // ì´ì „ í˜ì´ì§€ ë²„íŠ¼
            if (currentCustomerPage > 1) {
                paginationHTML += `<button onclick="loadAllCustomers(${currentCustomerPage - 1})" style="padding: 8px 12px; border: 1px solid #d1d5db; background: #f9fafb; border-radius: 6px; cursor: pointer; color: #374151;">ì´ì „</button>`;
            }
            
            // í˜ì´ì§€ ë²ˆí˜¸ ë²„íŠ¼ë“¤ (ìµœëŒ€ 7ê°œ í‘œì‹œ)
            const startPage = Math.max(1, currentCustomerPage - 3);
            const endPage = Math.min(customerTotalPages, startPage + 6);
            
            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentCustomerPage;
                paginationHTML += `
                    <button onclick="loadAllCustomers(${i})" 
                            style="padding: 8px 12px; border: 1px solid ${isActive ? '#3b82f6' : '#d1d5db'}; 
                                   background: ${isActive ? '#3b82f6' : '#f9fafb'}; color: ${isActive ? 'white' : '#374151'}; 
                                   border-radius: 6px; cursor: pointer; font-weight: ${isActive ? '600' : 'normal'};">
                        ${i}
                    </button>
                `;
            }
            
            // ë‹¤ìŒ í˜ì´ì§€ ë²„íŠ¼
            if (currentCustomerPage < customerTotalPages) {
                paginationHTML += `<button onclick="loadAllCustomers(${currentCustomerPage + 1})" style="padding: 8px 12px; border: 1px solid #d1d5db; background: #f9fafb; border-radius: 6px; cursor: pointer; color: #374151;">ë‹¤ìŒ</button>`;
            }
            
            paginationDiv.innerHTML = paginationHTML;
        }
        
        // ì§ì›ê´€ë¦¬ í˜ì´ì§€ë„¤ì´ì…˜ ë Œë”ë§
        function renderEmployeePagination() {
            const paginationDiv = document.getElementById('employee-pagination');
            if (!paginationDiv || employeeTotalPages <= 1) {
                if (paginationDiv) paginationDiv.style.display = 'none';
                return;
            }
            
            paginationDiv.style.display = 'flex';
            let paginationHTML = '';
            
            // ì´ì „ í˜ì´ì§€ ë²„íŠ¼
            if (currentEmployeePage > 1) {
                paginationHTML += `<button onclick="loadEmployees(${currentEmployeePage - 1})" style="padding: 8px 12px; border: 1px solid #d1d5db; background: #f9fafb; border-radius: 6px; cursor: pointer; color: #374151;">ì´ì „</button>`;
            }
            
            // í˜ì´ì§€ ë²ˆí˜¸ ë²„íŠ¼ë“¤ (ìµœëŒ€ 7ê°œ í‘œì‹œ)
            const startPage = Math.max(1, currentEmployeePage - 3);
            const endPage = Math.min(employeeTotalPages, startPage + 6);
            
            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentEmployeePage;
                paginationHTML += `
                    <button onclick="loadEmployees(${i})" 
                            style="padding: 8px 12px; border: 1px solid ${isActive ? '#3b82f6' : '#d1d5db'}; 
                                   background: ${isActive ? '#3b82f6' : '#f9fafb'}; color: ${isActive ? 'white' : '#374151'}; 
                                   border-radius: 6px; cursor: pointer; font-weight: ${isActive ? '600' : 'normal'};">
                        ${i}
                    </button>
                `;
            }
            
            // ë‹¤ìŒ í˜ì´ì§€ ë²„íŠ¼
            if (currentEmployeePage < employeeTotalPages) {
                paginationHTML += `<button onclick="loadEmployees(${currentEmployeePage + 1})" style="padding: 8px 12px; border: 1px solid #d1d5db; background: #f9fafb; border-radius: 6px; cursor: pointer; color: #374151;">ë‹¤ìŒ</button>`;
            }
            
            paginationDiv.innerHTML = paginationHTML;
        }
        
        // ë©”ì´í”Œê´€ë¦¬ í˜ì´ì§€ë„¤ì´ì…˜ ë Œë”ë§
        function renderMaeipePagination() {
            const paginationDiv = document.getElementById('maeiple-pagination');
            if (!paginationDiv || maeipleTotalPages <= 1) {
                if (paginationDiv) paginationDiv.style.display = 'none';
                return;
            }
            
            paginationDiv.style.display = 'flex';
            let paginationHTML = '';
            
            // ì´ì „ í˜ì´ì§€ ë²„íŠ¼
            if (currentMaeiplePage > 1) {
                paginationHTML += `<button onclick="loadMaeipeProperties(${currentMaeiplePage - 1})" style="padding: 8px 12px; border: 1px solid #d1d5db; background: #f9fafb; border-radius: 6px; cursor: pointer; color: #374151;">ì´ì „</button>`;
            }
            
            // í˜ì´ì§€ ë²ˆí˜¸ ë²„íŠ¼ë“¤ (ìµœëŒ€ 7ê°œ í‘œì‹œ)
            const startPage = Math.max(1, currentMaeiplePage - 3);
            const endPage = Math.min(maeipleTotalPages, startPage + 6);
            
            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentMaeiplePage;
                paginationHTML += `
                    <button onclick="loadMaeipeProperties(${i})" 
                            style="padding: 8px 12px; border: 1px solid ${isActive ? '#3b82f6' : '#d1d5db'}; 
                                   background: ${isActive ? '#3b82f6' : '#f9fafb'}; color: ${isActive ? 'white' : '#374151'}; 
                                   border-radius: 6px; cursor: pointer; font-weight: ${isActive ? '600' : 'normal'};">
                        ${i}
                    </button>
                `;
            }
            
            // ë‹¤ìŒ í˜ì´ì§€ ë²„íŠ¼
            if (currentMaeiplePage < maeipleTotalPages) {
                paginationHTML += `<button onclick="loadMaeipeProperties(${currentMaeiplePage + 1})" style="padding: 8px 12px; border: 1px solid #d1d5db; background: #f9fafb; border-radius: 6px; cursor: pointer; color: #374151;">ë‹¤ìŒ</button>`;
            }
            
            paginationDiv.innerHTML = paginationHTML;
        }
        
        // íŒ€ì¥ìš© ë©”ì´í”Œê´€ë¦¬ í˜ì´ì§€ë„¤ì´ì…˜ ë Œë”ë§
        function renderTeamMaeipePagination() {
            const paginationDiv = document.getElementById('team-maeiple-pagination');
            if (!paginationDiv || teamMaeipleTotalPages <= 1) {
                if (paginationDiv) paginationDiv.style.display = 'none';
                return;
            }
            
            paginationDiv.style.display = 'flex';
            let paginationHTML = '';
            
            // ì´ì „ í˜ì´ì§€ ë²„íŠ¼
            if (currentTeamMaeiplePage > 1) {
                paginationHTML += `<button onclick="loadTeamMaeipeProperties(${currentTeamMaeiplePage - 1})" style="padding: 8px 12px; border: 1px solid #d1d5db; background: #f9fafb; border-radius: 6px; cursor: pointer; color: #374151;">ì´ì „</button>`;
            }
            
            // í˜ì´ì§€ ë²ˆí˜¸ ë²„íŠ¼ë“¤ (ìµœëŒ€ 7ê°œ í‘œì‹œ)
            const startPage = Math.max(1, currentTeamMaeiplePage - 3);
            const endPage = Math.min(teamMaeipleTotalPages, startPage + 6);
            
            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentTeamMaeiplePage;
                paginationHTML += `
                    <button onclick="loadTeamMaeipeProperties(${i})" 
                            style="padding: 8px 12px; border: 1px solid ${isActive ? '#3b82f6' : '#d1d5db'}; 
                                   background: ${isActive ? '#3b82f6' : '#f9fafb'}; color: ${isActive ? 'white' : '#374151'}; 
                                   border-radius: 6px; cursor: pointer; font-weight: ${isActive ? '600' : 'normal'};">
                        ${i}
                    </button>
                `;
            }
            
            // ë‹¤ìŒ í˜ì´ì§€ ë²„íŠ¼
            if (currentTeamMaeiplePage < teamMaeipleTotalPages) {
                paginationHTML += `<button onclick="loadTeamMaeipeProperties(${currentTeamMaeiplePage + 1})" style="padding: 8px 12px; border: 1px solid #d1d5db; background: #f9fafb; border-radius: 6px; cursor: pointer; color: #374151;">ë‹¤ìŒ</button>`;
            }
            
            paginationDiv.innerHTML = paginationHTML;
        }

        // ë©”ëª¨ ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function showMemoModal(id, memo) {
            currentMemoId = id;
            document.getElementById('memoTextarea').value = memo;
            document.getElementById('memoModal').style.display = 'block';
        }

        function closeMemoModal() {
            document.getElementById('memoModal').style.display = 'none';
            currentMemoId = null;
        }

        async function saveMemo() {
            if (!currentMemoId) return;
            
            const memo = document.getElementById('memoTextarea').value;
            
            try {
                const response = await fetch('/api/maeiple/memo', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        id: currentMemoId,
                        memo: memo
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const property = properties.find(p => p.id === currentMemoId);
                    if (property) {
                        property.memo = memo;
                    }
                    closeMemoModal();
                    renderMaeipeProperties();
                    showMaeipeSuccess('ë©”ëª¨ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
                } else {
                    showMaeipeError('ë©”ëª¨ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('Error:', error);
                showMaeipeError('ë©”ëª¨ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ì—ëŸ¬/ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
        function showMaeipeError(message) {
            alert('âŒ ' + message);
        }

        function showMaeipeSuccess(message) {
            alert('âœ… ' + message);
        }

        // ==================== ë©”ì´í”Œ ê´€ë¦¬ ìˆ˜ì • ê¸°ëŠ¥ êµ¬í˜„ ====================
        
        // ë‚ ì§œ í¸ì§‘
        async function editDate(id, value, cell) {
            const newDate = prompt('ìƒˆ ë‚ ì§œë¥¼ ì…ë ¥í•˜ì„¸ìš” (YYYY-MM-DD):', value);
            if (newDate && newDate !== value) {
                await updateMaeipeProperty(id, 'check_date', newDate, cell);
            }
        }
        
        // ìˆ«ì í¸ì§‘ (ë£¸ë„˜ë²„, ë¹Œë”©ë„˜ë²„ ë“±)
        async function editNumber(id, field, value, cell) {
            const newValue = prompt(`ìƒˆ ${field}ì„(ë¥¼) ì…ë ¥í•˜ì„¸ìš”:`, value);
            if (newValue && newValue !== value) {
                await updateMaeipeProperty(id, field, newValue, cell);
            }
        }
        
        // ê°€ê²© í¸ì§‘ (ì „ì„¸, ì›”ì„¸, ë§¤ë§¤ê°€)
        async function editPrice(id, field, value, cell) {
            const fieldNames = {
                'jeonse_price': 'ì „ì„¸ê°€',
                'monthly_rent': 'ì›”ì„¸',
                'sale_price': 'ë§¤ë§¤ê°€'
            };
            const fieldName = fieldNames[field] || field;
            const newValue = prompt(`ìƒˆ ${fieldName}ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ë§Œì›):`, value);
            if (newValue && newValue !== value) {
                await updateMaeipeProperty(id, field, newValue, cell);
            }
        }
        
        // ì „í™”ë²ˆí˜¸ í¸ì§‘
        async function editPhone(id, value, cell) {
            const newPhone = prompt('ìƒˆ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:', value);
            if (newPhone && newPhone !== value) {
                await updateMaeipeProperty(id, 'phone', newPhone, cell);
            }
        }
        
        // ìƒíƒœ ë³€ê²½
        async function showStatusOptions(id, status, btn) {
            const statusOptions = ['ëŒ€ê¸°', 'ì§„í–‰ì¤‘', 'ì™„ë£Œ', 'ë³´ë¥˜'];
            const newStatus = prompt('ìƒˆ ìƒíƒœë¥¼ ì„ íƒí•˜ì„¸ìš”:\n' + statusOptions.map((s, i) => `${i+1}. ${s}`).join('\n'), status);
            if (newStatus && statusOptions.includes(newStatus) && newStatus !== status) {
                await updateMaeipeProperty(id, 'status', newStatus, btn.closest('td'));
                btn.textContent = newStatus;
                btn.className = `btn btn-sm status-${newStatus}`;
            }
        }
        
        // ì‹¤ê±°ì£¼ í† ê¸€
        async function toggleOccupied(id, occupied) {
            const newOccupied = !occupied;
            await updateMaeipeProperty(id, 'is_occupied', newOccupied, null);
            
            // ë¡œì»¬ ë°ì´í„° ì—…ë°ì´íŠ¸ (ìˆœì„œ ìœ ì§€)
            const property = properties.find(p => p.id == id);
            if (property) {
                property.is_occupied = newOccupied;
            }
            
            // UIë§Œ ì—…ë°ì´íŠ¸ (ì „ì²´ ë¦¬ë¡œë“œ ì—†ì´)
            const occupiedCell = document.querySelector(`[onclick*="toggleOccupied(${id},"]`);
            if (occupiedCell) {
                const occupiedDisplay = newOccupied ? 'O' : 'X';
                const occupiedStyle = newOccupied ? 'background: #d1fae5; color: #065f46;' : 'background: #fecaca; color: #dc2626;';
                occupiedCell.innerHTML = `<span class="badge" style="${occupiedStyle}; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">${occupiedDisplay}</span>`;
                occupiedCell.setAttribute('onclick', `toggleOccupied(${id}, ${newOccupied})`);
            }
        }
        
        // ì¢‹ì•„ìš” í¸ì§‘
        async function showLikeOptions(id, likes, element) {
            const newLikes = prompt('ì¢‹ì•„ìš” ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”:', likes || 0);
            if (newLikes !== null && newLikes !== String(likes)) {
                await updateMaeipeProperty(id, 'likes', parseInt(newLikes) || 0, element.closest('td'));
                element.textContent = `ğŸ‘ ${newLikes}`;
            }
        }
        
        // ì‹«ì–´ìš” í¸ì§‘
        async function showDislikeOptions(id, dislikes, element) {
            const newDislikes = prompt('ì‹«ì–´ìš” ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”:', dislikes || 0);
            if (newDislikes !== null && newDislikes !== String(dislikes)) {
                await updateMaeipeProperty(id, 'dislikes', parseInt(newDislikes) || 0, element.closest('td'));
                element.textContent = `ğŸ‘ ${newDislikes}`;
            }
        }
        
        // ë§¤ë¬¼ ì‚­ì œ
        async function deleteProperty(id) {
            if (!confirm('ì •ë§ë¡œ ì´ ë§¤ë¬¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                return;
            }
            
            try {
                const response = await fetch(`/api/maeiple/${id}`, {
                    method: 'DELETE'
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showMaeipeSuccess('ë§¤ë¬¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                    
                    // ë¡œì»¬ ë°ì´í„°ì—ì„œ ì œê±° (ìˆœì„œ ìœ ì§€)
                    const propertyIndex = properties.findIndex(p => p.id == id);
                    if (propertyIndex > -1) {
                        properties.splice(propertyIndex, 1);
                    }
                    
                    // UIì—ì„œ í•´ë‹¹ í–‰ ì œê±°
                    const row = document.querySelector(`tr[data-property-id="${id}"]`);
                    if (row) {
                        row.remove();
                    }
                    
                    // ì „ì²´ ë¦¬ë¡œë“œ ì—†ì´ ë Œë”ë§ ì—…ë°ì´íŠ¸
                    renderMaeipeProperties();
                } else {
                    showMaeipeError('ì‚­ì œ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                }
            } catch (error) {
                console.error('ë§¤ë¬¼ ì‚­ì œ ì‹¤íŒ¨:', error);
                showMaeipeError('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // ë©”ì´í”Œ ë§¤ë¬¼ ì—…ë°ì´íŠ¸ ê³µí†µ í•¨ìˆ˜
        async function updateMaeipeProperty(id, field, value, cell) {
            try {
                const response = await fetch('/api/maeiple/update', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        id: id,
                        field: field,
                        value: value
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showMaeipeSuccess(`${field} ìˆ˜ì • ì™„ë£Œ`);
                    if (cell) {
                        cell.textContent = value;
                    }
                } else {
                    showMaeipeError('ìˆ˜ì • ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                }
            } catch (error) {
                console.error('ë§¤ë¬¼ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
                showMaeipeError('ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // ìƒˆ ë§¤ë¬¼ ì¶”ê°€ (ì§ì›í˜ì´ì§€ì™€ ë™ì¼í•œ ë°©ì‹)
        function addNewPropertyRow() {
            console.log('ê´€ë¦¬ì ìƒˆ ë§¤ë¬¼ í–‰ ì¶”ê°€ ì‹œì‘...');
            
            const tbody = document.querySelector('#maeiple-table-content table tbody');
            if (!tbody) {
                console.error('ë§¤ë¬¼ í…Œì´ë¸” tbodyë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                showAlert('í…Œì´ë¸”ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë©”ì´í”Œê´€ë¦¬ ì„¹ì…˜ì´ ì œëŒ€ë¡œ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            
            console.log('í…Œì´ë¸” tbody ì°¾ìŒ:', tbody);
            
            // ì˜¤ëŠ˜ ë‚ ì§œ êµ¬í•˜ê¸° (í•œêµ­ì‹œê°„ ê¸°ì¤€)
            const now = new Date();
            now.setHours(now.getHours() + 9);
            const today = now.toISOString().slice(0, 10);
            
            const newRow = document.createElement('tr');
            newRow.className = 'new-property-row';
            newRow.innerHTML = `
                <td style="text-align: center;">
                    <input type="checkbox" class="property-checkbox" style="width: 16px; height: 16px;" title="ë§¤ë¬¼ ì„ íƒ">
                </td>
                <td class="editable-cell" data-field="check_date" data-type="date" onclick="editAdminPropertyCell(this)">${today}</td>
                <td class="editable-cell" data-field="building_number" data-type="number" onclick="editAdminPropertyCell(this)" style="color: #64748b;">ë™ ë²ˆí˜¸ (ì„ íƒ)</td>
                <td class="editable-cell" data-field="room_number" data-type="number" onclick="editAdminPropertyCell(this)" style="color: #64748b;">í˜¸ìˆ˜ (ì„ íƒ)</td>
                <td class="editable-cell" data-field="status" data-type="select" onclick="editAdminPropertyCell(this)">
                    <span class="badge" style="background: #e0f2fe; color: #0369a1; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">ê±°ë˜ê°€ëŠ¥</span>
                </td>
                <td class="editable-cell" data-field="jeonse_price" data-type="number" onclick="editAdminPropertyCell(this)" style="color: #64748b;">ì „ì„¸ê°€ ì…ë ¥</td>
                <td class="editable-cell" data-field="monthly_deposit" data-type="number" onclick="editAdminPropertyCell(this)" style="color: #64748b;">ì›”ì„¸ë³´ì¦ê¸ˆ ì…ë ¥</td>
                <td class="editable-cell" data-field="monthly_rent" data-type="number" onclick="editAdminPropertyCell(this)" style="color: #64748b;">ì›”ì„¸ ì…ë ¥</td>
                <td class="editable-cell" data-field="sale_price" data-type="number" onclick="editAdminPropertyCell(this)" style="color: #64748b;">ë§¤ë§¤ê°€ ì…ë ¥</td>
                <td class="editable-cell" data-field="is_occupied" data-type="select" onclick="editAdminPropertyCell(this)">
                    <span class="badge" style="background: #fecaca; color: #dc2626; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">X</span>
                </td>
                <td class="editable-cell" data-field="phone" data-type="text" onclick="editAdminPropertyCell(this)" style="color: #64748b;">ì—°ë½ì²˜ ì…ë ¥</td>
                <td class="memo-cell" onclick="openNewAdminPropertyMemoModal(this)" style="color: #64748b; cursor: pointer;">ë©”ëª¨ ì…ë ¥</td>
                <td class="editable-cell" data-field="employee_name" data-type="text" onclick="editAdminPropertyCell(this)" style="color: #64748b;">ë‹´ë‹¹ì ì…ë ¥</td>
                <td class="editable-cell" data-field="employee_team" data-type="team" onclick="editAdminPropertyCell(this)">
                    <span class="status-badge" style="background: #f1f5f9; color: #64748b; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 500;">
                        íŒ€ ì…ë ¥
                    </span>
                </td>
                <td>
                    <div style="cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; gap: 2px;" onclick="editNewAdminPropertyLikes(this, 'like')" data-count="0">
                        <span style="color: #9ca3af; font-size: 14px;">â¤ï¸ 0</span>
                    </div>
                </td>
                <td>
                    <div style="cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; gap: 2px;" onclick="editNewAdminPropertyLikes(this, 'dislike')" data-count="0">
                        <span style="color: #9ca3af; font-size: 14px;">ğŸ‘ 0</span>
                    </div>
                </td>
                <td>
                    <div class="action-buttons">
                        <!-- ì €ì¥/ì·¨ì†Œ ë²„íŠ¼ ì œê±° - í–‰ë§Œ ì¶”ê°€ -->
                    </div>
                </td>
            `;
            
            tbody.insertBefore(newRow, tbody.firstChild);
            console.log('ìƒˆ í–‰ì´ í…Œì´ë¸”ì— ì¶”ê°€ë¨');
            
            // ìë™ í¬ì»¤ìŠ¤ ì œê±° - ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ì…€ì„ ì§ì ‘ í´ë¦­í•˜ë„ë¡ í•¨
            console.log('ìƒˆ ë§¤ë¬¼ í–‰ ì¶”ê°€ ì™„ë£Œ - ì›í•˜ëŠ” ì…€ì„ í´ë¦­í•˜ì—¬ í¸ì§‘í•˜ì„¸ìš”');
            
            console.log('ìƒˆ ë§¤ë¬¼ í–‰ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
            showAlert('ìƒˆ ë§¤ë¬¼ í–‰ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. ì…€ì„ í¸ì§‘í•˜ë©´ ìë™ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.', 'success');
        }

        // ==================== ê³ ê° ê´€ë¦¬ ê´€ë ¨ í•¨ìˆ˜ë“¤ ====================
        
        let allCustomers = [];
        let filteredCustomers = [];
        let currentCustomerFilter = 'all';
        let currentEmployeeFilter = 'all';
        let currentCustomerPage = 1;
        let customerPerPage = 20;
        let customerTotalPages = 0;

        // ëª¨ë“  ê³ ê° ëª©ë¡ ì¡°íšŒ (ê´€ë¦¬ììš© - ëª¨ë“  ì§ì›ì˜ ê³ ê° í†µí•©)
        async function loadAllCustomers(page = 1) {
            console.log(`ğŸ‘¥ ì „ì²´ ê³ ê° ëª©ë¡ ë¡œë“œ ì‹œì‘ (í˜ì´ì§€ ${page})`);
            try {
                currentCustomerPage = page;
                const response = await fetch(`/api/customers?all_employees=true&page=${page}&per_page=${customerPerPage}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error);
                }
                
                allCustomers = Array.isArray(data.customers) ? data.customers : [];
                customerTotalPages = data.total_pages || 0;
                console.log(`âœ… ì „ì²´ ê³ ê° ëª©ë¡ ë¡œë“œ ì™„ë£Œ: ${allCustomers.length}ê°œ (í˜ì´ì§€ ${page}/${customerTotalPages})`);
                
                // ì§ì› í•„í„° ì˜µì…˜ ì—…ë°ì´íŠ¸
                updateEmployeeFilter();
                
                // ê³ ê° ëª©ë¡ ë Œë”ë§
                applyCustomerFilters();
                updateCustomerStats();
                renderCustomerPagination();
                
            } catch (error) {
                console.error('âŒ ê³ ê° ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);
                showCustomerError(`ê³ ê° ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${error.message}`);
                
                // ë¹ˆ í…Œì´ë¸” í‘œì‹œ
                const tbody = document.querySelector('#customer-table-admin tbody');
                if (tbody) {
                    tbody.innerHTML = '<tr><td colspan="10" style="text-align: center; padding: 40px; color: #64748b;">ê³ ê° ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ì„ í´ë¦­í•´ì£¼ì„¸ìš”.</td></tr>';
                }
            }
        }

        // ì§ì› í•„í„° ì˜µì…˜ ì—…ë°ì´íŠ¸
        function updateEmployeeFilter() {
            const select = document.getElementById('employee-filter');
            const employees = [...new Set(allCustomers.map(c => c.employee_name || c.employee_id).filter(Boolean))];
            
            select.innerHTML = '<option value="all">ì „ì²´ ì§ì›</option>';
            employees.forEach(emp => {
                const option = document.createElement('option');
                option.value = emp;
                option.textContent = emp;
                select.appendChild(option);
            });
        }

        // ê³ ê° í•„í„° ì ìš©
        function applyCustomerFilters() {
            filteredCustomers = allCustomers.slice();
            
            // ìƒíƒœ í•„í„° (progress_status í•„ë“œ ì‚¬ìš©)
            if (currentCustomerFilter !== 'all') {
                filteredCustomers = filteredCustomers.filter(c => (c.progress_status || 'ìƒë‹´ì¤‘') === currentCustomerFilter);
            }
            
            // ì§ì› í•„í„°
            if (currentEmployeeFilter !== 'all') {
                filteredCustomers = filteredCustomers.filter(c => 
                    (c.employee_name || c.employee_id) === currentEmployeeFilter
                );
            }
            
            renderCustomerTable();
        }

        // ê³ ê° í…Œì´ë¸” ë Œë”ë§
        function renderCustomerTable() {
            const tableContent = document.getElementById('customer-table-content');
            
            if (filteredCustomers.length === 0) {
                tableContent.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #64748b;">
                        <div style="font-size: 48px; margin-bottom: 16px; opacity: 0.5;">ğŸ‘¥</div>
                        <p>ì¡°ê±´ì— ë§ëŠ” ê³ ê°ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                        <p>í•„í„°ë¥¼ ë³€ê²½í•˜ê±°ë‚˜ ìƒˆ ê³ ê°ì„ ì¶”ê°€í•´ë³´ì„¸ìš”.</p>
                    </div>
                `;
                return;
            }

            let tableHTML = `
                <table class="employees-table">
                    <thead>
                        <tr>
                            <th>ë‚ ì§œ</th>
                            <th>ì…ì£¼</th>
                            <th>ê³ ê°</th>
                            <th>ê³ ê°ë²ˆí˜¸</th>
                            <th>ê¸ˆì•¡</th>
                            <th>ë£¸ìˆ˜</th>
                            <th>ìœ„ì¹˜</th>
                            <th>ëŒ€ì¶œì—¬ë¶€</th>
                            <th>ì£¼ì°¨</th>
                            <th>ì• ì™„</th>
                            <th>ë©”ëª¨</th>
                            <th>ì§„í–‰ì—¬ë¶€</th>
                            <th>ì£¼ê±°ì‚¬ì´íŠ¸</th>
                            <th>ì—…ë¬´ì‚¬ì´íŠ¸</th>
                            <th>ë‹´ë‹¹ì</th>
                            <th>ì‘ì—…</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            filteredCustomers.forEach(customer => {
                const statusClass = customer.progress_status === 'ê³„ì•½' ? 'status-complete' : 
                                   customer.progress_status === 'ë³´ë¥˜' ? 'status-hold' : 'status-progress';
                
                tableHTML += `
                    <tr>
                        <td>${customer.inquiry_date || '-'}</td>
                        <td>${customer.move_in_date || '-'}</td>
                        <td style="font-weight: 600;">${customer.customer_name || '-'}</td>
                        <td style="font-family: monospace;">${customer.customer_phone || customer.phone || '-'}</td>
                        <td style="font-weight: 600; color: #059669;">${customer.amount || customer.budget ? (customer.amount || customer.budget) + 'ë§Œì›' : '-'}</td>
                        <td>${customer.room_count || customer.rooms || '-'}</td>
                        <td>${customer.location || '-'}</td>
                        <td>${customer.loan_info || '-'}</td>
                        <td>${customer.parking || '-'}</td>
                        <td>${customer.pets || '-'}</td>
                        <td style="max-width: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${customer.memo || ''}">${customer.memo || '-'}</td>
                        <td>
                            <span class="status-badge ${statusClass}">
                                ${customer.progress_status || 'ìƒë‹´ì¤‘'}
                            </span>
                        </td>
                        <td>
                            ${customer.management_site_id ? `<a href="https://web-production-d2f49.up.railway.app/customer/${customer.management_site_id}" target="_blank" class="site-link">ì£¼ê±°ì‚¬ì´íŠ¸</a>` : '-'}
                        </td>
                        <td>
                            ${customer.management_site_id ? `<a href="http://localhost:5001/customer/${customer.management_site_id}" target="_blank" class="site-link">ì—…ë¬´ì‚¬ì´íŠ¸</a>` : '-'}
                        </td>
                        <td style="font-weight: 500; color: #6366f1;">${customer.employee_name || customer.employee_id || '-'}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-primary btn-sm" onclick="editCustomer(${customer.id})">ìˆ˜ì •</button>
                                <button class="btn btn-danger btn-sm" onclick="deleteCustomer(${customer.id})">ì‚­ì œ</button>
                            </div>
                        </td>
                    </tr>
                `;
            });

            tableHTML += `
                    </tbody>
                </table>
            `;

            tableContent.innerHTML = tableHTML;
        }

        // ê³ ê° í†µê³„ ì—…ë°ì´íŠ¸
        function updateCustomerStats() {
            const total = allCustomers.length;
            const progress = allCustomers.filter(c => (c.progress_status || 'ìƒë‹´ì¤‘') === 'ìƒë‹´ì¤‘').length;
            const completed = allCustomers.filter(c => (c.progress_status || '') === 'ê³„ì•½').length;
            
            // ì´ë²ˆ ì£¼ ì‹ ê·œ ê³ ê° (7ì¼ ì´ë‚´)
            const weekAgo = new Date();
            weekAgo.setDate(weekAgo.getDate() - 7);
            const newCustomers = allCustomers.filter(c => {
                if (!c.inquiry_date && !c.created_date) return false;
                const customerDate = new Date(c.inquiry_date || c.created_date);
                return customerDate >= weekAgo;
            }).length;

            document.getElementById('total-customers-admin').textContent = total;
            document.getElementById('progress-customers-admin').textContent = progress;
            document.getElementById('completed-customers-admin').textContent = completed;
            document.getElementById('new-customers-admin').textContent = newCustomers;
        }

        // ê³ ê° ìƒíƒœ í•„í„°
        function setCustomerFilter(status, btn) {
            currentCustomerFilter = status;
            
            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.customer-filter-btn').forEach(b => {
                b.style.background = 'white';
                b.style.color = '#64748b';
            });
            btn.style.background = '#6366f1';
            btn.style.color = 'white';
            
            applyCustomerFilters();
        }

        // ì§ì› í•„í„°
        function filterByEmployee() {
            const select = document.getElementById('employee-filter');
            currentEmployeeFilter = select.value;
            applyCustomerFilters();
        }

        // ê³ ê° ê´€ë¦¬ í˜ì´ì§€ë„¤ì´ì…˜ ë Œë”ë§
        function renderCustomerPagination() {
            const paginationContainer = document.getElementById('customer-pagination');
            if (!paginationContainer) return;
            
            if (customerTotalPages <= 1) {
                paginationContainer.innerHTML = '';
                return;
            }
            
            let paginationHTML = '<div class="pagination">';
            
            // ì´ì „ í˜ì´ì§€ ë²„íŠ¼
            if (currentCustomerPage > 1) {
                paginationHTML += `<button class="pagination-btn" onclick="loadAllCustomers(${currentCustomerPage - 1})">&lt;</button>`;
            }
            
            // í˜ì´ì§€ ë²ˆí˜¸ë“¤
            const startPage = Math.max(1, currentCustomerPage - 2);
            const endPage = Math.min(customerTotalPages, currentCustomerPage + 2);
            
            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentCustomerPage;
                paginationHTML += `<button class="pagination-btn ${isActive ? 'active' : ''}" onclick="loadAllCustomers(${i})">${i}</button>`;
            }
            
            // ë‹¤ìŒ í˜ì´ì§€ ë²„íŠ¼
            if (currentCustomerPage < customerTotalPages) {
                paginationHTML += `<button class="pagination-btn" onclick="loadAllCustomers(${currentCustomerPage + 1})">&gt;</button>`;
            }
            
            paginationHTML += '</div>';
            paginationContainer.innerHTML = paginationHTML;
        }

        // ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
        function showCustomerError(message) {
            alert('âŒ ' + message);
        }

        // ==================== ê³ ê° ìˆ˜ì •/ì‚­ì œ ê¸°ëŠ¥ êµ¬í˜„ ====================
        
        // ê³ ê° ìˆ˜ì • ëª¨ë‹¬
        function editCustomer(customerId) {
            const customer = allCustomers.find(c => c.id === customerId);
            if (!customer) {
                showCustomerError('ê³ ê°ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ëª¨ë‹¬ HTML ìƒì„±
            const modalHTML = `
                <div id="edit-customer-modal" class="modal" style="display: block;">
                    <div class="modal-content" style="max-width: 800px;">
                        <div class="modal-header">
                            <h3 class="modal-title">ê³ ê° ì •ë³´ ìˆ˜ì •</h3>
                            <button class="close-btn" onclick="closeEditCustomerModal()">&times;</button>
                        </div>
                        <form id="edit-customer-form">
                            <div class="form-grid" style="grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 20px;">
                                <div class="form-group">
                                    <label>ë‚ ì§œ</label>
                                    <input type="date" name="inquiry_date" value="${customer.inquiry_date || ''}" required>
                                </div>
                                <div class="form-group">
                                    <label>ì…ì£¼ì¼</label>
                                    <input type="date" name="move_in_date" value="${customer.move_in_date || ''}">
                                </div>
                                <div class="form-group">
                                    <label>ê³ ê°ëª…</label>
                                    <input type="text" name="customer_name" value="${customer.customer_name || ''}" required>
                                </div>
                                <div class="form-group">
                                    <label>ê³ ê°ë²ˆí˜¸</label>
                                    <input type="tel" name="customer_phone" value="${customer.customer_phone || customer.phone || ''}">
                                </div>
                                <div class="form-group">
                                    <label>ê¸ˆì•¡</label>
                                    <input type="text" name="amount" value="${customer.amount || customer.budget || ''}">
                                </div>
                                <div class="form-group">
                                    <label>ë£¸ìˆ˜</label>
                                    <input type="text" name="room_count" value="${customer.room_count || customer.rooms || ''}">
                                </div>
                                <div class="form-group">
                                    <label>ìœ„ì¹˜</label>
                                    <input type="text" name="location" value="${customer.location || ''}">
                                </div>
                                <div class="form-group">
                                    <label>ì§„í–‰ì—¬ë¶€</label>
                                    <select name="progress_status">
                                        <option value="ìƒë‹´ì¤‘" ${(customer.progress_status || 'ìƒë‹´ì¤‘') === 'ìƒë‹´ì¤‘' ? 'selected' : ''}>ìƒë‹´ì¤‘</option>
                                        <option value="ê³„ì•½" ${customer.progress_status === 'ê³„ì•½' ? 'selected' : ''}>ê³„ì•½</option>
                                        <option value="ë³´ë¥˜" ${customer.progress_status === 'ë³´ë¥˜' ? 'selected' : ''}>ë³´ë¥˜</option>
                                    </select>
                                </div>
                            </div>
                                <div class="form-group">
                                    <label>ëŒ€ì¶œì—¬ë¶€</label>
                                    <input type="text" name="loan_info" value="${customer.loan_info || ''}">
                                </div>
                                <div class="form-group">
                                    <label>ì£¼ì°¨</label>
                                    <input type="text" name="parking" value="${customer.parking || ''}">
                                </div>
                                <div class="form-group">
                                    <label>ì• ì™„ë™ë¬¼</label>
                                    <input type="text" name="pets" value="${customer.pets || ''}">
                                </div>
                            </div>
                            <div class="form-group" style="grid-column: 1 / -1;">
                                <label>ë©”ëª¨</label>
                                <textarea name="memo" rows="4" style="width: 100%; resize: vertical;">${customer.memo || ''}</textarea>
                            </div>
                            <div style="display: flex; gap: 12px; justify-content: flex-end; margin-top: 24px;">
                                <button type="button" class="btn btn-secondary" onclick="closeEditCustomerModal()">ì·¨ì†Œ</button>
                                <button type="submit" class="btn btn-primary">ì €ì¥</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            // ëª¨ë‹¬ì„ bodyì— ì¶”ê°€
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // í¼ ì œì¶œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            document.getElementById('edit-customer-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                await saveCustomerChanges(customerId, e.target);
            });
        }
        
        // ê³ ê° ìˆ˜ì • ëª¨ë‹¬ ë‹«ê¸°
        function closeEditCustomerModal() {
            const modal = document.getElementById('edit-customer-modal');
            if (modal) {
                modal.remove();
            }
        }
        
        // ê³ ê° ì •ë³´ ì €ì¥
        async function saveCustomerChanges(customerId, form) {
            const formData = new FormData(form);
            const data = {};
            
            // FormDataë¥¼ ê°ì²´ë¡œ ë³€í™˜
            for (let [key, value] of formData.entries()) {
                data[key] = value || null;
            }
            
            try {
                const response = await fetch(`/api/customers/${customerId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('âœ… ê³ ê° ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    closeEditCustomerModal();
                    loadAllCustomers(currentCustomerPage);
                } else {
                    showCustomerError('ìˆ˜ì • ì‹¤íŒ¨: ' + (result.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                }
            } catch (error) {
                console.error('ê³ ê° ìˆ˜ì • ì‹¤íŒ¨:', error);
                showCustomerError('ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // ê³ ê° ì‚­ì œ
        async function deleteCustomer(customerId) {
            const customer = allCustomers.find(c => c.id === customerId);
            const customerName = customer ? customer.customer_name : 'ì•Œ ìˆ˜ ì—†ìŒ';
            
            if (!confirm(`ì •ë§ë¡œ "${customerName}" ê³ ê°ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\\n\\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) {
                return;
            }
            
            try {
                const response = await fetch(`/api/customers/${customerId}`, {
                    method: 'DELETE'
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('âœ… ê³ ê°ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                    loadAllCustomers(currentCustomerPage);
                } else {
                    showCustomerError('ì‚­ì œ ì‹¤íŒ¨: ' + (result.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                }
            } catch (error) {
                console.error('ê³ ê° ì‚­ì œ ì‹¤íŒ¨:', error);
                showCustomerError('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ìƒˆ ê³ ê° í–‰ ì¶”ê°€
        function addNewCustomerRow() {
            const tableContent = document.getElementById('customer-table-content');
            const table = tableContent.querySelector('table');
            
            if (!table) {
                // í…Œì´ë¸”ì´ ì—†ìœ¼ë©´ ë¨¼ì € ìƒì„±
                tableContent.innerHTML = `
                    <table class="employees-table">
                        <thead>
                            <tr>
                                <th>ë‚ ì§œ</th>
                                <th>ì…ì£¼</th>
                                <th>ê³ ê°</th>
                                <th>ê³ ê°ë²ˆí˜¸</th>
                                <th>ê¸ˆì•¡</th>
                                <th>ë£¸ìˆ˜</th>
                                <th>ìœ„ì¹˜</th>
                                <th>ëŒ€ì¶œì—¬ë¶€</th>
                                <th>ì£¼ì°¨</th>
                                <th>ì• ì™„</th>
                                <th>ë©”ëª¨</th>
                                <th>ì§„í–‰ì—¬ë¶€</th>
                                <th>ì£¼ê±°ì‚¬ì´íŠ¸</th>
                                <th>ì—…ë¬´ì‚¬ì´íŠ¸</th>
                                <th>ë‹´ë‹¹ì</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                `;
            }
            
            const tbody = tableContent.querySelector('tbody');
            const today = new Date().toISOString().split('T')[0];
            
            // ìƒˆ í–‰ ìƒì„±
            const newRow = document.createElement('tr');
            newRow.className = 'new-customer-row';
            newRow.style.backgroundColor = '#f0f9ff';
            
            newRow.innerHTML = `
                <td><input type="date" class="form-input" value="${today}" style="width:100px; font-size:12px;"></td>
                <td><input type="date" class="form-input" style="width:100px; font-size:12px;"></td>
                <td><input type="text" class="form-input" placeholder="ê³ ê°ëª…" style="width:80px; font-size:12px;"></td>
                <td><input type="text" class="form-input" placeholder="010-0000-0000" style="width:110px; font-size:12px;"></td>
                <td><input type="number" class="form-input" placeholder="ì˜ˆì‚°" style="width:80px; font-size:12px;"></td>
                <td><input type="text" class="form-input" placeholder="2ë£¸" style="width:60px; font-size:12px;"></td>
                <td><input type="text" class="form-input" placeholder="ì§€ì—­" style="width:80px; font-size:12px;"></td>
                <td>
                    <select class="form-input" style="width:60px; font-size:12px;">
                        <option value="false">X</option>
                        <option value="true">O</option>
                    </select>
                </td>
                <td>
                    <select class="form-input" style="width:60px; font-size:12px;">
                        <option value="false">X</option>
                        <option value="true">O</option>
                    </select>
                </td>
                <td><input type="text" class="form-input" placeholder="í«ì—¬ë¶€" style="width:60px; font-size:12px;"></td>
                <td><input type="text" class="form-input" placeholder="ë©”ëª¨" style="width:150px; font-size:12px;"></td>
                <td>
                    <select class="form-input" style="width:80px; font-size:12px;">
                        <option value="ì§„í–‰ì¤‘">ì§„í–‰ì¤‘</option>
                        <option value="ê³„ì•½">ê³„ì•½</option>
                        <option value="ë³´ë¥˜">ë³´ë¥˜</option>
                    </select>
                </td>
                <td>-</td>
                <td>-</td>
                <td>ê´€ë¦¬ì</td>
                <td>
                    <button onclick="saveNewCustomer(this)" class="btn btn-sm btn-primary" style="padding:4px 8px; font-size:11px;">ì €ì¥</button>
                    <button onclick="cancelNewCustomer(this)" class="btn btn-sm btn-secondary" style="padding:4px 8px; font-size:11px;">ì·¨ì†Œ</button>
                </td>
            `;
            
            tbody.insertBefore(newRow, tbody.firstChild);
        }
        
        // ìƒˆ ê³ ê° ì €ì¥
        async function saveNewCustomer(button) {
            const row = button.closest('tr');
            const inputs = row.querySelectorAll('input, select');
            
            const customerData = {
                inquiry_date: inputs[0].value,
                move_in_date: inputs[1].value,
                customer_name: inputs[2].value,
                customer_phone: inputs[3].value,
                budget: inputs[4].value ? parseInt(inputs[4].value) : null,
                rooms: inputs[5].value,
                location: inputs[6].value,
                loan_needed: inputs[7].value === 'true',
                parking_needed: inputs[8].value === 'true',
                pets: inputs[9].value,
                memo: inputs[10].value,
                status: inputs[11].value
            };
            
            // í•„ìˆ˜ í•„ë“œ í™•ì¸
            if (!customerData.customer_name) {
                alert('ê³ ê°ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            try {
                const response = await fetch('/api/customers', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(customerData)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('ê³ ê°ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    row.remove();
                    loadAllCustomers(1); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                } else {
                    alert(result.message || 'ê³ ê° ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('ê³ ê° ì¶”ê°€ ì˜¤ë¥˜:', error);
                alert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // ìƒˆ ê³ ê° ì·¨ì†Œ
        function cancelNewCustomer(button) {
            const row = button.closest('tr');
            row.remove();
        }

        // íŒ€ì¥ìš© ë©”ì´í”Œê´€ë¦¬ í†µê³„ ì—…ë°ì´íŠ¸
        function updateTeamMaeipleStats(data) {
            const properties = data.properties || [];
            const total = properties.length;
            
            // ìƒíƒœë³„ ê°œìˆ˜ ê³„ì‚°
            const statusCounts = {
                'ê±°ë˜ì¤‘': 0,
                'ê±°ë˜ì™„ë£Œ': 0,
                'ë³´ë¥˜': 0,
                'ë¶€ì¬': 0
            };
            
            properties.forEach(property => {
                const status = property.status || 'ë³´ë¥˜';
                if (statusCounts.hasOwnProperty(status)) {
                    statusCounts[status]++;
                }
            });
            
            // ì´ë²ˆ ì£¼ ì‹ ê·œ ë“±ë¡ ê³„ì‚° (í˜„ì¬ ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ 7ì¼ ì´ë‚´)
            const now = new Date();
            const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
            const newThisWeek = properties.filter(property => {
                const createdDate = new Date(property.created_at || property.date_added || now);
                return createdDate >= weekAgo;
            }).length;
            
            // í†µê³„ ì¹´ë“œ ì—…ë°ì´íŠ¸
            document.getElementById('total-maeiple-team').textContent = total;
            document.getElementById('available-maeiple-team').textContent = statusCounts['ê±°ë˜ì¤‘'];
            document.getElementById('completed-maeiple-team').textContent = statusCounts['ê±°ë˜ì™„ë£Œ'];
            document.getElementById('new-maeiple-team').textContent = newThisWeek;
            
            console.log('íŒ€ì¥ìš© ë©”ì´í”Œê´€ë¦¬ í†µê³„ ì—…ë°ì´íŠ¸ ì™„ë£Œ:', statusCounts);
        }

        // ==================== íŒ€ì¥ ì „ìš© í•¨ìˆ˜ë“¤ ====================
        
        // íŒ€ì¥ ë³¸ì¸ ê³ ê° ì¡°íšŒ
        async function loadTeamLeaderCustomers(page = 1) {
            try {
                const url = `/api/team-leader/customers?page=${page}&per_page=20`;
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.customers) {
                    console.log(`íŒ€ì¥ ë³¸ì¸ ê³ ê° ë¡œë“œ: ${data.customers.length}ê°œ (í˜ì´ì§€ ${page}/${data.total_pages})`);
                    renderTeamLeaderCustomers(data.customers);
                    renderTeamLeaderCustomerPagination(data.total_pages, page);
                    updateTeamLeaderCustomerStats(data.customers);
                } else {
                    console.error('íŒ€ì¥ ë³¸ì¸ ê³ ê° ë°ì´í„° ì˜¤ë¥˜:', data.error);
                    alert('íŒ€ì¥ ë³¸ì¸ ê³ ê°ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('íŒ€ì¥ ë³¸ì¸ ê³ ê° ë¡œë“œ ì˜¤ë¥˜:', error);
                alert('íŒ€ì¥ ë³¸ì¸ ê³ ê°ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // íŒ€ì¥ ë³¸ì¸ ë§¤ë¬¼ ì¡°íšŒ
        async function loadTeamLeaderMaeiple(page = 1) {
            try {
                const url = `/api/team-leader/maeiple?page=${page}&per_page=20`;
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.success) {
                    console.log(`íŒ€ì¥ ë³¸ì¸ ë§¤ë¬¼ ë¡œë“œ: ${data.properties.length}ê°œ (í˜ì´ì§€ ${page}/${data.total_pages})`);
                    renderTeamLeaderMaeiple(data.properties);
                    renderTeamLeaderMaeiplePagination(data.total_pages, page);
                    updateTeamLeaderMaeipleStats(data.properties);
                } else {
                    console.error('íŒ€ì¥ ë³¸ì¸ ë§¤ë¬¼ ë°ì´í„° ì˜¤ë¥˜:', data.error);
                    alert('íŒ€ì¥ ë³¸ì¸ ë§¤ë¬¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('íŒ€ì¥ ë³¸ì¸ ë§¤ë¬¼ ë¡œë“œ ì˜¤ë¥˜:', error);
                alert('íŒ€ì¥ ë³¸ì¸ ë§¤ë¬¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // íŒ€ ì „ì²´ ê³ ê° ì¡°íšŒ
        async function loadTeamCustomers(page = 1) {
            try {
                const url = `/api/team/customers?page=${page}&per_page=20`;
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.customers) {
                    console.log(`íŒ€ ì „ì²´ ê³ ê° ë¡œë“œ: ${data.customers.length}ê°œ (í˜ì´ì§€ ${page}/${data.total_pages})`);
                    renderTeamCustomers(data.customers);
                    renderTeamCustomerPagination(data.total_pages, page);
                    updateTeamCustomerStats(data.customers);
                } else {
                    console.error('íŒ€ ì „ì²´ ê³ ê° ë°ì´í„° ì˜¤ë¥˜:', data.error);
                    alert('íŒ€ ì „ì²´ ê³ ê°ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('íŒ€ ì „ì²´ ê³ ê° ë¡œë“œ ì˜¤ë¥˜:', error);
                alert('íŒ€ ì „ì²´ ê³ ê°ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // íŒ€ ì „ì²´ ë§¤ë¬¼ ì¡°íšŒ
        async function loadTeamMaeiple(page = 1) {
            try {
                const url = `/api/team/maeiple?page=${page}&per_page=20`;
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.success) {
                    console.log(`íŒ€ ì „ì²´ ë§¤ë¬¼ ë¡œë“œ: ${data.properties.length}ê°œ (í˜ì´ì§€ ${page}/${data.total_pages})`);
                    renderTeamMaeiple(data.properties);
                    renderTeamMaeiplePagination(data.total_pages, page);
                    updateTeamMaeipleStats(data.properties);
                } else {
                    console.error('íŒ€ ì „ì²´ ë§¤ë¬¼ ë°ì´í„° ì˜¤ë¥˜:', data.error);
                    alert('íŒ€ ì „ì²´ ë§¤ë¬¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('íŒ€ ì „ì²´ ë§¤ë¬¼ ë¡œë“œ ì˜¤ë¥˜:', error);
                alert('íŒ€ ì „ì²´ ë§¤ë¬¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // íŒ€ì¥ ë³¸ì¸ ê³ ê° ë Œë”ë§
        function renderTeamLeaderCustomers(customers) {
            const tableContent = document.getElementById('team-leader-customer-table-body');
            if (!tableContent) return;
            
            let tableHTML = '';
            customers.forEach(customer => {
                tableHTML += `
                    <tr>
                        <td>${customer.inquiry_date || ''}</td>
                        <td>${customer.customer_name || ''}</td>
                        <td>${customer.phone || ''}</td>
                        <td>${customer.amount || ''}</td>
                        <td>${customer.room_count || ''}</td>
                        <td>${customer.location || ''}</td>
                        <td>${customer.loan_info || ''}</td>
                        <td>${customer.parking || ''}</td>
                        <td>${customer.pets || ''}</td>
                        <td>${customer.memo || ''}</td>
                        <td>
                            <span class="status-badge ${customer.progress_status === 'ì§„í–‰ì¤‘' ? 'progress' : customer.progress_status === 'ê³„ì•½' ? 'completed' : 'pending'}">
                                ${customer.progress_status || 'ìƒë‹´ì¤‘'}
                            </span>
                        </td>
                        <td>${customer.employee_name || ''}</td>
                        <td>
                            <button class="btn btn-sm btn-primary" onclick="editTeamLeaderCustomer(${customer.id})">ìˆ˜ì •</button>
                            <button class="btn btn-sm btn-danger" onclick="deleteTeamLeaderCustomer(${customer.id})">ì‚­ì œ</button>
                        </td>
                    </tr>
                `;
            });
            
            tableContent.innerHTML = tableHTML;
        }

        // íŒ€ì¥ ë³¸ì¸ ë§¤ë¬¼ ë Œë”ë§
        function renderTeamLeaderMaeiple(properties) {
            const tableContent = document.getElementById('team-leader-maeiple-table-body');
            if (!tableContent) return;
            
            let tableHTML = '';
            properties.forEach(property => {
                tableHTML += `
                    <tr>
                        <td>${property.check_date || ''}</td>
                        <td>${property.building_number || ''}</td>
                        <td>${property.room_number || ''}</td>
                        <td>
                            <span class="status-badge ${property.status === 'ê±°ë˜ì¤‘' ? 'progress' : property.status === 'ê±°ë˜ì™„ë£Œ' ? 'completed' : 'pending'}">
                                ${property.status || 'ë³´ë¥˜'}
                            </span>
                        </td>
                        <td>${property.jeonse_price || ''}</td>
                        <td>${property.monthly_rent || ''}</td>
                        <td>${property.sale_price || ''}</td>
                        <td>${property.is_occupied ? 'ì…ì£¼ì¤‘' : 'ë¹ˆë°©'}</td>
                        <td>${property.phone || ''}</td>
                        <td>${property.memo || ''}</td>
                        <td>${property.likes || 0}</td>
                        <td>${property.dislikes || 0}</td>
                        <td>${property.employee_name || ''}</td>
                        <td>
                            <button class="btn btn-sm btn-primary" onclick="editTeamLeaderMaeiple(${property.id})">ìˆ˜ì •</button>
                            <button class="btn btn-sm btn-danger" onclick="deleteTeamLeaderMaeiple(${property.id})">ì‚­ì œ</button>
                        </td>
                    </tr>
                `;
            });
            
            tableContent.innerHTML = tableHTML;
        }

        // íŒ€ ì „ì²´ ê³ ê° ë Œë”ë§
        function renderTeamCustomers(customers) {
            const tableContent = document.getElementById('team-customer-table-body');
            if (!tableContent) return;
            
            let tableHTML = '';
            customers.forEach(customer => {
                tableHTML += `
                    <tr>
                        <td>${customer.inquiry_date || ''}</td>
                        <td>${customer.customer_name || ''}</td>
                        <td>${customer.phone || ''}</td>
                        <td>${customer.amount || ''}</td>
                        <td>${customer.room_count || ''}</td>
                        <td>${customer.location || ''}</td>
                        <td>${customer.loan_info || ''}</td>
                        <td>${customer.parking || ''}</td>
                        <td>${customer.pets || ''}</td>
                        <td>${customer.memo || ''}</td>
                        <td>
                            <span class="status-badge ${customer.progress_status === 'ì§„í–‰ì¤‘' ? 'progress' : customer.progress_status === 'ê³„ì•½' ? 'completed' : 'pending'}">
                                ${customer.progress_status || 'ìƒë‹´ì¤‘'}
                            </span>
                        </td>
                        <td>${customer.employee_name || ''}</td>
                        <td>
                            <button class="btn btn-sm btn-primary" onclick="editTeamCustomer(${customer.id})">ìˆ˜ì •</button>
                            <button class="btn btn-sm btn-danger" onclick="deleteTeamCustomer(${customer.id})">ì‚­ì œ</button>
                        </td>
                    </tr>
                `;
            });
            
            tableContent.innerHTML = tableHTML;
        }

        // íŒ€ ì „ì²´ ë§¤ë¬¼ ë Œë”ë§
        function renderTeamMaeiple(properties) {
            const tableContent = document.getElementById('team-maeiple-table-body');
            if (!tableContent) return;
            
            let tableHTML = '';
            properties.forEach(property => {
                tableHTML += `
                    <tr>
                        <td>${property.check_date || ''}</td>
                        <td>${property.building_number || ''}</td>
                        <td>${property.room_number || ''}</td>
                        <td>
                            <span class="status-badge ${property.status === 'ê±°ë˜ì¤‘' ? 'progress' : property.status === 'ê±°ë˜ì™„ë£Œ' ? 'completed' : 'pending'}">
                                ${property.status || 'ë³´ë¥˜'}
                            </span>
                        </td>
                        <td>${property.jeonse_price || ''}</td>
                        <td>${property.monthly_rent || ''}</td>
                        <td>${property.sale_price || ''}</td>
                        <td>${property.is_occupied ? 'ì…ì£¼ì¤‘' : 'ë¹ˆë°©'}</td>
                        <td>${property.phone || ''}</td>
                        <td>${property.memo || ''}</td>
                        <td>${property.likes || 0}</td>
                        <td>${property.dislikes || 0}</td>
                        <td>${property.employee_name || ''}</td>
                        <td>
                            <button class="btn btn-sm btn-primary" onclick="editTeamMaeiple(${property.id})">ìˆ˜ì •</button>
                            <button class="btn btn-sm btn-danger" onclick="deleteTeamMaeiple(${property.id})">ì‚­ì œ</button>
                        </td>
                    </tr>
                `;
            });
            
            tableContent.innerHTML = tableHTML;
        }

        // í†µê³„ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤
        function updateTeamLeaderCustomerStats(customers) {
            const total = customers.length;
            const progress = customers.filter(c => (c.progress_status || 'ìƒë‹´ì¤‘') === 'ì§„í–‰ì¤‘').length;
            const completed = customers.filter(c => (c.progress_status || '') === 'ê³„ì•½').length;
            
            const weekAgo = new Date();
            weekAgo.setDate(weekAgo.getDate() - 7);
            const newCustomers = customers.filter(c => {
                if (!c.inquiry_date) return false;
                const customerDate = new Date(c.inquiry_date);
                return customerDate >= weekAgo;
            }).length;

            // í†µê³„ ì¹´ë“œ ì—…ë°ì´íŠ¸ (íŒ€ì¥ ë³¸ì¸ ê³ ê°)
            const totalElement = document.getElementById('total-customers-team-leader');
            const progressElement = document.getElementById('progress-customers-team-leader');
            const completedElement = document.getElementById('completed-customers-team-leader');
            const newElement = document.getElementById('new-customers-team-leader');
            
            if (totalElement) totalElement.textContent = total;
            if (progressElement) progressElement.textContent = progress;
            if (completedElement) completedElement.textContent = completed;
            if (newElement) newElement.textContent = newCustomers;
        }

        function updateTeamLeaderMaeipleStats(properties) {
            const total = properties.length;
            const progress = properties.filter(p => p.status === 'ê±°ë˜ì¤‘').length;
            const completed = properties.filter(p => p.status === 'ê±°ë˜ì™„ë£Œ').length;
            
            const now = new Date();
            const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
            const newThisWeek = properties.filter(property => {
                const createdDate = new Date(property.created_at || property.date_added || now);
                return createdDate >= weekAgo;
            }).length;

            // í†µê³„ ì¹´ë“œ ì—…ë°ì´íŠ¸ (íŒ€ì¥ ë³¸ì¸ ë§¤ë¬¼)
            const totalElement = document.getElementById('total-maeiple-team-leader');
            const progressElement = document.getElementById('available-maeiple-team-leader');
            const completedElement = document.getElementById('completed-maeiple-team-leader');
            const newElement = document.getElementById('new-maeiple-team-leader');
            
            if (totalElement) totalElement.textContent = total;
            if (progressElement) progressElement.textContent = progress;
            if (completedElement) completedElement.textContent = completed;
            if (newElement) newElement.textContent = newThisWeek;
        }

        function updateTeamCustomerStats(customers) {
            const total = customers.length;
            const progress = customers.filter(c => (c.progress_status || 'ìƒë‹´ì¤‘') === 'ì§„í–‰ì¤‘').length;
            const completed = customers.filter(c => (c.progress_status || '') === 'ê³„ì•½').length;
            
            const weekAgo = new Date();
            weekAgo.setDate(weekAgo.getDate() - 7);
            const newCustomers = customers.filter(c => {
                if (!c.inquiry_date) return false;
                const customerDate = new Date(c.inquiry_date);
                return customerDate >= weekAgo;
            }).length;

            // í†µê³„ ì¹´ë“œ ì—…ë°ì´íŠ¸ (íŒ€ ì „ì²´ ê³ ê°)
            const totalElement = document.getElementById('total-customers-team');
            const progressElement = document.getElementById('progress-customers-team');
            const completedElement = document.getElementById('completed-customers-team');
            const newElement = document.getElementById('new-customers-team');
            
            if (totalElement) totalElement.textContent = total;
            if (progressElement) progressElement.textContent = progress;
            if (completedElement) completedElement.textContent = completed;
            if (newElement) newElement.textContent = newCustomers;
        }

        // í˜ì´ì§€ë„¤ì´ì…˜ ë Œë”ë§ í•¨ìˆ˜ë“¤
        function renderTeamLeaderCustomerPagination(totalPages, currentPage) {
            const pagination = document.getElementById('team-leader-customer-pagination');
            if (!pagination) return;
            
            let paginationHTML = '';
            for (let i = 1; i <= totalPages; i++) {
                paginationHTML += `
                    <button class="btn btn-sm ${i === currentPage ? 'btn-primary' : 'btn-outline-primary'}" 
                            onclick="loadTeamLeaderCustomers(${i})">${i}</button>
                `;
            }
            pagination.innerHTML = paginationHTML;
        }

        function renderTeamLeaderMaeiplePagination(totalPages, currentPage) {
            const pagination = document.getElementById('team-leader-maeiple-pagination');
            if (!pagination) return;
            
            let paginationHTML = '';
            for (let i = 1; i <= totalPages; i++) {
                paginationHTML += `
                    <button class="btn btn-sm ${i === currentPage ? 'btn-primary' : 'btn-outline-primary'}" 
                            onclick="loadTeamLeaderMaeiple(${i})">${i}</button>
                `;
            }
            pagination.innerHTML = paginationHTML;
        }

        function renderTeamCustomerPagination(totalPages, currentPage) {
            const pagination = document.getElementById('team-customer-pagination');
            if (!pagination) return;
            
            let paginationHTML = '';
            for (let i = 1; i <= totalPages; i++) {
                paginationHTML += `
                    <button class="btn btn-sm ${i === currentPage ? 'btn-primary' : 'btn-outline-primary'}" 
                            onclick="loadTeamCustomers(${i})">${i}</button>
                `;
            }
            pagination.innerHTML = paginationHTML;
        }

        function renderTeamMaeiplePagination(totalPages, currentPage) {
            const pagination = document.getElementById('team-maeiple-pagination');
            if (!pagination) return;
            
            let paginationHTML = '';
            for (let i = 1; i <= totalPages; i++) {
                paginationHTML += `
                    <button class="btn btn-sm ${i === currentPage ? 'btn-primary' : 'btn-outline-primary'}" 
                            onclick="loadTeamMaeiple(${i})">${i}</button>
                `;
            }
            pagination.innerHTML = paginationHTML;
        }

        // í•„í„° í•¨ìˆ˜ë“¤
        function setTeamLeaderCustomerFilter(status, btn) {
            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.filter-btn[data-status]').forEach(b => {
                b.classList.remove('active');
            });
            btn.classList.add('active');
            
            // í•„í„°ë§ ë¡œì§ (í•„ìš”ì‹œ êµ¬í˜„)
            console.log('íŒ€ì¥ ë³¸ì¸ ê³ ê° í•„í„°:', status);
        }

        function setTeamLeaderMaeipleFilter(status, btn) {
            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.filter-btn[data-status]').forEach(b => {
                b.classList.remove('active');
            });
            btn.classList.add('active');
            
            // í•„í„°ë§ ë¡œì§ (í•„ìš”ì‹œ êµ¬í˜„)
            console.log('íŒ€ì¥ ë³¸ì¸ ë§¤ë¬¼ í•„í„°:', status);
        }

        function setTeamCustomerFilter(status, btn) {
            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.filter-btn[data-status]').forEach(b => {
                b.classList.remove('active');
            });
            btn.classList.add('active');
            
            // í•„í„°ë§ ë¡œì§ (í•„ìš”ì‹œ êµ¬í˜„)
            console.log('íŒ€ ì „ì²´ ê³ ê° í•„í„°:', status);
        }

        function setTeamMaeipleFilter(status, btn) {
            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.filter-btn[data-status]').forEach(b => {
                b.classList.remove('active');
            });
            btn.classList.add('active');
            
            // í•„í„°ë§ ë¡œì§ (í•„ìš”ì‹œ êµ¬í˜„)
            console.log('íŒ€ ì „ì²´ ë§¤ë¬¼ í•„í„°:', status);
        }

        // í¸ì§‘/ì‚­ì œ í•¨ìˆ˜ë“¤ (ì„ì‹œ êµ¬í˜„)
        function editTeamLeaderCustomer(id) { alert('íŒ€ì¥ ë³¸ì¸ ê³ ê° ìˆ˜ì • ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.'); }
        function deleteTeamLeaderCustomer(id) { alert('íŒ€ì¥ ë³¸ì¸ ê³ ê° ì‚­ì œ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.'); }
        function editTeamLeaderMaeiple(id) { alert('íŒ€ì¥ ë³¸ì¸ ë§¤ë¬¼ ìˆ˜ì • ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.'); }
        function deleteTeamLeaderMaeiple(id) { alert('íŒ€ì¥ ë³¸ì¸ ë§¤ë¬¼ ì‚­ì œ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.'); }
        function editTeamCustomer(id) { alert('íŒ€ ê³ ê° ìˆ˜ì • ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.'); }
        function deleteTeamCustomer(id) { alert('íŒ€ ê³ ê° ì‚­ì œ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.'); }
        function editTeamMaeiple(id) { alert('íŒ€ ë§¤ë¬¼ ìˆ˜ì • ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.'); }
        function deleteTeamMaeiple(id) { alert('íŒ€ ë§¤ë¬¼ ì‚­ì œ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.'); }

        // ì¶”ê°€ í•¨ìˆ˜ë“¤ (ì„ì‹œ êµ¬í˜„)
        function addNewTeamLeaderCustomerRow() { alert('íŒ€ì¥ ë³¸ì¸ ê³ ê° ì¶”ê°€ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.'); }
        function addNewTeamLeaderMaeipleRow() { alert('íŒ€ì¥ ë³¸ì¸ ë§¤ë¬¼ ì¶”ê°€ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.'); }
        function addNewTeamCustomerRow() { alert('íŒ€ ê³ ê° ì¶”ê°€ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.'); }
        function addNewTeamMaeipleRow() { alert('íŒ€ ë§¤ë¬¼ ì¶”ê°€ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.'); }
        
        // ==================== ë§¤ë¬¼ ë©”ëª¨ ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ (ì§ì›í˜ì´ì§€ì™€ ë™ì¼) ====================
        
        // ë§¤ë¬¼ ë©”ëª¨ ëª¨ë‹¬ ì—´ê¸°
        function openPropertyMemoModal(propertyId, currentMemo, buildingNumber, roomNumber) {
            const modal = document.getElementById('property-memo-modal');
            const textarea = document.getElementById('property-memo-textarea');
            const propertyInfo = document.getElementById('property-memo-info');
            
            // ë§¤ë¬¼ ì •ë³´ í‘œì‹œ
            const propertyDisplay = `${buildingNumber || 'ë™'}${roomNumber ? '-' + roomNumber + 'í˜¸' : ''}`;
            propertyInfo.textContent = propertyDisplay;
            
            // í˜„ì¬ ë©”ëª¨ ë‚´ìš© ì„¤ì •
            textarea.value = currentMemo || '';
            
            // ëª¨ë‹¬ í‘œì‹œ
            modal.classList.add('active');
            
            // í…ìŠ¤íŠ¸ ì˜ì—­ì— í¬ì»¤ìŠ¤
            setTimeout(() => {
                textarea.focus();
                textarea.setSelectionRange(textarea.value.length, textarea.value.length);
            }, 100);
            
            // ì „ì—­ ë³€ìˆ˜ì— í˜„ì¬ í¸ì§‘ ì¤‘ì¸ ë§¤ë¬¼ ì •ë³´ ì €ì¥
            window.currentPropertyMemo = {
                id: propertyId,
                element: null
            };
        }
        
        // ë§¤ë¬¼ ë©”ëª¨ ëª¨ë‹¬ ë‹«ê¸°
        function closePropertyMemoModal() {
            const modal = document.getElementById('property-memo-modal');
            modal.classList.remove('active');
            window.currentPropertyMemo = null;
        }
        
        // ë§¤ë¬¼ ë©”ëª¨ ì €ì¥
        async function savePropertyMemo() {
            const textarea = document.getElementById('property-memo-textarea');
            const memo = textarea.value.trim();
            
            if (!window.currentPropertyMemo) {
                console.error('ì €ì¥í•  ë§¤ë¬¼ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const propertyId = window.currentPropertyMemo.id;
            
            try {
                // ì„œë²„ì— ì €ì¥
                const response = await fetch('/api/maeiple/update', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        id: propertyId,
                        field: 'memo',
                        value: memo
                    })
                });
                
                if (response.ok) {
                    console.log('ë©”ëª¨ ì €ì¥ ì„±ê³µ:', { propertyId, memo });
                    
                    // ë¡œì»¬ ë°ì´í„°ë„ ì—…ë°ì´íŠ¸ (ìˆœì„œ ìœ ì§€)
                    const property = properties.find(p => p.id == propertyId);
                    if (property) {
                        property.memo = memo;
                    }
                    
                    // UI ì—…ë°ì´íŠ¸
                    updateMemoInUI(propertyId, memo);
                    
                    // ëª¨ë‹¬ ë‹«ê¸°
                    closePropertyMemoModal();
                    
                    showAlert('ë©”ëª¨ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                } else {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'ì €ì¥ ì‹¤íŒ¨');
                }
                
            } catch (error) {
                console.error('ë©”ëª¨ ì €ì¥ ì˜¤ë¥˜:', error);
                showAlert(`ë©”ëª¨ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}`, 'error');
            }
        }
        
        // ë©”ëª¨ UIë§Œ ì—…ë°ì´íŠ¸ (ìˆœì„œ ìœ ì§€)
        function updateMemoInUI(propertyId, memo) {
            // í•´ë‹¹ ë§¤ë¬¼ì˜ ë©”ëª¨ ì…€ ì°¾ê¸°
            const memoCell = document.querySelector(`[onclick*="openPropertyMemoModal(${propertyId},"]`);
            if (memoCell) {
                // ë©”ëª¨ ë‚´ìš© ì—…ë°ì´íŠ¸
                const displayText = memo ? (memo.length > 20 ? memo.substring(0, 20) + '...' : memo) : '-';
                memoCell.textContent = displayText;
                memoCell.style.color = memo ? '#374151' : '#64748b';
                memoCell.style.fontStyle = memo ? 'normal' : 'italic';
                
                // onclick ì†ì„±ë„ ì—…ë°ì´íŠ¸í•˜ì—¬ ìƒˆë¡œìš´ ë©”ëª¨ ë‚´ìš©ì„ ë°˜ì˜
                const row = memoCell.closest('tr');
                const buildingNumber = row.querySelector('[data-field="building_number"]')?.textContent || '';
                const roomNumber = row.querySelector('[data-field="room_number"]')?.textContent || '';
                const escapedMemo = (memo || '').replace(/'/g, "\\'").replace(/"/g, '\\"');
                
                memoCell.setAttribute('onclick', `openPropertyMemoModal(${propertyId}, '${escapedMemo}', '${buildingNumber}', '${roomNumber}')`);
            }
        }
        
        // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closePropertyMemoModal();
            }
        });
        
        // ë©”ëª¨ í…ìŠ¤íŠ¸ ì˜ì—­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (ê¸°ì¡´ DOMContentLoadedì— í†µí•©ë¨)
        
        // ==================== ê´€ë¦¬ììš© ë§¤ë¬¼ ì¶”ê°€ ê´€ë ¨ í•¨ìˆ˜ë“¤ ====================
        
        // ìƒˆ ë§¤ë¬¼ ìë™ì €ì¥ í•¨ìˆ˜
        async function autoSaveNewProperty(cell) {
            const row = cell.closest('tr');
            if (!row || !row.classList.contains('new-property-row')) {
                return; // ìƒˆ ë§¤ë¬¼ í–‰ì´ ì•„ë‹ˆë©´ ì €ì¥í•˜ì§€ ì•ŠìŒ
            }
            
            console.log('ğŸ”„ ìƒˆ ë§¤ë¬¼ ìë™ì €ì¥ ì‹œì‘...');
            
            try {
                // ë°ì´í„° ìˆ˜ì§‘
                const propertyData = {};
                const cells = row.querySelectorAll('.editable-cell');
                
                cells.forEach(cell => {
                    const field = cell.dataset.field;
                    let value = cell.textContent.trim();
                    
                    // ë°°ì§€ì—ì„œ ê°’ ì¶”ì¶œ
                    if (field === 'status') {
                        const badge = cell.querySelector('.badge');
                        value = badge ? badge.textContent.trim() : 'ê±°ë˜ê°€ëŠ¥';
                    } else if (field === 'is_occupied') {
                        const badge = cell.querySelector('.badge');
                        value = badge && badge.textContent.trim() === 'O';
                    } else if (field === 'employee_team') {
                        // íŒ€ í•„ë“œì—ì„œ status-badge ê°’ ì¶”ì¶œ
                        const badge = cell.querySelector('.status-badge');
                        value = badge ? badge.textContent.trim() : '';
                        // í”Œë ˆì´ìŠ¤í™€ë” í…ìŠ¤íŠ¸ ì œê±°
                        if (value === 'íŒ€ ì…ë ¥') {
                            value = '';
                        }
                    } else if (field.includes('price') || field.includes('deposit') || field.includes('rent')) {
                        // ê°€ê²© í•„ë“œ ì²˜ë¦¬
                        const numValue = value.replace(/[^0-9]/g, '');
                        value = numValue ? parseInt(numValue) : null;
                    } else if (field === 'building_number' || field === 'room_number') {
                        // ë™/í˜¸ìˆ˜ ì²˜ë¦¬ (ì„ íƒì‚¬í•­)
                        value = value.replace(/[^0-9]/g, '');
                        // í•„ìˆ˜ ê²€ì¦ ì œê±° - ë¹ˆ ê°’ë„ í—ˆìš©
                    }
                    
                    // í”Œë ˆì´ìŠ¤í™€ë” í…ìŠ¤íŠ¸ ì œê±° (ë‹´ë‹¹ì í•„ë“œ)
                    if (field === 'employee_name' && typeof value === 'string' && value.includes('ì…ë ¥')) {
                        value = '';
                    }
                    
                    propertyData[field] = value;
                });
                
                // ë©”ëª¨ ì²˜ë¦¬
                const memoCell = row.querySelector('.memo-cell');
                propertyData.memo = memoCell.dataset.memo || '';
                
                // ë‹´ë‹¹ìì™€ íŒ€ ì •ë³´ (ê³µë€ì¼ ìˆ˜ ìˆìŒ)
                propertyData.employee_name = propertyData.employee_name || '';
                propertyData.employee_team = propertyData.employee_team || '';
                
                console.log('ìë™ì €ì¥í•  ë§¤ë¬¼ ë°ì´í„°:', propertyData);
                
                // API í˜¸ì¶œ
                const response = await fetch('/api/maeiple', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(propertyData)
                });
                
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`HTTP ${response.status}: ${errorText}`);
                }
                
                const result = await response.json();
                
                if (result && result.success === true) {
                    console.log('âœ… ìƒˆ ë§¤ë¬¼ ìë™ì €ì¥ ì„±ê³µ:', result);
                    
                    // ì„±ê³µì ìœ¼ë¡œ ì €ì¥ëœ ê²½ìš° ìƒˆ í–‰ì„ ì œê±°í•˜ê³  í…Œì´ë¸”ì— ì¶”ê°€
                    if (result.created_property) {
                        await addNewPropertyToTable(result.created_property);
                        row.remove();
                        
                        // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
                        showAlert('ë§¤ë¬¼ì´ ìë™ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                    }
                } else {
                    const errorMsg = result?.error || result?.message || 'ìë™ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
                    console.warn('ìë™ì €ì¥ ì‹¤íŒ¨:', errorMsg);
                    // ì˜¤ë¥˜ê°€ ë°œìƒí•´ë„ ì‚¬ìš©ìì—ê²ŒëŠ” ì•Œë¦¬ì§€ ì•ŠìŒ (ìë™ì €ì¥ì´ë¯€ë¡œ)
                }
                
            } catch (error) {
                console.error('ìë™ì €ì¥ ì˜¤ë¥˜:', error);
                // ì˜¤ë¥˜ê°€ ë°œìƒí•´ë„ ì‚¬ìš©ìì—ê²ŒëŠ” ì•Œë¦¬ì§€ ì•ŠìŒ (ìë™ì €ì¥ì´ë¯€ë¡œ)
            }
        }

        // ê´€ë¦¬ììš© ë§¤ë¬¼ ì…€ í¸ì§‘
        function editAdminPropertyCell(cell) {
            // ì´ë¯¸ í¸ì§‘ ì¤‘ì´ì–´ë„ ê°•ì œë¡œ í¸ì§‘ ì§„ì…
            if (cell.classList.contains('editing-cell')) {
                const existingSelector = cell.querySelector('.status-selector');
                if (existingSelector) {
                    existingSelector.remove();
                }
                cell.classList.remove('editing-cell');
                return; // í¸ì§‘ ëª¨ë“œ ì¢…ë£Œ
            }
            
            const field = cell.dataset.field;
            const type = cell.dataset.type;
            let currentValue = cell.textContent.trim();
            
            // ë°°ì§€ì—ì„œ ì‹¤ì œ ê°’ ì¶”ì¶œ
            if (field === 'status') {
                const badge = cell.querySelector('.badge');
                currentValue = badge ? badge.textContent.trim() : 'ê±°ë˜ê°€ëŠ¥';
            } else if (field === 'is_occupied') {
                const badge = cell.querySelector('.badge');
                currentValue = badge && badge.textContent.trim() === 'O' ? true : false;
            }
            
            // í”Œë ˆì´ìŠ¤í™€ë” í…ìŠ¤íŠ¸ ì œê±°
            if (currentValue.includes('ì…ë ¥')) {
                currentValue = '';
            }
            
            console.log('ê´€ë¦¬ì ë§¤ë¬¼ ì…€ í¸ì§‘:', { field, type, currentValue });
            
            cell.classList.add('editing-cell');
            
            if (type === 'select') {
                if (field === 'status') {
                    // ìƒíƒœ ì„ íƒ ë“œë¡­ë‹¤ìš´
                    const statusOptions = ['ê±°ë˜ê°€ëŠ¥', 'ê³„ì•½ì™„ë£Œ', 'ë³´ë¥˜', 'ë¶€ì¬'];
                    const selector = document.createElement('select');
                    selector.className = 'status-selector';
                    selector.style.cssText = 'width: 100%; padding: 4px; border: 2px solid #3b82f6; border-radius: 4px; background: white; font-size: 12px;';
                    
                    statusOptions.forEach(option => {
                        const optionElement = document.createElement('option');
                        optionElement.value = option;
                        optionElement.textContent = option;
                        if (option === currentValue) {
                            optionElement.selected = true;
                        }
                        selector.appendChild(optionElement);
                    });
                    
                    selector.addEventListener('change', () => {
                        const selectedValue = selector.value;
                        const statusColors = {
                            'ê±°ë˜ê°€ëŠ¥': { bg: '#e0f2fe', color: '#0369a1' },
                            'ê³„ì•½ì™„ë£Œ': { bg: '#dcfce7', color: '#16a34a' },
                            'ë³´ë¥˜': { bg: '#fef3c7', color: '#d97706' },
                            'ë¶€ì¬': { bg: '#fecaca', color: '#dc2626' }
                        };
                        const colors = statusColors[selectedValue] || statusColors['ê±°ë˜ê°€ëŠ¥'];
                        
                        cell.innerHTML = `<span class="badge" style="background: ${colors.bg}; color: ${colors.color}; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">${selectedValue}</span>`;
                        cell.classList.remove('editing-cell');
                        
                        // ìë™ì €ì¥ ì‹¤í–‰
                        autoSaveNewProperty(cell);
                    });
                    
                    selector.addEventListener('blur', () => {
                        const selectedValue = selector.value;
                        const statusColors = {
                            'ê±°ë˜ê°€ëŠ¥': { bg: '#e0f2fe', color: '#0369a1' },
                            'ê³„ì•½ì™„ë£Œ': { bg: '#dcfce7', color: '#16a34a' },
                            'ë³´ë¥˜': { bg: '#fef3c7', color: '#d97706' },
                            'ë¶€ì¬': { bg: '#fecaca', color: '#dc2626' }
                        };
                        const colors = statusColors[selectedValue] || statusColors['ê±°ë˜ê°€ëŠ¥'];
                        
                        cell.innerHTML = `<span class="badge" style="background: ${colors.bg}; color: ${colors.color}; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">${selectedValue}</span>`;
                        cell.classList.remove('editing-cell');
                        
                        // ìë™ì €ì¥ ì‹¤í–‰
                        autoSaveNewProperty(cell);
                    });
                    
                    cell.innerHTML = '';
                    cell.appendChild(selector);
                    selector.focus();
                    
                } else if (field === 'is_occupied') {
                    // ê±°ì£¼ ì—¬ë¶€ ì„ íƒ
                    const occupiedOptions = [
                        { value: false, text: 'X', bg: '#fecaca', color: '#dc2626' },
                        { value: true, text: 'O', bg: '#dcfce7', color: '#16a34a' }
                    ];
                    
                    const selector = document.createElement('select');
                    selector.className = 'status-selector';
                    selector.style.cssText = 'width: 100%; padding: 4px; border: 2px solid #3b82f6; border-radius: 4px; background: white; font-size: 12px;';
                    
                    occupiedOptions.forEach(option => {
                        const optionElement = document.createElement('option');
                        optionElement.value = option.value;
                        optionElement.textContent = option.text;
                        if (option.value === currentValue) {
                            optionElement.selected = true;
                        }
                        selector.appendChild(optionElement);
                    });
                    
                    selector.addEventListener('change', () => {
                        const selectedValue = selector.value === 'true';
                        const option = occupiedOptions.find(opt => opt.value === selectedValue);
                        
                        cell.innerHTML = `<span class="badge" style="background: ${option.bg}; color: ${option.color}; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">${option.text}</span>`;
                        cell.classList.remove('editing-cell');
                        
                        // ìë™ì €ì¥ ì‹¤í–‰
                        autoSaveNewProperty(cell);
                    });
                    
                    selector.addEventListener('blur', () => {
                        const selectedValue = selector.value === 'true';
                        const option = occupiedOptions.find(opt => opt.value === selectedValue);
                        
                        cell.innerHTML = `<span class="badge" style="background: ${option.bg}; color: ${option.color}; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">${option.text}</span>`;
                        cell.classList.remove('editing-cell');
                        
                        // ìë™ì €ì¥ ì‹¤í–‰
                        autoSaveNewProperty(cell);
                    });
                    
                    cell.innerHTML = '';
                    cell.appendChild(selector);
                    selector.focus();
                    
                } else if (field === 'employee_team' && type === 'team') {
                    // íŒ€ ì„ íƒ ë“œë¡­ë‹¤ìš´
                    const teamOptions = ['1íŒ€', '2íŒ€', '3íŒ€', '4íŒ€', '5íŒ€', 'ê´€ë¦¬ì'];
                    const selector = document.createElement('select');
                    selector.className = 'status-selector';
                    selector.style.cssText = 'width: 100%; padding: 4px; border: 2px solid #3b82f6; border-radius: 4px; background: white; font-size: 12px;';
                    
                    teamOptions.forEach(option => {
                        const optionElement = document.createElement('option');
                        optionElement.value = option;
                        optionElement.textContent = option;
                        if (option === currentValue || (currentValue === 'íŒ€ ì…ë ¥' && option === '1íŒ€')) {
                            optionElement.selected = true;
                        }
                        selector.appendChild(optionElement);
                    });
                    
                    selector.addEventListener('change', () => {
                        const selectedValue = selector.value;
                        const teamColors = {
                            '1íŒ€': { bg: '#e0e7ff', color: '#4338ca' },
                            '2íŒ€': { bg: '#dcfce7', color: '#16a34a' },
                            '3íŒ€': { bg: '#fef3c7', color: '#d97706' },
                            '4íŒ€': { bg: '#fce7f3', color: '#ec4899' },
                            '5íŒ€': { bg: '#f0f9ff', color: '#0ea5e9' },
                            'ê´€ë¦¬ì': { bg: '#f1f5f9', color: '#64748b' }
                        };
                        const colors = teamColors[selectedValue] || teamColors['1íŒ€'];
                        
                        cell.innerHTML = `<span class="status-badge" style="background: ${colors.bg}; color: ${colors.color}; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 500;">${selectedValue}</span>`;
                        cell.classList.remove('editing-cell');
                        
                        // ìë™ì €ì¥ ì‹¤í–‰
                        autoSaveNewProperty(cell);
                    });
                    
                    selector.addEventListener('blur', () => {
                        const selectedValue = selector.value;
                        const teamColors = {
                            '1íŒ€': { bg: '#e0e7ff', color: '#4338ca' },
                            '2íŒ€': { bg: '#dcfce7', color: '#16a34a' },
                            '3íŒ€': { bg: '#fef3c7', color: '#d97706' },
                            '4íŒ€': { bg: '#fce7f3', color: '#ec4899' },
                            '5íŒ€': { bg: '#f0f9ff', color: '#0ea5e9' },
                            'ê´€ë¦¬ì': { bg: '#f1f5f9', color: '#64748b' }
                        };
                        const colors = teamColors[selectedValue] || teamColors['1íŒ€'];
                        
                        cell.innerHTML = `<span class="status-badge" style="background: ${colors.bg}; color: ${colors.color}; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 500;">${selectedValue}</span>`;
                        cell.classList.remove('editing-cell');
                        
                        // ìë™ì €ì¥ ì‹¤í–‰
                        autoSaveNewProperty(cell);
                    });
                    
                    cell.innerHTML = '';
                    cell.appendChild(selector);
                    selector.focus();
                }
            } else {
                // ì¼ë°˜ ì…ë ¥ í•„ë“œ
                const input = document.createElement('input');
                input.type = type === 'date' ? 'date' : (type === 'number' ? 'number' : 'text');
                input.value = currentValue;
                input.style.cssText = 'width: 100%; padding: 4px; border: 2px solid #3b82f6; border-radius: 4px; font-size: 12px;';
                
                input.addEventListener('blur', () => {
                    let newValue = input.value.trim();
                    
                    // ìˆ«ì í•„ë“œ í¬ë§·íŒ…
                    if (type === 'number' && newValue) {
                        const num = parseInt(newValue.replace(/[^0-9]/g, ''));
                        if (!isNaN(num) && num > 0) {
                            newValue = num.toLocaleString();
                        }
                    }
                    
                    cell.textContent = newValue || (field.includes('price') || field.includes('deposit') || field.includes('rent') ? '0' : '');
                    cell.style.color = newValue ? '#1f2937' : '#64748b';
                    cell.classList.remove('editing-cell');
                    
                    // ìë™ì €ì¥ ì‹¤í–‰
                    autoSaveNewProperty(cell);
                });
                
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        input.blur();
                    }
                });
                
                cell.innerHTML = '';
                cell.appendChild(input);
                input.focus();
                input.select();
            }
        }

        // ìƒˆ ë§¤ë¬¼ í–‰ ì·¨ì†Œ (ì‚¬ìš©í•˜ì§€ ì•ŠìŒ - ì €ì¥/ì·¨ì†Œ ë²„íŠ¼ ì œê±°ë¨)
        /*
        function cancelNewAdminPropertyRow(button) {
            const row = button.closest('tr');
            row.remove();
            showAlert('ë§¤ë¬¼ ì¶”ê°€ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
        }
        */

        // ìƒˆ ë§¤ë¬¼ ì €ì¥ (ì‚¬ìš©í•˜ì§€ ì•ŠìŒ - ì €ì¥/ì·¨ì†Œ ë²„íŠ¼ ì œê±°ë¨)
        /*
        async function saveNewAdminProperty(button) {
            const row = button.closest('tr');
            console.log('ê´€ë¦¬ì ìƒˆ ë§¤ë¬¼ ì €ì¥ ì‹œì‘...');
            
            try {
                // ë°ì´í„° ìˆ˜ì§‘
                const propertyData = {};
                const cells = row.querySelectorAll('.editable-cell');
                
                cells.forEach(cell => {
                    const field = cell.dataset.field;
                    let value = cell.textContent.trim();
                    
                    // ë°°ì§€ì—ì„œ ê°’ ì¶”ì¶œ
                    if (field === 'status') {
                        const badge = cell.querySelector('.badge');
                        value = badge ? badge.textContent.trim() : 'ê±°ë˜ê°€ëŠ¥';
                    } else if (field === 'is_occupied') {
                        const badge = cell.querySelector('.badge');
                        value = badge && badge.textContent.trim() === 'O';
                    } else if (field.includes('price') || field.includes('deposit') || field.includes('rent')) {
                        // ê°€ê²© í•„ë“œ ì²˜ë¦¬
                        const numValue = value.replace(/[^0-9]/g, '');
                        value = numValue ? parseInt(numValue) : null;
                    } else if (field === 'building_number' || field === 'room_number') {
                        // ë™/í˜¸ìˆ˜ ì²˜ë¦¬ (ì„ íƒì‚¬í•­)
                        value = value.replace(/[^0-9]/g, '');
                        // í•„ìˆ˜ ê²€ì¦ ì œê±° - ë¹ˆ ê°’ë„ í—ˆìš©
                    }
                    
                    // í”Œë ˆì´ìŠ¤í™€ë” í…ìŠ¤íŠ¸ ì œê±°
                    if (typeof value === 'string' && value.includes('ì…ë ¥')) {
                        value = '';
                    }
                    
                    propertyData[field] = value;
                });
                
                // ë©”ëª¨ ì²˜ë¦¬
                const memoCell = row.querySelector('.memo-cell');
                propertyData.memo = memoCell.dataset.memo || '';
                
                // ê´€ë¦¬ì ì •ë³´ ì¶”ê°€
                propertyData.employee_id = 'admin';
                propertyData.employee_name = 'ê´€ë¦¬ì';
                propertyData.employee_team = 'ê´€ë¦¬ì';
                
                console.log('ìµœì¢… ë§¤ë¬¼ ë°ì´í„°:', propertyData);
                
                // API í˜¸ì¶œ
                const response = await fetch('/api/maeiple', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(propertyData)
                });
                
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`HTTP ${response.status}: ${errorText}`);
                }
                
                const result = await response.json();
                
                if (result && result.success === true) {
                    const successMsg = result.message || 'ë§¤ë¬¼ì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.';
                    showAlert(successMsg, 'success');
                    
                    console.log('âœ… ë§¤ë¬¼ ì¶”ê°€ ì„±ê³µ:', result);
                    
                    // ìƒˆë¡œ ì¶”ê°€ëœ ë§¤ë¬¼ì„ í…Œì´ë¸”ì— ì¦‰ì‹œ í‘œì‹œ (ìƒˆë¡œê³ ì¹¨ ì—†ì´)
                    if (result.created_property) {
                        await addNewPropertyToTable(result.created_property);
                    }
                    
                    // í…Œì´ë¸” ìƒˆë¡œê³ ì¹¨ (ë°±ê·¸ë¼ìš´ë“œì—ì„œ)
                    setTimeout(async () => {
                        await loadMaeipeProperties(1);
                    }, 500);
                    
                    // ìƒˆ í–‰ ì œê±°
                    row.remove();
                } else {
                    const errorMsg = result?.error || result?.message || 'ë§¤ë¬¼ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
                    throw new Error(errorMsg);
                }
                
            } catch (error) {
                console.error('ê´€ë¦¬ì ë§¤ë¬¼ ì €ì¥ ì˜¤ë¥˜:', error);
                showAlert(`ì €ì¥ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }
        */

        // ìƒˆë¡œ ì¶”ê°€ëœ ë§¤ë¬¼ì„ í…Œì´ë¸”ì— ì¦‰ì‹œ í‘œì‹œ
        async function addNewPropertyToTable(property) {
            console.log('ğŸ”„ ìƒˆ ë§¤ë¬¼ì„ í…Œì´ë¸”ì— ì¦‰ì‹œ ì¶”ê°€:', property);
            
            const tbody = document.querySelector('#maeiple-table-content table tbody');
            if (!tbody) {
                console.error('ë§¤ë¬¼ í…Œì´ë¸” tbodyë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ìƒˆ í–‰ ìƒì„±
            const newRow = document.createElement('tr');
            newRow.className = 'property-row';
            newRow.dataset.propertyId = property.id;
            
            // ìƒíƒœì— ë”°ë¥¸ ë°°ì§€ ìƒ‰ìƒ ì„¤ì •
            const statusBadge = getStatusBadge(property.status);
            const occupiedBadge = getOccupiedBadge(property.is_occupied);
            
            newRow.innerHTML = `
                <td style="text-align: center;">
                    <input type="checkbox" class="property-checkbox" value="${property.id}">
                </td>
                <td>${property.check_date || '-'}</td>
                <td>${property.building_number || '-'}</td>
                <td>${property.room_number || '-'}</td>
                <td>${statusBadge}</td>
                <td>${property.jeonse_price ? property.jeonse_price + 'ë§Œì›' : '-'}</td>
                <td>${property.monthly_deposit ? property.monthly_deposit + 'ë§Œì›' : '-'}</td>
                <td>${property.monthly_rent ? property.monthly_rent + 'ë§Œì›' : '-'}</td>
                <td>${property.sale_price ? property.sale_price + 'ë§Œì›' : '-'}</td>
                <td>${occupiedBadge}</td>
                <td>${property.phone || '-'}</td>
                <td class="memo-cell" onclick="openAdminPropertyMemoModal(this)" data-memo="${property.memo || ''}" style="cursor: pointer;">
                    ${property.memo ? property.memo.substring(0, 20) + (property.memo.length > 20 ? '...' : '') : '-'}
                </td>
                <td>${property.employee_name || 'ê´€ë¦¬ì'}</td>
                <td>
                    <span class="status-badge" style="background: #e0e7ff; color: #4338ca; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 500;">
                        ${property.employee_team || 'ê´€ë¦¬ì'}
                    </span>
                </td>
                <td>
                    <div style="cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; gap: 2px;" onclick="editAdminPropertyLikes(this, 'like')" data-count="${property.likes || 0}">
                        <span style="color: #9ca3af; font-size: 14px;">â¤ï¸ ${property.likes || 0}</span>
                    </div>
                </td>
                <td>
                    <div style="cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: center; gap: 2px;" onclick="editAdminPropertyLikes(this, 'dislike')" data-count="${property.dislikes || 0}">
                        <span style="color: #9ca3af; font-size: 14px;">ğŸ‘ ${property.dislikes || 0}</span>
                    </div>
                </td>
                <td>
                    <div class="action-buttons">
                        <button class="btn btn-secondary btn-sm" onclick="editAdminProperty(this)">âœï¸ ìˆ˜ì •</button>
                        <button class="btn btn-danger btn-sm" onclick="deleteAdminProperty(${property.id})">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                </td>
            `;
            
            // í…Œì´ë¸” ë§¨ ìœ„ì— ìƒˆ í–‰ ì¶”ê°€
            tbody.insertBefore(newRow, tbody.firstChild);
            
            // ìƒˆë¡œ ì¶”ê°€ëœ í–‰ì— í•˜ì´ë¼ì´íŠ¸ íš¨ê³¼ ì ìš©
            newRow.style.backgroundColor = '#f0f9ff';
            newRow.style.transition = 'background-color 0.5s ease';
            
            setTimeout(() => {
                newRow.style.backgroundColor = '';
            }, 2000);
            
            console.log('âœ… ìƒˆ ë§¤ë¬¼ì´ í…Œì´ë¸”ì— ì¦‰ì‹œ ì¶”ê°€ë¨');
        }
        
        // ìƒíƒœì— ë”°ë¥¸ ë°°ì§€ ìƒì„±
        function getStatusBadge(status) {
            const statusColors = {
                'ê±°ë˜ê°€ëŠ¥': 'background: #dcfce7; color: #166534;',
                'ê±°ë˜ì¤‘': 'background: #fef3c7; color: #92400e;',
                'ê³„ì•½ì™„ë£Œ': 'background: #dbeafe; color: #1e40af;',
                'ë³´ë¥˜': 'background: #fecaca; color: #dc2626;',
                'ë¶€ì¬': 'background: #f3f4f6; color: #374151;'
            };
            
            const color = statusColors[status] || statusColors['ê±°ë˜ê°€ëŠ¥'];
            return `<span class="badge" style="${color} padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">${status}</span>`;
        }
        
        // ì‹¤ê±°ì£¼ ì—¬ë¶€ì— ë”°ë¥¸ ë°°ì§€ ìƒì„±
        function getOccupiedBadge(isOccupied) {
            if (isOccupied === true || isOccupied === 'O') {
                return '<span class="badge" style="background: #dcfce7; color: #166534; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">O</span>';
            } else {
                return '<span class="badge" style="background: #fecaca; color: #dc2626; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:500;">X</span>';
            }
        }

        // ìƒˆ ë§¤ë¬¼ ë©”ëª¨ ëª¨ë‹¬
        function openNewAdminPropertyMemoModal(cell) {
            const currentMemo = cell.dataset.memo || '';
            
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1000;';
            
            modal.innerHTML = `
                <div class="modal-content" style="background: white; padding: 24px; border-radius: 12px; width: 90%; max-width: 500px; box-shadow: 0 10px 25px rgba(0,0,0,0.15);">
                    <h3 style="margin: 0 0 16px 0; font-size: 18px; font-weight: 600; color: #1f2937;">ë§¤ë¬¼ ë©”ëª¨ ì…ë ¥</h3>
                    <textarea id="memo-input" placeholder="ë§¤ë¬¼ì— ëŒ€í•œ ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." 
                              style="width: 100%; height: 120px; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px; resize: vertical;">${currentMemo}</textarea>
                    <div style="display: flex; gap: 8px; justify-content: flex-end; margin-top: 16px;">
                        <button onclick="this.closest('.modal-overlay').remove()" 
                                style="padding: 8px 16px; border: 1px solid #d1d5db; background: white; border-radius: 6px; cursor: pointer;">ì·¨ì†Œ</button>
                        <button onclick="saveNewAdminPropertyMemo(this, cell)" 
                                style="padding: 8px 16px; border: none; background: #3b82f6; color: white; border-radius: 6px; cursor: pointer;">ì €ì¥</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            modal.querySelector('#memo-input').focus();
            
            // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // ìƒˆ ë§¤ë¬¼ ë©”ëª¨ ì €ì¥
        function saveNewAdminPropertyMemo(button, memoCell) {
            const modal = button.closest('.modal-overlay');
            const memoInput = modal.querySelector('#memo-input');
            const memo = memoInput.value.trim();
            
            // ë©”ëª¨ë¥¼ ì…€ì— ì €ì¥
            if (memoCell) {
                memoCell.dataset.memo = memo;
                memoCell.textContent = memo || 'ë©”ëª¨ ì…ë ¥';
                memoCell.style.color = memo ? '#1f2937' : '#64748b';
            }
            
            modal.remove();
            showAlert('ë©”ëª¨ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        }

        // ìƒˆ ë§¤ë¬¼ ì¢‹ì•„ìš”/ì‹«ì–´ìš” (ì„ì‹œ)
        function editNewAdminPropertyLikes(element, type) {
            // ìƒˆ ë§¤ë¬¼ì—ì„œëŠ” ì¢‹ì•„ìš”/ì‹«ì–´ìš” í¸ì§‘ ë¶ˆê°€
            showAlert('ë§¤ë¬¼ì„ ë¨¼ì € ì €ì¥í•œ í›„ ì¢‹ì•„ìš”/ì‹«ì–´ìš”ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'info');
        }
        
    </script>

    <!-- ë§¤ë¬¼ ë©”ëª¨ ëª¨ë‹¬ (ì§ì›í˜ì´ì§€ ìŠ¤íƒ€ì¼) -->
    <div id="property-memo-modal" class="modal-overlay" onclick="closePropertyMemoModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 class="modal-title">ğŸ“ ë§¤ë¬¼ íŠ¹ì´ì‚¬í•­ í¸ì§‘</h3>
                <button class="modal-close" onclick="closePropertyMemoModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="memo-info">
                    <div class="memo-property-info">
                        <span class="memo-label">ë§¤ë¬¼:</span>
                        <span id="property-memo-info" class="memo-value">ë™-í˜¸ìˆ˜</span>
                    </div>
                </div>
                <textarea id="property-memo-textarea" class="memo-textarea" placeholder="ë§¤ë¬¼ì˜ íŠ¹ì´ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”..." rows="8"></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closePropertyMemoModal()">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="savePropertyMemo()">ì €ì¥</button>
            </div>
        </div>
    </div>
</body>
</html> 